# Coverage Hotspots (baseline: 2025-11-10)

Latest data sourced from `docs/coverage/latest/Summary.json` (generated via `./scripts/coverage/coverage.ps1` on 2025-11-19 12:34 UTC; coverlet still prints the transient `NovaSharp.Cli.dll` “in use” warning before succeeding on retry).

## Snapshot
- Overall line coverage: **86.2 %**
- NovaSharp.Interpreter line coverage: **95.6 %**
- NovaSharp.Cli line coverage: **80.0 %**
- NovaSharp.Hardwire line coverage: **55.0 %**
- NovaSharp.RemoteDebugger line coverage: **92.4 %** (DebugServer still holds **99.6 %** line / **84.9 %** branch; remaining focus is on the VS command handlers and Tcp helpers still below 85 % line coverage)
- NovaSharp.VsCodeDebugger line coverage: **0 %** (no tests yet)

## Prioritized Red List (Interpreter < 90 %)
- `Execution.VM.Processor` – **90.7 % line / 89.6 % branch** (resume/pause and instruction-range guards need explicit tests to flip the last branch to green).

See `docs/coverage/latest/Summary.json` for the full breakdown; update this list after each burn-down.

## Action Items
1. Assign owners for each red-listed class (default owner noted above until explicit assignment).
2. Add issue/project board entries mirroring this table so progress is tracked.
3. Update this document after each `./scripts/coverage/coverage.ps1` run (include new timestamp + notes).
4. When a class crosses 90 %, move it to the green archive section (to be added) and celebrate the win.
- `PlatformAccessorBase` now has NUnit coverage for both Unity DLL suffix branches (`unity.dll.mono` + `unity.dll.unknown`), the `.dotnet` fallback, and the base `DefaultInput` shim via a dedicated test accessor. Release builds still inline the `return null` fast path, so the coverage report remains **84 % line / 78.5 % branch**, but behaviour is now regression-tested.

- (2025-11-17 15:33 UTC) Added `Units/LexerUtilsTests` to hammer the parser utilities (decimal/hex parsing, Unicode escape handling, `\z` whitespace trimming, and the malformed escape branches). A fresh `./scripts/coverage/coverage.ps1 -SkipBuild` run (2 091 tests) lifts `LexerUtils` to **96.2 % line / 98.1 % branch / 100 % method** and nudges interpreter totals to **94.4 % line / 91.1 % branch / 96.9 % method**, leaving the numeric conversion helpers and runtime diagnostics classes as the remaining <90 % debt.
- (2025-11-17 15:47 UTC) Added `Units/NumericConversionsTests` (double-to-type success/overflow plus numeric/non-numeric `TypeToDouble`) and reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2 095 tests). `NumericConversions` now reports **91.3 % line / 89.1 % branch / 100 % method**, and interpreter totals sit at **94.4 % line / 91.2 % branch / 96.9 % method**, narrowing the red list to `MultiDictionary<T>`, `DynValue`, and the diagnostics helpers.
- (2025-11-17 16:03 UTC) Introduced `Units/MultiDictionaryTests` (equality comparer constructor, `ContainsKey`, `Keys`, `Clear`, remove-value success/failure). `./scripts/coverage/coverage.ps1 -SkipBuild` now runs **2 101** tests, pushes `MultiDictionary<T>` to **100 % line / branch / method**, and holds interpreter aggregates at **94.4 % line / 91.2 % branch / 97.1 % method**. Remaining <90 % classes are `DynValue` plus the diagnostics helpers noted above.
- (2025-11-17 16:34 UTC) Expanded `Units/DynValueTests` with table array construction, tuple single-element folding, `ToPrintString`/`ToDebugPrintString` fallbacks, equality/assign-number guards, and the nil-tolerant `CheckUserDataType` path (`NewTableFromArrayInitializesEntriesAndOwner`, `NewTupleNestedReturnsSingleValueUnchanged`, `ToPrintStringFormatsCompositeValues`, `ToDebugPrintStringDisplaysTailYieldAndScalars`, `EqualsHandlesNonDynValuesTuplesUserDataAndYieldRequests`, `AssignNumberThrowsWhenDestinationReadOnly`, etc.). `./scripts/coverage/coverage.ps1 -SkipBuild` (2 123 tests) now reports `NovaSharp.Interpreter.DataTypes.DynValue` at **95.2 % line / 92.2 % branch / 100 % method**, lifting interpreter totals to **94.7 % line / 91.6 % branch / 97.2 % method** and removing DynValue from the red list.
- (2025-11-18 09:28 UTC) Hardened the surface-level helpers: the ScriptOptions copy constructor now flows `ColonOperatorClrCallbackBehaviour` and is covered by `CopyConstructorClonesConfiguredValues`, the REPL’s empty dynamic-expression fast path clears `_currentCommand` and is guarded by the new `DynamicExpressionReturnsComputedValueWhenCodeIsPresent`, and both `ScriptPrivateResourceExtensionTests` and `StandardPlatformAccessorTests` gained edge-case coverage (null DynValues, non-private userdata, fallback `ParseFileAccess`, invalid standard streams). The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2 212 tests) reports NovaSharp.Interpreter at **95.3 % line / 92.2 % branch / 97.4 % method**, removing ReplInterpreter + ScriptOptions from the red list and shrinking the branch gap to ~2.8 pp (remaining debt: assignment statements, table pairs, descriptor helpers, VM bytecode).
- (2025-11-18 10:13 UTC) Added `Units/AssignmentStatementTests` that build `ScriptLoadingContext` instances by hand to verify `<const>`/`<close>` combinations plus the duplicate/unknown attribute diagnostics. The branch that enforces writable l-values now has a regression test via `1 = 2`. `AssignmentStatement` jumps to **92.7 % line / 95.4 % branch / 100 % method**, interpreter totals climb to **95.35 % line / 92.24 % branch / 97.53 % method**, and the red list now starts with `Errors.SyntaxErrorException`, `AutoDescribingUserDataDescriptor`, `TablePair`, and the VM bytecode helpers.
- (2025-11-18 19:39 UTC) Expanded `Units/LoadModuleTests` (string-chunk compilation, invalid reader/type handling, syntax-error tuples, explicit `loadfile(..., env)` execution, and both branches of `LoadModule.NovaSharpInit`) and fixed the `BinaryOperatorExpressionTests` accessibility issue that was blocking Release builds. The `./scripts/coverage/coverage.ps1 -SkipBuild` pass (2 224 tests) kept `NovaSharp.Interpreter` at **95.39 % line / 92.30 % branch / 97.63 % method** while documenting `NovaSharp.Interpreter.CoreLib.LoadModule` at **91.3 % line / 76.9 % branch / 100 % method** (63/69 lines, 20/26 branches). Remaining branch debt was limited to the loader fallback/error combinations (`__require_clr_impl`, env mismatch guards) called out in the red list.
- (2025-11-18 19:58 UTC) Reworked in-flight tests so `LoadCompilesStringChunksAndUsesProvidedSourceName` exercises `Script.LoadString` and forces a decorated error sourced from the provided chunk label. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` pass (2 240 tests) now reports `NovaSharp.Interpreter.CoreLib.LoadModule` at **100 % line / 92.3 % branch / 100 % method** (69/69 lines, 24/26 branches) and `NovaSharp.Interpreter` totals at **95.47 % line / 92.48 % branch / 97.63 % method**. The outstanding branches are the defensive `__require_clr_impl` fallback when no loader resolves a module plus the Lua-side `package.loaded[modname] = true` default for loaders that return nil—both require bespoke script-loader shims before we can hit them under NUnit.
- (2025-11-19 19:22 UTC) Refactored syntax-error formatting into the new `LoadModule.GetSyntaxErrorMessage` helper, unit-tested the decorated/raw/null code paths, and added NUnit coverage for the decorated-reader and raw-loader scenarios so both tuples exercise the helper. `./scripts/coverage/coverage.ps1` (2 299 Release tests) now reports `NovaSharp.Interpreter.CoreLib.LoadModule` at **100 % line / 100 % branch / 100 % method** (69/69 lines, 26/26 branches) with interpreter totals holding at **95.78 % line / 92.87 % branch / 97.83 % method**.
- (2025-11-19 12:08 UTC) Added sentinel-aware `HardwiredMethodMemberDescriptorTests` mirroring the generator’s `DefaultValue` placeholders so `CalcArgsCount` decrements when optional arguments are omitted and stays flat when custom values are supplied. The updated suite (Release total **2 301** tests) drives `NovaSharp.Interpreter.Interop.StandardDescriptors.HardwiredDescriptors.HardwiredMethodMemberDescriptor` to **100 % line / 100 % branch / 100 % method** coverage while keeping interpreter aggregates at **95.79 % line / 92.89 % branch / 97.83 % method**.
- (2025-11-19 12:34 UTC) Layered guard-rail coverage onto `BinaryOperatorExpression`: new NUnit fixtures intentionally corrupt the operator chain, force the internal operator enum into unsupported combinations, and assert the resulting `InternalErrorException`/`DynamicExpressionException` flows. The latest `./scripts/coverage/coverage.ps1` run (Release suite **2 305** tests) reports `NovaSharp.Interpreter.Tree.Expressions.BinaryOperatorExpression` at **98.0 % line / 96.8 % branch / 100 % method**, bumping interpreter aggregates to **95.81 % line / 93.01 % branch / 97.83 % method**.
- (2025-11-18 20:28 UTC) Added `Units/ByteCodeTests` to cover SourceRef stacking/guard disposal, `ByteCode.Dump`, comparison normalisation (`LessEq`/`Eq`/`Less` → `CNot`/`ToBool`), name/list indexers, global/local/upvalue `Emit_Load` & `Emit_Store`, table initialiser flags, and scope-frame serialisation. Fresh coverage (`./scripts/coverage/coverage.ps1 -SkipBuild`, 2 261 tests) now reports `Execution.VM.ByteCode` at **95.5 % line / 77.7 % branch / 95.6 % method** (276/289 lines, 28/36 branches). The remaining eight branches are strictly defensive: the `SymbolRefType.DefaultEnv` guard paths in `Emit_Load`/`Emit_Store`, the exception-only `Emit_Index*` fallbacks, and the never-hit `InternalErrorException` cases. Leaving them red-listed for now until we either delete that dead code or craft synthetic AST fixtures to assert the failure modes.
- (2025-11-18 10:34 UTC) TablePair’s properties are now immutable and the recursive setter bug was removed (`Key`/`Value` expose the readonly backing fields). `Units/TablePairTests` assert the Nil sentinel contents, equality/hash behaviour, and constructor storage guarantees. `NovaSharp.Interpreter.DataTypes.TablePair` rises to **93.3 % line / 50 % branch / 100 % method**; the remaining branch debt is isolated to the equality operators, but the class no longer sits on the red list.
- (2025-11-18 11:06 UTC) Added the missing adapter tests so `AutoDescribingUserDataDescriptor` now exercises both the userdata and non-userdata paths (`IndexReturnsNullWhenObjIsNotUserDataType`, `MetaIndexReturnsNullWhenObjIsNotUserDataType`). Paired with the existing delegate assertions, the descriptor now reports **100 % line / 100 % branch / 100 % method** coverage.
- (2025-11-17 17:21 UTC) Added `SetValueConvertsDoubleToPropertyType`, `SetValueWrapsArgumentExceptionFromOptimizedSetter`, and `SetValueWrapsInvalidCastExceptionFromOptimizedSetter` to `Units/PropertyMemberDescriptorTests`. The new cases drive the double→integral conversion path, and force the `_optimizedSetter` guard rails by injecting delegates that throw `ArgumentException` and `InvalidCastException`. `PropertyMemberDescriptor` now sits at **94.5 % line / 94.1 % branch / 100 % method**, and the latest coverage run (2 126 tests) keeps interpreter totals at **94.7 % line / 91.6 % branch / 97.2 % method**.
- (2025-11-18 05:25 UTC) Expanded `Units/TokenTests` to lock padding/formatting, reserved keywords, numeric parsing, operator helpers, and every `GetSourceRef*` overload, pushing `Tree.Lexer.Token` to **100 % line / 100 % branch / 100 % method** coverage and keeping the interpreter aggregate at **95.2 % line / 92.1 % branch / 97.4 % method** across **2 196** Release tests.
- (2025-11-18 05:25 UTC) Added deterministic coverage for the stopwatch infrastructure: `PerformanceStatisticsTests` now verifies redundant enable/disable calls, exercises the multi-scope path in `StartGlobalStopwatch`, and asserts `GetPerformanceLog` output, while `GlobalPerformanceStopwatch` explicitly marks results as global. `PerformanceStatistics` climbs to **98.2 % line / 96.1 % branch / 90 % method**, removing it from the red list.
- (2025-11-18 05:25 UTC) Introduced `Units/DebuggerBreakpointTests` (queued toggle/set/clear/reset flows with a stub debugger) plus `Units/ProcessorBinaryDumpTests` and the new `ScriptLoadTests.LoadStreamHandlesShortTextStreams` case. `Execution.VM.Processor` now reports **90.7 % line / 88.0 % branch / 94.0 % method**, so the debugger hook/binary dump guards are no longer red-listed.
- (2025-11-18 05:25 UTC) `ScriptOptionsTests.CallRecordsExecutionCounterWhenEnabled` enables `PerformanceStats` before invoking a script API, covering `Processor.Call`’s stopwatch-disposal path and ensuring the execution counter increments under real script workloads.
- (2025-11-17 19:24 UTC) Added `Units/SystemHighResolutionClockTests` to pin the stopwatch frequency, monotonic timestamp ordering, explicit elapsed calculations, and the implicit `endTimestamp` path. `SystemHighResolutionClock` now reports **100 % line / 100 % branch / 100 % method**, and interpreter aggregates nudge to **94.8 % line / 91.6 % branch / 97.3 % method** (2 142 Release tests).

- (2025-11-17 15:06 UTC) Extended `LimitedPlatformAccessorTests` with a dedicated `FileExists` assertion and a `DefaultPrintDoesNotThrow` guard so every override in the limited accessor class is exercised. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2 072 tests) reports NovaSharp.Interpreter at **94.3 % line / 90.9 % branch / 96.9 % method**, and `LimitedPlatformAccessor` is now **100 % line/method** coverage, dropping it from the red list. Remaining focus stays on the lexer utilities, numeric conversions, and runtime helpers listed above.
- (2025-11-17 22:41 UTC) Added three more `ReplHistoryInterpreterTests` to cover empty-history navigation, the `HistoryNext` early-return path, and the navigation reset/overwrite behaviour when the circular buffer wraps. A fresh `./scripts/coverage/coverage.ps1 -SkipBuild` run (2 070 tests) keeps interpreter totals at **94.2 % line / 90.9 % branch / 96.8 % method**, and `ReplHistoryInterpreter` now reports **95.2 % line / 87.5 % branch / 100 % method**, removing it from the red list. Remaining focus stays on the platform accessors, lexer/numeric helpers, and descriptor edge cases enumerated above.
- (2025-11-17 22:25 UTC) Repaired the `DynamicAndAdjustmentExpressionTests` reflection helpers so Eval/Compile overrides can be invoked under C# 9, fixed the `TableTests` fractional-key/object-array cases to respect script ownership and nil returns, stabilized the whitespace `NovaSharp_PATH` scenario in `ReplInterpreterScriptLoaderTests`, and reran `./scripts/coverage/coverage.ps1 -SkipBuild`. Interpreter coverage holds at **94.2 % line / 90.9 % branch / 96.8 % method** across **2 067** Release tests, and both `DynamicExprExpression` and `AdjustmentExpression` are now >95 % line coverage, leaving the platform/lexer/numeric helpers listed above as the remaining <90 % debt.
- (2025-11-17 12:16 UTC) Added `Units/ObjectCallbackMemberDescriptorTests` to cover delegate execution (ensuring host/context/args propagate) and the null-callback fallback. A fresh `./scripts/coverage/coverage.ps1 -SkipBuild` run (2 063 tests) keeps interpreter totals at **94.2 % line / 90.8 % branch / 96.7 % method**, and `ObjectCallbackMemberDescriptor` jumps to **92.8 % line / 100 % branch**, leaving `PropertyMemberDescriptor`, the parser helpers (`DynamicExprExpression`/`AdjustmentExpression`), and the lexer/numeric conversion utilities as the remaining <90 % targets.
- (2025-11-17 11:30 UTC) Extended `PropertyMemberDescriptorTests` with constructor guardrails (dual-null accessors), AOT fallback verification, and explicit `IOptimizableDescriptor.Optimize()` coverage. Overall interpreter coverage nudges to **94.1 % line / 90.9 % branch / 96.8 % method** across **2 061** tests, and `PropertyMemberDescriptor` now reports **89.6 % line / 94.1 % branch** (the remaining uncovered statements are the legacy `_getter == null` / `_setter == null` post-checks and the ArgumentException/InvalidCastException wrappers, which are unreachable while `MemberDescriptor.CheckAccess` guards conversions).
- (2025-11-17 11:05 UTC) Marked `ReplInterpreterScriptLoaderTests` as `[NonParallelizable]`, fixed the `ConstructorIgnoresEmptyNovaSharpPathValue` flake, and added `RuntimeScopeFrameTests` to pin `Count`, `DebugSymbols`, and `ToFirstBlock`. Table’s fractional-key/boxed-path suite now drives it to **98.5 % line / 95.8 % branch**, while `RuntimeScopeFrame` is fully covered (**100 % line / method**). Interpreter totals remain **94.1 % line / 90.8 % branch / 96.7 % method** across **2 058** Release tests; the remaining debt is concentrated in the reflection/member descriptor helpers and parser/lexer utilities above.
- (2025-11-17 10:40 UTC) Added a second wave of `Units/TableTests` (boxed string/int/`DynValue` removes, fractional-number keys, `Set(object[])` null/empty guards, and raw-get fallbacks) plus `Units/ReplInterpreterScriptLoaderTests` (whitespace `NovaSharp_PATH` ignores + explicit `LUA_PATH` miss). Branch coverage for `Table` climbs but remains at **86.8 %** because `ResolveMultipleKeys` and the iterator continuations still have untouched combinations; `ReplInterpreterScriptLoader` is functionally covered, yet OpenCover still reports **84.2 % line / 75.0 % branch** because the `LUA_PATH_5_2`/`LUA_PATH` assignment sites (lines 39/48) and the null-return at line 77 never record visits. Interpreter totals stay at **94.0 % line / 90.6 % branch / 96.6 % method** across **2 039** Release tests.
- (2025-11-17 10:01 UTC) Extended `Units/TableTests` to cover constructor array initialization, `Table.Clear`, object/object[] setters, nested removal, raw-get overloads, additional `Remove` paths, and the `Keys` iterator. Behaviour is now exercised end-to-end even though OpenCover still reports **85.8 % line / 81.9 % branch** for `Table`; interpreter totals rise to **94.1 % line / 90.6 % branch / 96.6 % method** across **2 039** Release tests.
- (2025-11-16 21:41 UTC) Added `Units/DebugServiceTests` to capture the `SourceCode` supplied to debuggers and call `DebugService.ResetBreakPoints` directly, proving that the helper delegates to `Processor.ResetBreakPoints` and surfaces the owning script. `DebugService` now reports **100 % line / 100 % method** coverage (up from **83 % line / 66 % method**), removing it from the red list and nudging interpreter totals to **93.9 % line / 90.4 % branch / 96.3 % method** across **2 030** tests.

- (2025-11-16 21:20 UTC) Extended `Units/StandardEnumUserDataDescriptorTests` with signed/unsigned XOR + NOT permutations, `hasAll`/`hasAny` boolean assertions, argument-count failures, and cross-descriptor mismatch guards, then rebuilt in Release so coverlet could see the new fixtures. `StandardEnumUserDataDescriptor` now reports **95.0 % line / 96.6 % branch / 100 % method**, so it leaves the red list and helps lift interpreter totals to **93.8 % line / 90.4 % branch / 96.2 % method** across **2 029** tests.
- (2025-11-16 20:14 UTC) Landed `Units/PropertyMemberDescriptorTests` (attribute-driven visibility, lazy/static optimization, access guards, wiring metadata) plus `ReflectionSpecialNamesTests` equality/`GetHashCode` coverage, and patched `PropertyTableAssigner.SetSubassignerForType` so removing a subassigner falls back to CLR conversions instead of dereferencing `null`. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run exercises **2 019** Release tests, records `ReflectionSpecialName` at **100 % line / 99.2 % branch / 100 % method**, `PropertyMemberDescriptor` up to **87.1 % line / 91.1 % branch / 94.1 % method**, and `PropertyTableAssigner` at **96.9 % line / 98.0 % branch**. Interpreter totals now sit at **93.7 % line / 90.3 % branch / 96.2 % method**, keeping the ≥95 % goal in sight.
- (2025-11-16 19:17 UTC) Added `Units/JsonTableConverterTests` (object/array filtering, invalid-root/colon/minus regressions, `JsonNull` round-trips) and `Units/ObjectValueConverterTests` (custom null sentinels, enum projections, enumerable expansion, static/instance reflection paths). `./scripts/coverage/coverage.ps1 -SkipBuild` now reports `NovaSharp.Interpreter.Serialization.Json.JsonTableConverter` at **99.2 % line / 96.1 % branch / 100 % method** and `NovaSharp.Interpreter.Serialization.ObjectValueConverter` at **100 % line / 93.7 % branch / 100 % method**, lifting interpreter totals to **93.4 % line / 89.9 % branch / 95.9 % method** across **1 972** Release tests (artifacts under `docs/coverage/latest`).
- (2025-11-16 19:40 UTC) `Units/ScriptLoadTests` now drive `Script`’s loader/caller pathways: base64 dump decoding, text/dump `LoadStream`, `Dump` guard rails, loader return-type validation, metamethod-based `Call`, CLR/object overloads, coroutine recycling, and the static `RunFile`/`RunString` helpers. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` now records `NovaSharp.Interpreter.Script` at **93.1 % line / 82.7 % branch / 95.9 % method**, nudging interpreter totals to **93.5 % line / 90.0 % branch / 95.9 % method** across **1 989** Release tests.
- (2025-11-16 19:54 UTC) `Units/DynValueTests` picked up the remaining DynValue gaps (StringBuilder constructors, clone/assign/read-only guards, coroutine wrapping, CLR-function `ToString`, `CheckType` auto conversion, `CheckUserDataType` nil allowances). `NovaSharp.Interpreter.DataTypes.DynValue` now reports **87.0 % line / 76.7 % branch / 97.1 % method**, raising interpreter totals to **93.6 % line / 90.1 % branch / 95.9 % method** with **2 000** Release tests and shrinking the gap to the 95 % enforcement target.
- `LuaBaseTests` now run under NUnit (six fixtures) with stack helpers covering MULTRET classification, Lua string/integer helpers, argument validation, raw table indexing, and the nil-padding path inside `LuaBase.LuaCall`. The padding test surfaced a production bug (the `copied` counter never incremented inside the nil-fill loop), so the loop now advances after each `DynValue.Nil` push instead of allocating indefinitely. The follow-up suite (2025-11-16 17:48 UTC) drives the Lua buffer helpers (`LuaLAdd*`, `LuaLPushResult`, `LuaPushLString`), quoting utilities, optional integer readers, boolean conversions, and `LuaLError`, ensuring we can regression-test the KopiLua compatibility surface without reflection. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` (Release) on 2025-11-16 17:48 UTC keeps `NovaSharp.Interpreter.Interop.LuaStateInterop.LuaBase` at **91.3 % line / 88.3 % branch / 81.1 % method**, boosts interpreter totals to **93.15 % line / 89.73 % branch / 95.26 % method**, and brings the Release suite to **1 958** tests (method coverage stays below the 90 % goal because `LuaType`’s defensive TailCall/Yield/Tuple guards never fire under normal tests—we still need synthetic fixtures to exercise those error paths).
- `CoroutineModuleTests` now exercise the tuple-flattening path in `coroutine.resume`, the `"running"` vs `"normal"` discriminator in `coroutine.status`, and the internal error guard for unexpected coroutine states. Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 08:52 UTC records `NovaSharp.Interpreter.CoreLib.CoroutineModule` at **100 % line / 100 % branch / 100 % method** and lifts the interpreter suite to **91.82 % line / 88.53 % branch / 93.85 % method** across **1 825** Release tests.
- `CoroutineCloseTests` now assert the `coroutine.close` guardrails (rejecting the main coroutine, failing on in-flight resumptions, guarding unexpected states via `ForceStateForTests`, bubbling `__close` errors, and returning `true` once a coroutine dies cleanly). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 09:04 UTC bumps `NovaSharp.Interpreter.Execution.VM.Processor` to **87.0 % line / 85.7 % branch / 92.8 % method** and raises interpreter totals to **91.97 % line / 88.65 % branch / 93.91 % method** with **1 830** Release tests.
- `SyntaxErrorExceptionTests` now drive the token- and SourceRef-based constructors, the premature-stream flag, and both sides of the `Script.GlobalOptions.RethrowExceptionNested` guard (ensuring nested clones preserve tokens). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 09:14 UTC records `NovaSharp.Interpreter.Errors.SyntaxErrorException` at **89.2 % line / 100 % branch / 76.9 % method** and holds interpreter totals at **92.0 % line / 88.65 % branch / 94.05 % method** across **1 835** Release tests.
- `SymbolRefExpressionTests` now pin the two dynamic-expression guardrails—`...` cannot appear in dynamic expressions (varargs branch) and the SymbolRef-based constructor refuses to run while `IsDynamicExpression` is true. Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 09:36 UTC brings `NovaSharp.Interpreter.Tree.Expressions.SymbolRefExpression` to **100 % line / 100 % branch / 100 % method** and keeps interpreter totals at **92.0 % line / 88.68 % branch / 94.05 % method** with **1 837** Release tests.
- `HardwiredDescriptorTests` now exercise the serialized + name-only `DynValueMemberDescriptor` constructors and both table wiring paths (prime tables emit values, script-owned tables emit errors). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 09:44 UTC pushes `NovaSharp.Interpreter.Interop.StandardDescriptors.MemberDescriptors.DynValueMemberDescriptor` to **100 % line / 100 % branch / 100 % method** and raises interpreter totals to **92.19 % line / 88.75 % branch / 94.20 % method** across **1 840** Release tests.
- `ClrToScriptConversionsTests` (2025-11-16 12:12 UTC) now cover the CLR→DynValue fast paths (custom converters, closures, callback/Delegate marshalling, enums/Type/UserData, `MethodInfo`, list/dictionary/table projections, iterator tuples, and the failure path). Release builds still report **80.7 % line / 84.2 % branch** for `NovaSharp.Interpreter.Interop.Converters.ClrToScriptConversions` because the trivial return paths are inlined away, but the behavioural gap is locked down and interpreter totals remain at **92.23 % line / 88.75 % branch / 94.44 % method** across **1 841** Release tests.
- `FunctionCallExpressionTests` (2025-11-16 15:28 UTC) now cover parenthesized arguments, Lua string/table shortcut calls, `:`/`this` dispatch plumbing, and the premature stream guard. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` records `NovaSharp.Interpreter.Tree.Expressions.FunctionCallExpression` at **98.2 % line / 95.4 % branch / 75 % method** and lifts interpreter aggregates to **93.0 % line / 89.47 % branch / 94.97 % method** with **1 945** Release tests.
- `PlatformAutoDetectorTests` (2025-11-16 15:38 UTC) now validate both the Unity-detection path (dynamic `UnityEngine.*` probe assembly) and the cached `IsRunningOnAot` behaviour, pushing `PlatformAutoDetector` to **91.1 % line / 100 % branch / 100 % method** (the catch path still requires a true AOT runtime to execute). Interpreter aggregates after the run sit at **93.02 % line / 89.51 % branch / 95.02 % method** with **1 948** Release tests.
- `FrameworkCurrentTests` verify the .NET Core reflection shim (interface lookup, `GetTypeInfoFromType`, `IsDbNull`, `StringContainsChar`). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 12:22 UTC drives `NovaSharp.Interpreter.Compatibility.Frameworks.FrameworkCurrent` to **100 % line / 100 % branch / 100 % method** while interpreter totals stay at **92.34 % line / 88.89 % branch / 94.54 % method** across **1 851** Release tests.
- `JsonNullTests` now exercise the JSON-null userdata helper (`IsNull`, `Create`, and `IsJsonNull`). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 12:27 UTC drives `NovaSharp.Interpreter.Serialization.Json.JsonNull` to **100 % line / 100 % branch / 100 % method** with interpreter totals unchanged at **92.34 % line / 88.89 % branch / 94.54 % method** across **1 851** Release tests.
- `RuntimeScopeBlockTests` and `AnonWrapperTests` (2025-11-16 12:31 UTC) now cover the execution-scope metadata DTO and anonymous userdata wrapper helpers (`AnonWrapper<T>`). `RuntimeScopeBlock` reports **100 % line / 100 % branch / 100 % method**, `AnonWrapper<T>` hits **100 % line / 100 % branch**, and interpreter totals remain **92.36 % line / 88.89 % branch / 94.68 % method** across **1 859** Release tests (`./scripts/coverage/coverage.ps1 -SkipBuild`).
- `EmbeddedResourcesScriptLoaderTests` (resource lookup/load + NetCore guard) keep the loader helpers locked down at **100 % line / 100 % branch / 100 % method**, holding interpreter totals at **92.38 % line / 88.90 % branch / 94.68 % method** with **1 865** Release tests (`./scripts/coverage/coverage.ps1 -SkipBuild`).
- `ValueTypeDefaultCtorMemberDescriptorTests` cover the constructor guard, Execute/GetValue behavior, SetValue write rejection, wiring metadata, and the metadata-only properties (`Parameters`, varargs, `SortDiscriminant`). Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 09:54 UTC lifts `NovaSharp.Interpreter.Interop.StandardDescriptors.ReflectionMemberDescriptors.ValueTypeDefaultCtorMemberDescriptor` to **96.4 % line / 100 % branch / 100 % method** and holds interpreter totals at **92.23 % line / 88.75 % branch / 94.44 % method** across **1 841** Release tests.
- `CustomConverterRegistry` jumped to **100 % line / 100 % branch / 100 % method** after introducing `CustomConverterRegistryTests` (duplicate registration, removal, typed + obsolete CLR bridge paths, `Clear`) and tightening the registry's DataType guard so invalid values no longer index past the backing arrays. Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-15 20:12 UTC captured the bump and pushed interpreter totals to **91.1 % line / 87.4 % branch / 93.5 % method** with **1 760** Release tests.
- `EnumerableWrapperTests` now drive iterator callbacks, nil-skipping, reset guards, table conversion, and the exposed `Current/MoveNext/Reset` userdata members so `EnumerableWrapper` sits at **95.2 % line / 88.4 % branch / 88.8 % method** (coverage run 2025-11-15 20:52 UTC). That clears the enumerable entry from the red list and raises the interpreter suite to **91.3 % line / 87.8 % branch / 93.6 % method** with **1 780** Release tests.
- `BreakStatementTests` execute all error paths—top-level `break`, nested functions, and loop-boundary guards—so `BreakStatement` now reports **100 % line / 100 % branch / 100 % method** coverage. Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-15 21:17 UTC captures the latest totals (**91.39 % line / 87.85 % branch / 93.61 % method**, **1 783** tests).
- `ScriptToClrConversionsTests` now drive the `DynValueToObject` branches (custom converters, closure/table/tuple returns, descriptor-only userdata, callback fallbacks) plus the previously uncovered script/clr function conversions, delegate bridges, optional-nil defaults, and the matching weighting logic. Coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-16 07:56 UTC records `ScriptToClrConversions` at **99.4 % line / 98.8 % branch / 100 % method**, pushing interpreter totals to **91.67 % line / 88.37 % branch / 93.81 % method** across **1 821** Release tests and emptying the interpreter red list.
- `CoroutineTests` now cover the CLR-callback resume pathways, object-argument conversion overloads, explicit-context resumes, and the non-script `Close` fast-path so `NovaSharp.Interpreter.DataTypes.Coroutine` reports **100 % line / 100 % branch / 100 % method** coverage (coverage run 2025-11-16 08:44 UTC), pushing interpreter totals to **91.78 % line / 88.44 % branch / 93.85 % method** across **1 821** Release tests.
- `ProxyUserDataDescriptorTests` now cover proxy creation for reads/writes/meta ops, friendly-name/Type plumbing, null-instance passthrough, and compatibility checks. `ProxyUserDataDescriptor` reports **100 % line / 100 % branch / 100 % method** and interpreter totals rise to **91.42 % line / 87.87 % branch / 93.81 % method** with **1 791** Release tests (`./scripts/coverage/coverage.ps1` on 2025-11-15 21:26 UTC).
- `BinaryOperatorExpression` now sits at **90.0 %** line / **82.5 %** branch coverage after adding compile-path opcode assertions (arithmetic, concatenation, comparison, and `~=` inversion) plus new string comparison/equality regressions; coverage run `./scripts/coverage/coverage.ps1` (Release) on 2025-11-14 17:44 UTC captured the jump.
- `LuaStateInterop.Tools` climbed to **98.2 % line / 90.4 % branch** after expanding `LuaStateInteropToolsTests` with unsigned/null-edge coverage and exhaustive `sprintf` permutations (`%i`, `%f/%e/%E/%g/%G`, `%c`, `%s`, `%#o`, `%hd/%hu/%ld/%lu`, flag precedence). The same coverage run bumped interpreter totals to **90.7 % line / 87.4 % branch / 93.1 % method** with **1 721** Release tests.
    - `UnityAssetsScriptLoader` is now fully exercised under the reflection pathway thanks to a dynamically generated `UnityEngine` stub and failure-mode regression tests, yielding **100 % line / 90 % branch** coverage and pushing the suite to **1 723** Release tests (interpreter totals: **90.9 % line / 87.5 % branch / 93.3 % method**).
    - Remote debugger automation now includes `Units/RemoteDebuggerServiceTests`, `Units/HttpServerTests`, `Units/HttpResourceTests`, `Units/XmlWriterExtensionsTests`, and the freshly expanded `Units/RemoteDebuggerTests` (host busy/ready queue refresh, invalid watch fallback, aged-action skip, breakpoint clear/toggle, `ConnectedClients`, debugger caps). Combined with the TCP command suite, `NovaSharp.RemoteDebugger` now sits at **92.7 % line / 81.1 % branch / 94.6 % method** (`DebugServer` 99.6 % / 84.9 %, `RemoteDebuggerService` 96.6 %, `DebugWebHost` 100.0 %, `HttpServer` 91.1 %, `HttpResource` 94.7 %); remaining work targets the VS command handlers and Tcp helpers still under 85 %.
- `UnaryOperatorExpression` now sits at **100 %** line/branch coverage after adding direct Eval tests for `not`, `#`, `-`, and the non-numeric failure path.
- `StringModule` has climbed to **97.2 %** line / **94.6 %** branch coverage via spec-aligned edge cases and modulo-normalization in production.
- `PerformanceStopwatch`, `GlobalPerformanceStopwatch`, and `DummyPerformanceStopwatch` now covered by dedicated stopwatch unit tests.
- `PerformanceStatistics` exercises enabling/disabling counters and global aggregation.
- `ReplHistoryInterpreter` navigation (prev/next) verified via tests.
- `MemberDescriptorTests` cover the `IMemberDescriptor` extension helpers (`HasAllFlags`, read/write/execute wrappers, getter callbacks, `WithAccessOrNull`, and `CheckAccess`), keeping the guardrails under regression even though Release builds still report **82.1 % line / 90.0 % branch / 100 % method** for `NovaSharp.Interpreter.Interop.BasicDescriptors.MemberDescriptor` due to inlined `return` sites.
- Hardwired descriptor helpers (member + method) now covered via `HardwiredDescriptorTests`, validating access checks, conversions, and default-argument marshalling.
- `OsSystemModule` edge paths validated with platform stub tests (non-zero exits, missing files, rename/delete failures, setlocale placeholder), driving coverage to 98 %.
- `debug.debug` loop now exercised via queued debug console hooks, confirming prompt/print wiring and error reporting without manual REPL interaction.
- Platform accessors (`LimitedPlatformAccessor`, `StandardPlatformAccessor`) guarded with sandbox/full IO tests.
- `EmbeddedResourcesScriptLoader` validated against embedded Lua fixture.
- `InternalErrorException` constructors covered by direct unit tests.
- `SerializationExtensions` exercised with prime/nested table scenarios and tuple/string escaping; serializer fixed to emit Lua-compliant braces/newlines.
- `ErrorHandlingModule` now sits at 100 % line / 94 % branch thanks to nested `pcall`/`xpcall` regression tests (tail-call continuations, yield requests, CLR handlers).
- `HardwiredMemberDescriptor` base getters/setters now throw under coverage, shrinking the remaining uncovered lines to the by-ref conversion paths (currently at 100 % line coverage in the latest report).
- `DynValueMemberDescriptor` now covered across read access, execution flags, setter guard, and wiring paths (primitive, table, userdata, unsupported types).
- `DebugModule` interactive loop now handles returned values, CLR exceptions, and null-input exits under test, bumping branch coverage to 77 %.
- `StandardEnumUserDataDescriptor` now exercises conversion helpers, numeric backstops, argument validation, and meta operations (85.6 % line / 88.8 % branch coverage).
- `FieldMemberDescriptorTests` (2025-11-16 12:48 UTC) now pin the AOT fallback (forcing preoptimized descriptors back to reflection), the reflection fallback for instance reads, preoptimized instance getters, the numeric-conversion shim (`double` payloads), mismatched-owner exceptions, and the `IOptimizableDescriptor.Optimize` interface path so the suite no longer relies on reflection to inspect `_optimizedGetter`. `FieldMemberDescriptor` now reports **90.0 % line / 94.7 % branch / 100 % method** coverage, and the interpreter totals land at **92.45 % line / 88.96 % branch / 94.73 % method** across **1 872** Release tests after rerunning `./scripts/coverage/coverage.ps1 -SkipBuild`; PLAN + this doc updated with the checkpoint.
- `TableModuleTests` (2025-11-16 12:56 UTC) now cover the remaining table-library gaps (§6.6 “Table Manipulation”): numeric sorts, invalid comparator types, comparator/metamethod error propagation, custom `__lt` metatables, comparators that always return `false`, cross-type sort failures, positional validation for `table.insert`, the extra-argument guard for `table.remove`, and `__len`-powered insertions. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` records `NovaSharp.Interpreter.CoreLib.TableModule` at **99.2 % line / 98.9 % branch / 100 % method**, raising interpreter totals to **92.58 % line / 89.11 % branch / 94.73 % method** across **1 881** Release tests; `PLAN.md` captures the checkpoint.
- `StandardIoFileUserDataBaseTests` (2025-11-16 13:03 UTC) exercise the Lua §6.8 input/output helpers by asserting that `tableio.stdout`-style handles refuse to close, still accept writes after the error tuple, honor `__len`/reader initialization for standard input streams, and surface the canonical `"cannot close standard file"` error tuple. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` now reports `NovaSharp.Interpreter.CoreLib.IO.StandardIoFileUserDataBase` at **100 % line / 100 % method** (no branch instrumentation) while interpreter totals remain **92.58 % line / 89.11 % branch / 94.78 % method** across **1 883** Release tests; `PLAN.md` updated accordingly.
- `StreamFileUserDataBaseTests` (2025-11-16 13:19 UTC) now drive the remaining §6.8 “Input and Output Facilities” edge cases: attempting operations on closed handles, writer-only EOF checks, direct `Peek` usage, `file:flush` general-exception wrapping, invalid/exceptional `file:seek` scenarios, `file:setvbuf` failures via buffered-flush errors, and Lua-level guards for `io.flush`. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` records `NovaSharp.Interpreter.CoreLib.IO.StreamFileUserDataBase` at **95.2 % line / 90.6 % branch / 100 % method** (up from 84 % line) and keeps interpreter totals at **92.69 % line / 89.15 % branch / 94.83 % method** across **1 890** Release tests; `PLAN.md` documents the checkpoint.
- `CallbackFunction` now sits at **91.3 %** line coverage thanks to colon-operator handling tests, default access mode validation, and delegate/visibility checks; closure-centric tests also cover entry-point metadata and call overloads, lifting `Closure` to **86.6 %** while documenting the remaining `_ENV` constraint.
- `ParameterDescriptor` is fully covered (**100 %** line) after exercising type restriction constructors, by-ref wiring, `OriginalType` fallbacks, and `ToString` formatting.
- `LoadModule` now reports **91.3 %** line / **86.9 %** branch coverage following new NUnit cases for reader concatenation, safe-environment failure, `loadfile` error tuples, and `dofile` success/error flows.
- `IoModule` climbed to **93.2 %** line / **88.0 %** branch coverage via expanded tests (default stream setters, flush/close, iterator API, binary encoding guardrails, tmpfile lifecycle, and `IoExceptionToLuaMessage` fallbacks).
- `ScriptRuntimeException` factory helpers now execute under `ScriptRuntimeExceptionTests`, covering table index errors, conversion failures, coroutine guard rails, access-on-statics paths, and `Rethrow` behaviour (interpreter line coverage holds at 86.5 % with the new tests).
- `ExprListExpression` tuple compilation/evaluation paths now run under NUnit, retiring the parser red list entry (91.6 % line coverage).
- `ScriptExecutionContext` reached 96.2 % line / 86.3 % branch coverage after backfilling AdditionalData, Call (yield/tail/metamethod), and EvaluateSymbol edge paths.
- `FastStack<T>` is now fully exercised (100 % line/method coverage) through explicit interface validation and reflection-based zeroing checks.
- `EventMemberDescriptor` now sits at 94 %+ coverage after exercising add/remove failure paths, static facades, and assignment guards.
- `CharPtr` climbed to 98.8 % line coverage by validating byte-array conversions, pointer arithmetic, navigation helpers, and null equality branches.
- `DescriptorHelpers` now reports 92.9 % line / 90.1 % branch coverage after supplementing visibility, identifier shaping, and SafeGetTypes guard scenarios.
- Expanded `ReflectionSpecialName` operator mapping tests (additional arithmetic/relational cases) to drive branch coverage; rerun `scripts/coverage/coverage.ps1` to confirm the updated instrumentation.
- `OsTimeModule` now sits at 97 % line coverage after adding missing-field, pre-epoch, and conversion-specifier tests.
- `DebuggerAction` coverage lifted to 100 % by testing constructor timestamps, age calculations, defensive line storage, and breakpoint formatting.
- `CompositeUserDataDescriptor` now covered at 92 % via aggregate lookup, set, and metatable resolution tests (`CompositeUserDataDescriptorTests`).
- `DispatchingUserDataDescriptor` crossed the ≥90 % threshold at **94.2 %** line / **93.3 %** branch (2025-11-15 13:47 UTC) after adding tests for duplicate-member guardrails, overload aggregation, `SetIndex` setters/fallbacks, optimizer fan-out, helper-name wrappers, unsupported metamethod requests, and non-comparable/`null` metamethod scenarios. `NovaSharp.Interpreter.DataTypes.UserData` remains fully covered (**100 %**) thanks to the assembly-scan fallback and default-policy regression tests.
- `NovaSharp.Interpreter.DataTypes.UserData` is now **100 %** covered after the latest `UserDataTests` sweep hardened the default-registration-policy rejection path, proxy factories, generic helpers, equality/mixed null scenarios, and assembly scanning (with a .NET 8-friendly fallback when `Assembly.GetCallingAssembly` throws).
- `UndisposableStream` reaches 94 % line coverage after forwarding/guard tests ensured dispose/close suppression and async passthrough behaviour.
- `LuaStateInterop.Tools` climbs to 94 % line coverage after adding targeted numeric checks, conversion, meta-character substitution, and formatting regressions.
- `PlatformAccessorBase` branches (Unity, Mono, portable, AOT, prompt bridging) now covered via detector flag shims, keeping platform naming logic under regression.
- Added `EventFacadeTests` (happy-path add/remove, unsupported indices, setter guard) to pin runtime behaviour ahead of reflection descriptor expansion.
- Added `EventMemberDescriptorTests.RemoveCallbackWithoutExistingSubscription` to exercise the branch where removal is requested before any handler is registered, keeping delegate bookkeeping code under coverage.
- Added `UnityAssetsScriptLoaderTests.ReflectionConstructorSwallowsMissingUnityAssemblies` to cover the reflection-based initialization path when Unity assemblies are absent.
- Added `LoopBoundaryTests` to cover the loop guard implementation (boundary detection and error propagation).
- Added `NodeBaseTests` to assert token helpers (`CheckTokenType`, `CheckMatch`, `CheckTokenTypeNotNext`) and their error branches.
- Added `StandardGenericsUserDataDescriptorTests` so the generics descriptor (ctor validation, Index/MetaIndex, Generate) is exercised without relying on manual reflection.
- Added `CoroutineApiTests` to drive enumerable helpers, Unity coroutine adapters, CLR callback transitions, and `AutoYieldCounter`, boosting coroutine coverage.
- Added `FastStackTests` to cover push/pop/remove/expand/crop paths in the fixed-capacity stack implementation.
- `SourceRefTests` now cover `ToString()`, collapsed-line distance calculations, mid-slice line checks, and the single-line formatting branch, lifting `NovaSharp.Interpreter.Debugging.SourceRef` to **96.0 % line / 86.0 % branch / 100 % method** (coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` on 2025-11-16 14:03 UTC). `ExitCommandTests` continue to drive the CLI `exit` path to 100 %, keeping NovaSharp.Cli line coverage at 79.7 %.
- `NodeBaseTests` exercise the single/two/three-token overloads (match and mismatch), the “not next” guard, and the `LoadingContext` getter, so `NovaSharp.Interpreter.Tree.NodeBase` now sits at **100 % line / 100 % branch / 100 % method** (coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` on 2025-11-16 14:13 UTC), nudging interpreter totals to **92.85 % line / 89.38 % branch / 94.97 % method** across **1 916** Release tests.
- `LoadModuleTests` now exercise `require`, `load`, and `loadfilesafe` paths (LoadModule at 71 % line coverage), and `SyntaxErrorExceptionTests`/`DynamicExpressionException` assertions ensure parser errors honour nested rethrow rules and message prefixes.
- `EventMemberDescriptorTests` expanded with compatibility guards and multi-signature dispatch checks, lifting event coverage to 53 % and validating zero-arg/multi-arg pathways.
- `AutoDescribingUserDataDescriptorTests` verify name/type exposure plus index/set/meta forwarding to IUserDataType, keeping self-describing userdata behaviour under regression tests.
- `StandardEnumUserDataDescriptorTests` ensure flag helpers, numeric coercion, and signed/unsigned paths work correctly, raising enum descriptor coverage to 67.4 %.
- `UnityAssetsScriptLoaderTests` cover path normalization, missing-script diagnostics, and enumeration helpers, boosting loader coverage while keeping Unity packaging logic under regression.
- `WatchItemTests` exercise formatting/null-handling, closing out the debugging watch surface (now 100 % covered), while `ValueTypeDefaultCtorMemberDescriptorTests` confirm validation/instantiation paths and lift the descriptor to 78.5 %.
- `ScriptLoaderBaseTests` now validate LUA_PATH overrides, ignore flags, environment fallbacks, and string-path unpacking (coverage jumps to 96.9 %; rerun `./scripts/coverage/coverage.ps1` after the latest CharPtr work to capture the uplift).
- `CharPtrTests` and `DescriptorHelpersTests` target KopiLua interop and descriptor utilities (visibility helpers, identifier normalization), with `DescriptorHelpers` now following the Wallstop string helpers’ rules so digit suffixes stay contiguous and Pascal initials are preserved.
- `EventMemberDescriptorTests` now drive delegate creation for 1–16 parameter events, covering the previously untested switch cases in `EventMemberDescriptor.CreateDelegate`.
- `LuaStateInteropToolsTests` exercise additional format specifiers (`%#o`, `%p`, `%n`, space flag) so `LuaStateInterop.Tools` now accounts for zero-padding, pointer, and positive-space branches.
- `FastStackTests` include negative/no-op removals, overflow guards, single-slot clearing, and full resets, covering `FastStack.RemoveLast` and `FastStack.Clear` edge paths.
- `DotNetCorePlatformAccessorTests` validate file mode parsing, console output, filesystem helpers, and the NotSupported command path, tightening coverage for the .NET Core platform accessor shim.
- `JsonModuleTests` exercise invalid parse/serialize inputs plus `json.isnull`/`json.null`, backfilling JsonModule’s error and null-handling branches.
- `ClosureContextTests` ensure closure symbol arrays and stored values are covered, trimming Execution.Scopes coverage debt.
- (2025-11-18 21:40 UTC) Expanded `Units/ByteCodeTests` with coverage for the jump-point helpers (`GetJumpPointForNextInstruction`, `GetJumpPointForLastInstruction`, `GetLastInstruction`), `EmitInvalid`, and the filtered `EmitClean` subset path. `NovaSharp.Interpreter.Execution.VM.ByteCode` now reports **100 % line / 100 % branch / 100 % method** coverage, pushing interpreter aggregates to **95.6 % line / 92.6 % branch / 97.8 % method** across **2 268** Release tests.
- (2025-11-18 21:53 UTC) Added guard-rail tests to `Units/DebugServiceTests`, covering the null `src` and `lines` branches inside `DebugService.ResetBreakpoints`. `NovaSharp.Interpreter.Debugging.DebugService` now reports **100 % line / 100 % branch / 100 % method** coverage, nudging interpreter totals to **95.6 % line / 92.6 % branch / 97.8 % method** across **2 270** Release tests.
- (2025-11-18 22:06 UTC) Extended `Units/MethodMemberDescriptorTests` to cover HideMembers access-mode rejection, pointer/generic return constructors, pointer-parameter constructors, the reflection-mode action branch, and the by-ref optimization guard. Coverlet still reports `MethodMemberDescriptor` at **91 % line / 86 % branch** because the exception-only sequence points (`throw new ArgumentException(...)`) remain uncounted, but the new fixtures prove the guardrails and should unblock further investigation into Coverlet’s handling of throw-only branches.
- (2025-11-18 22:18 UTC) Added arithmetic/comparison regression tests to `Units/BinaryOperatorExpressionTests` (table-driven Add/Sub/Mul/Div/Power, string `<`, `<=` mismatches, nil/void equality, and the `>` inversion path). Runtime behaviour is now guarded, yet Coverlet still flags the defensive guard clauses (`Expression reduction didn't work`, `OperatorToOpCode` default, and comparison fallback) leaving `BinaryOperatorExpression` at **93.6 % line / 89.4 % branch**. Additional work is needed either to restructure the guard logic or to synthesize inputs that legitimately exercise those failure paths without relying on reflection.
- (2025-11-18 21:33 UTC) Extended `Units/TablePairTests` to cover the `Equals(object)` mismatches, key-miss short-circuit branch, and null-hash paths. `NovaSharp.Interpreter.DataTypes.TablePair` now reports **93.3 % line / 100 % branch / 90 % method** coverage, contributing to the interpreter’s **92.6 %** branch total.
- `PropertyTableAssignerTests` exercise expected/missing properties, subassigners, fuzzy matching, and type guards across both generic and non-generic assigners.
- `SliceTests` verify indexing, enumeration order, conversions, and NotSupported pathways for the slice view helper.
- `InteropRegistrationPolicyTests` ensure the default/automatic/explicit policy factories return the expected registration policies and that `Explicit` remains marked obsolete.

## Updating the Snapshot
```powershell
./scripts/coverage/coverage.ps1
# Copy docs/coverage/latest/Summary.json entries into the tables above.
```

_Last updated: 2025-11-19 (09:24 UTC)_




