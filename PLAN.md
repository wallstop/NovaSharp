# Modern Testing & Coverage Plan

## Modernization Baseline (Nov¬†2025)
- üîÑ Schedule a full audit of runtime + test code that still relies on reflection (private field/method access, magic-string member names). Replace those patterns with explicit `internal` helpers (covered by the existing `InternalsVisibleTo`), add `nameof` usage where string literals remain unavoidable, and document any exceptions in the modernization notes. Track the audit progress and reflection removals in this plan plus `docs/Modernization.md`.
  - üîù Purge `#region`/`#endregion` directives across the entire repository and harden the guidelines so they never return. Inventory the current usage via `rg --line-number '#region'`, delete the blocks (keeping any necessary comments), and follow up with analyzer/script enforcement if needed. Update `AGENTS.md` (and any other contributor guidance) to state unambiguously that regions are forbidden everywhere.
    - ‚úÖ (2025-11-23 11:05 UTC) Removed every `#region`/`#endregion` directive from the runtime, tooling, debugger, samples, and generated hardwire descriptors (verified via `rg -n '#region'` returning only plan/documentation references). `FastStack`, `Table`, `DispatchingUserDataDescriptor`, tutorial chapters, LuaPort `Tools`, `_Hardwired.cs`, and debugger servers now rely solely on method-level doc comments so contributors can no longer hide logic behind folding markers.
- üîù Run a repo-wide spelling & naming audit to ensure every identifier and comment uses correct English wording *and* conforms to the established naming schemes (PascalCase for public members, `_camelCase` for private fields, no Hungarian-style prefixes). Action items: (1) extend `tools/NamingAudit` (or wire in `codespell`/`cspell`) to flag misspellings and non-English tokens, (2) rename/fix the identified members, comments, and Lua fixture descriptions, (3) regenerate the `naming_audit.log` baseline and add CI enforcement for both naming and spelling, and (4) document the ‚ÄúEnglish-only‚Äù guideline in `AGENTS.md`/`docs/Contributing.md` so future contributions stay compliant.
  - üîù Launch an XML documentation quality pass: audit every public/internal API for complete `<summary>`, `<param>`, `<returns>`, `<remarks>`, and `<example>` entries (including code samples where helpful), add missing docs, and rewrite vague ones for clarity. Deliverables include updated XML comments across runtime/tooling/debugger projects, a lint/check step (`dotnet format --verify-analyzers` + custom doc completeness script) wired into CI, and refreshed contributor guidance describing the expectation for example-rich XML docs on all new APIs.
  - üîÑ (2025-11-23 19:43 UTC) Bootstrapped the documentation audit by adding `tools/DocumentationAudit/documentation_audit.py`, which initially reported **225** type declarations without XML comments when run as `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`. Filled in summaries/remarks for the remote-debugger networking stack (`HttpResource*`, `Utf8TcpPeer*`, `Utf8TcpServer*`, `XmlWriterExtensions`, `DebugServer`, `DebugWebHost`, `RemoteDebuggerService`, and `RemoteDebuggerOptions`) and regenerated the report, dropping the outstanding count to **214** entries captured in the refreshed `documentation_audit.log`. Next step: extend the helper to cover public/internal members, wire it into CI alongside naming/namespace audits, and continue documenting the runtime/core modules called out near the top of the log.
  - üîÑ (2025-11-23 20:25 UTC) Extended the audit helper so it now scans public/internal methods and properties (multi-line attribute aware) in addition to types. The latest run `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log` reports **1‚ÄØ298** undocumented surfaces (was 214 when only types were counted), giving us a complete backlog for the documentation milestone. As part of the same pass, converted `src/runtime/NovaSharp.Interpreter/CoreLib/BasicModule.cs` to proper XML documentation (covering `type`, `assert`, `collectgarbage`, `error`, `tostring`, `select`, `tonumber`, `print`, `warn`, and the `__tostring` continuation) so the foundational Lua API no longer suppresses CS1591.
  - üîÑ (2025-11-23 20:55 UTC) Wired the new audit into CI: `lint` and `dotnet-tests` now invoke `python3 tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log` and fail when the committed log is stale (mirroring the naming audit flow). Documented `bit32` module entry points (`extract`, `replace`, shifts, bitwise/rotate helpers) so `src/runtime/NovaSharp.Interpreter/CoreLib/Bit32Module.cs` no longer suppresses CS1591. The refreshed log now tracks **1‚ÄØ285** undocumented declarations, giving us a measurable burn-down while preventing regressions. Next steps: keep chipping away at the runtime/debugger hotspots called out near the top of the log and add contributor docs covering the audit + CI expectations.
  - üîÑ (2025-11-23 21:10 UTC) Documented the coroutine module (`coroutine.create`, `wrap`, `resume`, `close`, `yield`, `running`, `status`, `isyieldable`) so `src/runtime/NovaSharp.Interpreter/CoreLib/CoroutineModule.cs` now advertises Lua ¬ß11.3 semantics without suppressions. Running `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log` after this pass reports **1‚ÄØ277** undocumented declarations, continuing the backlog burn-down while keeping the audit visible in CI.
  - üîÑ (2025-11-23 21:30 UTC) Completed XML comments for the Lua `debug` + error-handling modules (`debug.debug`, `getuservalue`, `setuservalue`, `getregistry`, `getmetatable`, `setmetatable`, `getupvalue`, `setupvalue`, `upvalueid`, `upvaluejoin`, `traceback`, `pcall`, `xpcall`) and the binary IO helper stack (`IO/BinaryEncoding`, `IO/StandardIOFileUserDataBase`, `IO/StreamFileUserDataBase`). The refreshed audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) now reports **1‚ÄØ252** undocumented declarations. **Next:** document the remaining IO surfaces (`FileUserDataBase`, `IoModule` public entry points) to keep driving the backlog down before moving on to the debugger DTOs.
  - üîÑ (2025-11-24 20:23 UTC) Documented every remaining Lua IO surface (`FileUserDataBase`, `IoModule.*` entry points, and the numeric parsing helpers) with spec citations and removed the stale `#pragma warning disable 1591`. Re-ran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`, which now reports **1‚ÄØ226** undocumented declarations (down from 1‚ÄØ252). **Next:** pivot to the remote + VS¬†Code debugger DTO stacks called out at the top of the audit log so those subsystems stop blocking the remaining burn-down.
  - üîÑ (2025-11-24 20:45 UTC) Added XML documentation to the remote debugger stack (`DebugServer`, hosting helpers, HTTP/TCP primitives, browser launchers, `RemoteDebuggerService`, and the threading queue) and reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`. The audit now reports **1‚ÄØ196** undocumented declarations (down from 1‚ÄØ226) with the next focus area being the VS¬†Code debugger DTOs still topping the log.
  - üîÑ (2025-11-24 21:05 UTC) Documented the VS¬†Code async debugger session (`AsyncDebugger` properties, action queue, source helpers, and expression evaluation). Latest audit run reports **1‚ÄØ182** undocumented declarations, so the backlog dropped by 14 entries. **Next:** keep chipping away at the VS¬†Code debugger stack (Empty/NovaSharp sessions, protocol DTOs) since they still dominate the remaining warnings.
  - üîÑ (2025-11-24 21:25 UTC) Covered the VS¬†Code ‚Äúempty‚Äù session and async client contract with XML docs so developers understand how placeholder sessions and clients interact. After updating `documentation_audit.log`, the backlog sits at **1‚ÄØ158** undocumented declarations. Focus now shifts to `NovaSharpDebugSession` and the VS¬†Code protocol DTOs that continue to top the audit.
  - üîÑ (2025-11-24 21:45 UTC) Added XML docs to `NovaSharpDebugSession` (class summary, DAP overrides, and async client callbacks) so the main VS¬†Code session codepath is described. Re-ran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; the backlog is now **1‚ÄØ139** undocumented declarations (down from 1‚ÄØ158). Next priority: document `NovaSharpVsCodeDebugServer` + `VariableInspector` before tackling the SDK DTOs.
  - üîÑ (2025-11-24 22:05 UTC) Documented the VS¬†Code server entry points (`NovaSharpVsCodeDebugServer` real + stub members) and the `VariableInspector` helper. Latest audit run reports **1‚ÄØ130** undocumented declarations, clearing the remaining server-side debugger warnings so we can move on to the SDK/DTO types that dominate the log.
- üîÑ (2025-11-24 22:25 UTC) Filled in XML docs for the VS¬†Code SDK surface (`DebugSession` DTOs, response bodies, protocol framing/server utilities). The regenerated audit now reports **1‚ÄØ025** undocumented declarations, so the debugger stack is fully covered. **Next:** document the compatibility/framework helpers at the top of the log (`FrameworkBase`, `FrameworkClrBase`, `FrameworkReflectionBase`, `Framework`, and the `FrameworkCore/CLR/PCL/Win8` specializations) before moving on to the runtime modules.
- üîÑ (2025-11-24 22:55 UTC) Documented the compatibility framework stack (`FrameworkBase`, `FrameworkReflectionBase`, `FrameworkClrBase`, the `Framework` selector, and every `FrameworkCurrent` specialization) so the reflection bridge is now fully described for all targets. Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; the backlog drops to **924** undocumented declarations (down from 1‚ÄØ025). **Next:** keep chipping away at the compatibility helpers topping the log (`Stopwatch`, `LuaCompatibilityProfile`, and `AstNode`) before diving into the remaining runtime modules.
- üîÑ (2025-11-24 23:06 UTC) Finished the compatibility helper follow-up by documenting the lightweight `System.Diagnostics.Stopwatch` shim, `LuaCompatibilityProfile.GetDisplayName`, and the `CodeAnalysis.AstNode` marker so every reflection/compatibility entry point now explains its role. The refreshed audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **918** undocumented declarations. **Next:** begin working through the runtime modules still dominating the top of the log (starting with `DynamicModule`, `JsonModule`, and `LoadModule`).
- üîÑ (2025-11-24 23:10 UTC) Cleared the top runtime-module offenders by documenting `DynamicModule` (init/eval/prepare), the full `json` surface (parse/serialize/null helpers), and every public entry point in `LoadModule` (load/loadsafe/loadfile*/dofile/require helpers plus error utilities). Regenerated the audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`); backlog now sits at **901** undocumented declarations. **Next:** tackle the next items in the report (`ErrorHandlingModule`, `MathModule`, and `MetaTableModule`) to keep burning down the core library debt.
- üîÑ (2025-11-24 23:15 UTC) Documented the remaining core-library hot spots: `ErrorHandlingModule` continuations now explain how `pcall`/`xpcall` wrap Lua return values, the entire `math` module (constants, init, and every exported function) carries Lua ¬ß6.7 summaries, and all metatable/raw helpers describe their semantics and protections. Latest audit run (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **862** undocumented declarations (down from 901). **Next:** focus on the utility modules now topping the log (`ModuleArgumentValidation`, `OsSystemModule`, `OsTimeModule`, and `StringRange`/`StringModule`). 
- üîÑ (2025-11-24 23:20 UTC) Landed XML docs for the guard helpers (`ModuleArgumentValidation`), host OS shims (`os.execute`/`os.time` families), and `StringRange`; these now cite the Lua ¬ß6.9 semantics and describe the 1-based slicing behaviour. Re-ran the audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`), dropping the backlog to **841** entries (down from 862). **Next:** move on to the string module proper plus table/utf8 helpers that now dominate the core-lib list.
- üîÑ (2025-11-24 23:25 UTC) Documented the bulk of the string/table APIs: every exported `string.*` function now describes its Lua ¬ß6.4 behaviour (dump, pattern helpers, case transforms, substring utilities, NovaSharp-only contains/startsWith/endsWith), table iterators gained summaries, `table` pack/unpack/sort/insert/remove/concat/move` all cite ¬ß6.6 semantics, and the UTF-8 helpers document their code-point behaviour. Latest audit run reports **806** undocumented declarations (down from 841). **Next:** finish the remaining string internals (`StringModule.TestHooks`), then tackle the data-structure/core runtime types still dominating the log (FastStack, Coroutine, Table, etc.).
- üîÑ (2025-11-24 23:30 UTC) Cleaned up the remaining string/table internals and the foundational stack/index types: `StringModule.TestHooks`, both FastStack variants, and `LinkedListIndex.TryGetValue` now explain their intent, and `documentation_audit.log` reflects the new backlog of **782** undocumented entries. **Next:** focus on the core runtime data structures (FastStack test hooks, Coroutine lifecycle helpers, IScriptPrivateResource, SymbolRef/Table/TablePair) before moving on to the VM/bytecode surfaces.
- üîÑ (2025-11-24 23:35 UTC) Documented the diagnostics suite (`IPerformanceStopwatch`, Dummy/Global/regular stopwatches, `PerformanceStatistics.TestHooks`), the remaining coroutine/ownership helpers, `LuaIntegerHelper`, and the instruction metadata flags. Latest audit run reports **738** undocumented declarations (down from 782). **Next:** tackle the runtime compiler structures (BuildTime/Runtime scopes, ScriptExecutionContext/ScriptLoadingContext) and start chipping away at the VM/bytecode/diagnostics classes called out at the top of the new report.
- üîÑ (2025-11-24 23:45 UTC) Documented the build-time scope stack (`BuildTimeScope`, scope frames/blocks, closure builder), the loop tracker/runtime scope metadata, and both execution/loading contexts (including `ScriptExecutionContext.IsYieldable`). Re-ran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`, dropping the backlog from **738** to **675** undocumented declarations. **Next:** dive into `Execution/VM` (starting with `ByteCode` and the `Processor` partials) so the remaining top-of-log entries keep shrinking.
- üîÑ (2025-11-25 00:25 UTC) Documented the VM surfaces called out at the top of the audit: `ByteCode` (class + every emitter), the public `Processor` API plus scope/execution/test-hook helpers, and the supporting VM types (`Instruction`, `ExecutionState`, call-stack metadata, opcodes). Latest audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **574** undocumented declarations (down from 675). **Next:** continue through the remaining `Processor` partials (binary dump, coroutines, debugger, instruction loop) before moving on to the infrastructure/interop entries that follow them in the report.
- üîÑ (2025-11-25 00:50 UTC) Finished documenting the remaining `Processor` partials: debugger context/action plumbing, coroutine lifecycle helpers, binary dump/undump, error decoration, and utility functions now all carry XML docs plus `<content>` annotations so analyzers understand each partial‚Äôs role. `ProcessorInstructionLoop.PerformMessageDecorationBeforeUnwind` gained a summary too. Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog is down to **543** entries (from 574). **Next:** move on to the infrastructure stack (`Infrastructure/*`) and start chipping away at the interop converters/descriptors called out near the top of the refreshed report.
- üîÑ (2025-11-25 01:00 UTC) Documented the infrastructure abstractions (`IHighResolutionClock`, `ITimeProvider`) and their production implementations so every method/property now explains how NovaSharp captures time. Latest audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **533** undocumented declarations (down from 543). **Next:** focus on the interop converters/descriptors at the top of the report to keep driving the backlog lower.
- üîÑ (2025-11-25 01:20 UTC) Covered the interop attribute + converter stack: `LuaCompatibilityAttribute` now documents its properties, all converter helpers (`ClrToScriptConversions`, `ScriptToClrConversions`, string/table converters) and descriptor utilities/interfaces (`DescriptorHelpers`, `IUserDataMemberDescriptor`, `EnumerableWrapper`, `ReflectionSpecialNames`, `DispatchingUserDataDescriptor.Optimize`) carry XML summaries. Regenerated the audit (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`); backlog dropped to **508** entries (down from 533). **Next:** continue through the remaining interop descriptors (`StandardDescriptors/*`, `UserDataMemberType`, `EventFacade`, hardwired/reflective descriptors) before moving to IO/platform modules.
- üîÑ (2025-11-25 01:40 UTC) Documented the remaining interop descriptors: `EventFacade`, hardwired descriptor base classes, enum helpers, reflection event callbacks, `UserDataMemberType`, and `StandardUserDataDescriptor.PrepareForWiring` all carry XML summaries. Reflection-based field optimizations now describe their caching semantics too. Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog is down to **482** entries (from 508). **Next:** tackle the IO/platform utilities (`IO/*`, `PlatformAutoDetector`, `StandardPlatformAccessor`) before moving to diagnostics/errors.
- üîÑ (2025-11-25 02:00 UTC) Documented the IO + platform utilities: the bin-dump reader/writer and the undisposable stream now describe their compression/sharing behaviour, `InvalidScriptLoader` explains its error semantics, and `PlatformAutoDetector`/`StandardPlatformAccessor` gained summaries across their helper methods. Latest audit run reports **450** undocumented declarations (down from 482). **Next:** move on to diagnostics + error types (`Diagnostics/*`, `Errors/*`) before tackling the large tree/runtime sections listed later in the report.
- ‚ö†Ô∏è (2025-11-25 02:12 UTC) Started documenting diagnostics/error types but realized the audit total stayed flat; `GlobalPerformanceStopwatch.Dispose` still needs coverage before the count drops further. Pausing here to avoid an accidental regression and will resume once the missing summary is added.
- üîÑ (2025-11-25 02:35 UTC) Documented `GlobalPerformanceStopwatch` (scope summary + owner-facing remarks) so the nested `Scope.Dispose` method now explains how elapsed time is recorded. Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`, dropping the backlog to **449** entries; diagnostics now unblock. **Next:** add XML docs for `PerformanceStatistics.GlobalClock` and its `TestHooks` helper before diving into the remaining error types.
- üîÑ (2025-11-25 02:45 UTC) Added XML summaries for `PerformanceStatistics.GlobalClock` (documenting the shared high-resolution clock) and `PerformanceStatistics.TestHooks`, then reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog now sits at **447** entries. **Next:** tackle the interpreter error types topping the log (`InterpreterException`, `ScriptRuntimeException`, `SyntaxErrorException`) so diagnostics keep shrinking.
- üîÑ (2025-11-25 03:00 UTC) Documented the interpreter error hierarchy: `InterpreterException` now explains its decoration helpers, `ScriptRuntimeException` covers the `__close` guard + rethrow semantics, and `SyntaxErrorException` documents token metadata plus its REPL-facing flags. Latest audit run (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **439** undocumented declarations. **Next:** move on to the remaining error classes (`DynamicExpressionException`, `InternalErrorException`) before diving into the tree/lexer backlog.
- üîÑ (2025-11-25 03:10 UTC) Added summaries for `DynamicExpressionException` and `InternalErrorException` (after the serialization guards) so dynamic-expression failures and internal guardrails show up in IntelliSense. Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog now sits at **437** entries. **Next:** start documenting the descriptor stack (`DefaultValue`, reflection member descriptors) which continues to top the audit list.
- üîÑ (2025-11-25 03:20 UTC) Documented the descriptor scaffolding: `DefaultValue` now advertises its sentinel role, and the reflection descriptors (`MethodMemberDescriptor`, `OverloadedMethodMemberDescriptor`, `PropertyMemberDescriptor`) gained XML docs for their optimization helpers and `TestHooks`. Latest audit run (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **425** undocumented declarations. **Next:** move on to the modding/IO helpers (`InvariantString`, `IModFileSystem`, platform detectors) before tackling the massive tree/lexer backlog.
- üîÑ (2025-11-25 03:35 UTC) Documented the modding/platform helpers (`InvariantString`, `IModFileSystem`, nested manifest model fields, manifest compat helpers, physical file system, `CoreModulesExtensionMethods`, `PlatformAutoDetector` internals, PCL `StandardPlatformAccessor`, REPL test hooks) and reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog now sits at **381** entries. **Next:** continue reducing the runtime backlog by covering `Script` internals and the serialization/core tree types called out at the top of the audit.
- üîÑ (2025-11-25 03:45 UTC) Documented `Script.StartTimeUtc`, the test-only processor/bytecode accessors, plus the serialization stack (`JsonNull`, `ObjectValueConverter`, `SerializationExtensions`). Latest audit run (`python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`) reports **371** undocumented declarations. **Next:** focus on the AST/lexer hierarchy (Expression tree, lexer utilities, tokens) before tackling CLI/tooling gaps.
- üîÑ (2025-11-25 03:55 UTC) Added XML docs to the core expression parser (`Expression` class + helpers), then reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`. Backlog now sits at **362** entries, with the remaining hot spots concentrated in the AST subclasses (`AdjustmentExpression`, `BinaryOperatorExpression`, lexer/token definitions). **Next:** continue through those expression/lexer files to keep chipping away at the runtime backlog.
- üîÑ (2025-11-25 04:05 UTC) Documented the remaining expression nodes tackled this pass (`AdjustmentExpression`, `DynamicExprExpression`, `ExprListExpression`, `FunctionCallExpression`, plus the BinaryOperator test helpers) and reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; backlog now sits at **337** entries. **Next:** keep working through the expression subclasses (`FunctionDefinitionExpression`, `IndexExpression`, literals/symbol refs) before moving on to the lexer/token types and CLI toolchain.
- üîÑ (2025-11-25 05:05 UTC) Knocked out the follow-up backlog by documenting the outstanding expression nodes (`FunctionDefinitionExpression`, `IndexExpression`, `LiteralExpression`, `SymbolRefExpression`, `TableConstructor`, `UnaryOperatorExpression`), the parser/loader helpers (`IVariable`, `LoaderFast`), and the lexer/token infrastructure (`Lexer`, `LexerUtils`, `Token`, `TokenType`, plus the `SourceCode`/`SourceRef` debug surfaces). Reran `python tools/DocumentationAudit/documentation_audit.py --write-log documentation_audit.log`; the backlog drops from **337** to **278** entries. **Next:** work through the tree statement classes now topping the log (`Loop`, `NodeBase`, `Statement`, and the various statement subclasses) before pivoting to the Benchmarks/CLI tooling items.
- ## Testing Health Snapshot
- ‚úÖ Runtime semantics target **Lua 5.4.8**; see `docs/LuaCompatibility.md` for tracked deltas and follow-ups.
- Runner: `src/tests/NovaSharp.Interpreter.Tests` (`net8.0`) executes **‚âà2‚ÄØ550 Release tests** per pass (Lua TAP suites `TestMore_308_io` and `TestMore_309_os` stay disabled unless explicitly enabled).
- Command: `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --logger "trx;LogFileName=NovaSharpTests.trx"` is the canonical entry point; the bespoke TAP harness has been removed.
- Coverage: `scripts/coverage/coverage.ps1` (coverlet.console + `dotnet test` + reportgenerator) enforces **‚â•95‚ÄØ% line / ‚â•95‚ÄØ% branch / ‚â•95‚ÄØ% method** on `NovaSharp.Interpreter`; the latest Release snapshot (2025‚Äë11‚Äë20 10:16‚ÄØUTC) reports **96.9‚ÄØ% line / 95.1‚ÄØ% branch / 98.4‚ÄØ% method** with artefacts under `artifacts/coverage` and HTML dashboards in `docs/coverage/latest`.
- Suite composition:
  - **Lua TAP fixtures** validating language semantics and standard library parity.
  - **End-to-end NUnit scenarios** covering userdata interop, debugger attach, coroutine pipelines, serialization, JSON.
  - **Unit tests** for low-level primitives (virtual machine stacks, binary dump/load, interop policies).
- CI (`.github/workflows/tests.yml`):
  - Restores and builds `src/NovaSharp.sln` in Release.
  - Executes `dotnet test` against `NovaSharp.Interpreter.Tests` and uploads `artifacts/test-results` (TRX + attachments).
  - The `code-coverage` job runs `./scripts/coverage/coverage.ps1`, appends the Markdown summary to the job output, posts a PR comment (line/branch/method), and uploads both raw coverage data and a zipped HTML dashboard.
- Benchmarks (`NovaSharp.Benchmarks`, `NovaSharp.Comparison`) compile but never run in CI; they must be invoked manually to update `docs/Performance.md`.

## Coverage Strengths
- Lua semantics, coroutine scheduling, binary dump/load, JSON, interop policy, and hardwire regeneration paths have broad regression protection.
- TAP fixtures catch regressions against upstream Lua behaviour.
- Benchmark baselines establish performance + allocation expectations for script loading and runtime scenarios.

## Gaps & Risks
- **Debugger automation**: No integration tests for VS¬†Code or remote debugger protocols.
- **Tooling**: CLI shell and remaining tooling projects lack regression coverage after modernization.
- **Cross-platform**: CI only runs on Linux; Windows/macOS coverage still manual.
- **Observability**: Coverage summaries now post automatically on PRs, but there is still no gating/threshold enforcement or historical trend tracking.
- **Skip-list debt**: IO/OS TAP suites remain permanently skipped without compensating coverage.
- **Unity onboarding**: Basic packaging workflow is documented in `docs/UnityIntegration.md`; still need automated packaging and refreshed Unity samples.
- **Enum allocation audit**: .NET `Enum.HasFlags` and default `ToString()` allocate; add follow-up to port the no-alloc helpers from DxMessaging/UnityHelpers (bitmask tests + generated name maps) so enum-heavy interpreter paths stay allocation-free while keeping user-friendly names.
- **Custom data-structure alignment**: Audit NovaSharp‚Äôs bespoke collections (`LinkedListIndex`, `FastStack`, `MultiDictionary`, etc.) against standard .NET API patterns to ensure naming/behavior matches BCL expectations and expensive anti-patterns (e.g., `ContainsKey` + indexer) are eliminated. Scope includes: inventorying our helper types, profiling cache-hit scenarios, replacing double-lookups with `TryGetValue`, and documenting preferred usage patterns. The goal is to retain our performance wins while keeping the APIs intuitive for .NET developers and minimizing redundant dictionary lookups.
- **Warning hygiene**: Release builds still emit ~4‚ÄØ000 analyzer warnings; we need to drive that to zero before enforcing `TreatWarningsAsErrors` everywhere so `dotnet build`/`scripts/coverage/coverage.ps1` stay hands-free.
  - ‚úÖ First CA sweep landed (duplicate `using` cleanup, invariant debugger formatting, null guards in `DynamicExpression`, `SourceRef`, `DebugService`, etc.); the TAP regression suite (`TestMore104Number`) now passes after the loader/path fixes.
  - ‚úÖ (2025-11-22 15:10 UTC) Hardened the public `ScriptRuntimeException` helpers (`ArithmeticOnNonNumber`, `ConcatOnNonString`, `LenOnInvalidType`, `BitwiseOnNonInteger`, `IndexType`, `BadArgumentUserData`) with explicit null guards so CA1062 no longer fires when analyzer enforcement is enabled; reran `dotnet test ‚Ä¶ --filter ScriptRuntimeExceptionTests` to keep behaviour unchanged.
  - ‚úÖ (2025-11-22 15:32 UTC) Added `ModuleArgumentValidation` and threaded it through `coroutine`, `dynamic`, and error-handling modules so every externally visible entry point now performs explicit null checks on `ScriptExecutionContext`/`CallbackArguments`. This clears a large batch of CA1062 diagnostics in the runtime hot paths; verified via `dotnet test ‚Ä¶ --filter "FullyQualifiedName~CoroutineModuleTests|FullyQualifiedName~DynamicModuleTests|FullyQualifiedName~ErrorHandlingModuleTests"`.
  - ‚úÖ (2025-11-22 15:55 UTC) Guarded `BasicModule.error`/`select` to satisfy CA1062 without regressing the null-context scenarios covered by `BasicModuleTests.Select*`; reran `dotnet test ‚Ä¶ --filter BasicModuleTests` to confirm behaviour stays Lua-compatible.
  - ‚úÖ (2025-11-22 16:18 UTC) Extended the guard helper to cover tables/scripts and applied it across `IoModule` (NovaSharpInit, default-stream setters, `close`/`flush`/`lines`/`open`/`type`/`read`/`write`/`tmpfile`, etc.), eliminating the CA1062 warnings for those APIs. Validated with `dotnet test ‚Ä¶ --filter IoModuleTests`.
  - üîÑ Next CA sweep: apply the same guard patterns to the remaining module hotspots (`LoadModule`, `JsonModule`, `TableModule`, `Bit32Module`, `MetaTableModule`, etc.), then tackle the lingering analyzer buckets (CA1305 locale-sensitive formatting, CA184x perf hints, CA1859 dictionary access) so `dotnet build` can run cleanly before flipping `TreatWarningsAsErrors`.
  - ‚úÖ (2025-11-22 04:01 UTC) Threaded `ModuleArgumentValidation` through `LoadModule` (NovaSharpInit, `load`/`loadsafe`, `loadfile`/`loadfilesafe`, `dofile`, `__require_clr_impl`, and the shared helpers) so every externally visible entry point now protects `ScriptExecutionContext`, `CallbackArguments`, and table/script inputs before dereferencing them. Confirmed the Lua-facing behaviour via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter FullyQualifiedName~LoadModuleTests`; CA1062 warnings for LoadModule are cleared, and the remaining sweep now focuses on `JsonModule`, `MetaTableModule`, and friends.
  - ‚úÖ (2025-11-22 04:28 UTC) Added `ModuleArgumentValidation` guards to every `MetaTableModule` entry point (`setmetatable`, `getmetatable`, `rawget`, `rawset`, `rawequal`, `rawlen`) so CA1062 no longer fires when analyzers inspect those APIs. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter FullyQualifiedName~TestMore301`.
  - ‚úÖ (2025-11-22 04:36 UTC) Applied the same guard pattern to the `bit32` module (`extract`, `replace`, shifts, rotates, band/btest/bor/bnot/bxor). Updated the NUnit suite to create a dynamic `ScriptExecutionContext` so tests still call the APIs directly, then reran `dotnet test ‚Ä¶ --filter FullyQualifiedName~Bit32ModuleTests`.
  - ‚úÖ (2025-11-22 04:28 UTC) Added `ModuleArgumentValidation` guards to every `MetaTableModule` entry point (`setmetatable`, `getmetatable`, `rawget`, `rawset`, `rawequal`, `rawlen`) so CA1062 no longer fires when analyzers inspect those APIs. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter FullyQualifiedName~TestMore301`.
  - ‚úÖ (2025-11-23 23:05 UTC) Wrapped the math/string/os.time/table iterator modules with `ModuleArgumentValidation` and swapped all culture-sensitive operations to invariant/ordinal comparisons (`StringModule.StartsWith/EndsWith/Contains`, `UnityAssetsScriptLoader` error output). Targeted `dotnet test ‚Ä¶ --filter "FullyQualifiedName~MathModuleTests|FullyQualifiedName~StringModuleTests|FullyQualifiedName~OsTimeModuleTests|FullyQualifiedName~TableIteratorsModuleTests"` now passes while CA1062/CA1307 warnings for those modules disappear.
  - ‚úÖ (2025-11-23 22:40 UTC) Hardened `UnityAssetsScriptLoader` to satisfy CA1062/CA1305/CA1854/CA2201/CA1725/CA1822: added argument guards, centralized invariant-culture formatting, replaced `ContainsKey`/indexer pairs with `TryGetValue`, threw `FileNotFoundException` for missing assets, renamed the `ScriptFileExists` parameter to match the base signature, and reused a shared error formatter for reflection-based initialization. Updated `UnityAssetsScriptLoaderTests.LoadFileThrowsHelpfulMessageWhenMissing` to expect the new exception type and reran `dotnet test ‚Ä¶ --filter UnityAssetsScriptLoaderTests`.
  - ‚úÖ (2025-11-23 01:23 UTC) Reworked `FileUserDataBase.Write`/`Close` so recoverable IO exceptions flow through shared helpers (`CreateIoFailure`, `IsRecoverableIoException`) instead of a blanket `catch (Exception)` block that tripped CA1031. The Lua-facing `(nil, message, -1)` tuples now come from the helper while unexpected exceptions bubble naturally. Verified via `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter IoModuleTests`.
  - ‚úÖ (2025-11-23 01:29 UTC) Tightened `IoModule.Open` so it now filters for known IO/configuration exceptions (`IOException`, `UnauthorizedAccessException`, `SecurityException`, `ScriptRuntimeException`, etc.) before returning the `(nil, message)` tuple and lets unexpected failures escape. This clears the CA1031 hit on the public `io.open` surface without regressing Lua-visible diagnostics. Checked in with `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter IoModuleTests`.
  - ‚úÖ (2025-11-23 01:32 UTC) Updated `UnityAssetsScriptLoader.LoadResourcesWithReflection` (and the Unity-native load path) so only anticipated initialization failures (reflection, IO, security, `ScriptRuntimeException`, etc.) are caught and logged; unexpected exceptions now propagate, clearing the remaining CA1031 warning. Verified with `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter UnityAssetsScriptLoaderTests`.
  - ‚úÖ (2025-11-24 00:55 UTC) Annotated `ModuleArgumentValidation` with `[NotNull]` return/parameter contracts so analyzer flow now understands that every module entry point validates its `ScriptExecutionContext`/`CallbackArguments`. Updated the helper to keep using explicit `ArgumentNullException` throws (compatible with netstandard2.1) and swapped `TableModule.Sort` to use `string.Compare(..., StringComparison.Ordinal)` so the CA1062/CA1310 warnings for `table.*` go quiet. Verified via `dotnet test ‚Ä¶ --filter "FullyQualifiedName~TableModuleTests|FullyQualifiedName~ModuleArgumentValidationTests"`; warning hygiene focus can now shift to the remaining CA13xx/CA18xx hotspots called out later in this PLAN.
  - üîÑ (2025-11-23 16:55 UTC) Hardened the JSON/serialization registration path: `JsonNull.IsJsonNull`, `SerializationExtensions.Serialize`, `SerializationExtensions.SerializeValue`, and the `ModuleRegister` entry points now throw `ArgumentNullException` for null inputs (netstandard2.1-friendly) and tuple serialization uses `Length` instead of `Enumerable.Any`. `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` confirms the associated CA1062/CA1860 warnings have cleared, shrinking the warning backlog for the serialization helpers.
  - üîÑ (2025-11-23 17:05 UTC) Knocked down the CA1859 parser/dump warnings: the loop/if/chunk statements now store `CompositeStatement`/`ExprListExpression` directly (matching the instantiated types), and `ProcessorBinaryDump` declares its writers/readers as `BinDumpBinaryWriter`/`BinDumpBinaryReader` instead of the base `BinaryWriter`/`BinaryReader`. `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` shows the redundant CA1859 hits for those areas are gone, letting the next sweep focus on the remaining IO/dictionary suggestions.
  - üîÑ (2025-11-23 17:15 UTC) Resolved the CA1859 hints in `IoModule`: `GetUtf8Encoding` now returns `UTF8Encoding` directly and the internal `Open` helper returns `FileUserData`, matching the concrete types we instantiate. `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` confirms the CA1859 noise around `GetUtf8Encoding`/`Open` is gone, so the IO sweep can move on to the remaining string-comparison and CA18xx items.
  - ‚úÖ (2025-11-24 01:05 UTC) Threaded the guard helper through `BasicModule.tonumber`, removing the lingering CA1062 warning for that entry point without changing Lua-visible behaviour. `dotnet test ‚Ä¶ --filter FullyQualifiedName~BasicModuleTests` covers the updated path.
  - ‚úÖ (2025-11-24 05:20 UTC) Standardized runtime + VS‚ÄØCode debugger formatting on `CultureInfo.InvariantCulture` so CA1305 no longer fires outside the test suite. `NumericConversions`, `PropertyTableAssigner`, `StandardUserDataDescriptor`, `Script` (chunk/banner naming), `FunctionDefinitionExpression`, and `SerializationExtensions` now pass culture-invariant format providers, and the VS‚ÄØCode debugger stack (`VariableInspector`, `EmptyDebugSession`, `NovaSharpDebugSession`, `NovaSharpVsCodeDebugServer`, `Protocol`) gained the same treatment plus `FormatString` helpers. Verified via `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` and `dotnet build src/NovaSharp.sln -c Release -nologo | Select-String "CA1305"`, which now reports remaining CA1305 hits only inside the NUnit projects called out below.
  - ‚úÖ (2025-11-24 05:55 UTC) Cleared the CA1825/CA1853/CA2208 backlog in the converter stack: `ClosureContext`, `DescriptorHelpers.SafeGetTypes`, and the `CharPtr(IntPtr)` ctor now use `Array.Empty<‚Ä¶>()` instead of allocating zero-length arrays, while `CustomConverterRegistry` no longer double-checks dictionaries before removing entries and throws `ArgumentException` with a proper `nameof` parameter. `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release` confirms the new warnings are gone, so the remaining analyzer debt can focus on the CA18xx/CA13xx items listed below.
  - ‚úÖ (2025-11-24 06:15 UTC) Knocked out a batch of CA1822 hits by marking helper methods as static where safe: `IfStatement.CreateIf/ElseBlock`, `FunctionCallStatement.RemoveBreakpointStop`, `AssignmentStatement.CheckVar`, `BinaryOperatorExpression.EvalFloorDivision/EvalComparison`, `Processor.GetThreadId`, `ProcessorBinaryDump.AddSymbolToMap`, `ProcessorScope.Get/SetGlobalSymbol`, `ProcessorUtilityFunctions.InternalAdjustTuple`, and the debugger refresh helpers (`ProcessorDebugger.ResetBreakpoints(SourceCode,HashSet<int>)`, `RefreshDebuggerWatches`, `RefreshDebuggerWatch`) are now static. Updated the associated test hooks (`ProcessorTestHooks`) and NUnit fixtures (`ProcessorTests`) to call the new static helpers and verified via `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release`. The remaining CA1822 warnings now live in the parser/lexer and descriptor code noted later in this PLAN.
  - ‚úÖ (2025-11-24 07:45 UTC) Cleared the parser/dump CA1859 warnings by narrowing `LoaderFast.LoadChunk` to `ChunkStatement`, returning `HashSet<string>` from `ModuleRegister.GetModuleNameVariants`, and letting `ArrayMemberDescriptor.ArrayIndexerSet` return `DynValue`. Verified via `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release -nologo | Select-String \"CA1859\"`, which now emits no hits so the CA1859 bucket is empty for the runtime assemblies.
  - ‚úÖ (2025-11-24 08:55 UTC) Eliminated the descriptor CA1062 backlog by adding explicit `ArgumentNullException` guards across the user data/descriptors stack (`DispatchingUserDataDescriptor`, `DescriptorHelpers`, `StandardGenericsUserDataDescriptor`, `DynValueMemberDescriptor`, array/field/property/method/overloaded/event descriptors, hardwired descriptors, and `PropertyTableAssigner`). `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release -nologo | Select-String \"CA1062\"` now reports only LuaPort/Script-facing warnings, so the descriptor layer is clean.
  - ‚úÖ (2025-11-24 09:50 UTC) Followed through on the LuaPort/Script CA1062 sweep: `CharPtr`, `LuaBase`, `LuaBaseCLib`, `Script` (Dump/Call/CreateCoroutine/AttachDebugger), `DynValue.Assign/ToObject`, `StandardUserDataDescriptor`, `ValueTypeDefaultCtorMemberDescriptor`, and `ReplInterpreterScriptLoader` now throw `ArgumentNullException` when inputs are missing. `dotnet build src/runtime/NovaSharp.Interpreter/NovaSharp.Interpreter.csproj -c Release -nologo | Select-String \"CA1062\"` returns no matches, so the CA1062 backlog is officially zeroed out across runtime, REPL, and tooling surfaces.
  - ‚úÖ (2025-11-24 10:10 UTC) Knocked out the first CA18xx cluster: zero-length array allocations in `Script.MakeClosure`, `Script.Call`, `ProcessorInstructionLoop.CreateArgsListForFunctionCall`, and `ObjectCallbackMemberDescriptor` now rely on `Array.Empty<T>()`, and `Script.Dump` wraps its `UndisposableStream` in a `using` to satisfy CA2000. `dotnet build ‚Ä¶ | Select-String \"CA1825|CA2000\"` shows no matches, so CA1825/CA2000 are clear for the affected files.
  - ‚úÖ (2025-11-24 13:10 UTC) Cleared the remaining CA13xx/CA18xx backlog by swapping `Enumerable.Count`/`Substring`/`StartsWith` calls for zero-allocation helpers, collapsing duplicate dictionary lookups, inlining the numeric-type tables, and marking dispatch helpers/static comparers across `ExtensionMethodsRegistry`, `ScriptLoaderBase`, `PropertyTableAssigner`, `NumericConversions`, `DispatchingUserDataDescriptor`, `StandardUserDataDescriptor`, `PlatformAccessorBase`, `FunctionDefinitionExpression`, `Lexer`/`LexerUtils`, `OverloadedMethodMemberDescriptor`, `ProcessorInstructionLoop`, and `BinaryOperatorExpression`. `dotnet build src/NovaSharp.sln -c Release -nologo | Select-String "CA13|CA18"` now returns no results, so runtime CA13xx/CA18xx warnings are at zero.
  - ‚úÖ (2025-11-24 13:45 UTC) Addressed the CA1033 wave by exposing the previously explicit interface members on the runtime surface: descriptors (`DispatchingUserDataDescriptor`, `FieldMemberDescriptor`, `MethodMemberDescriptor`, `PropertyMemberDescriptor`) now surface virtual `Optimize()` hooks, both `PropertyTableAssigner` flavors provide overridable `AssignObjectUnchecked` implementations, and `Script` publishes a virtual `OwnerScript` property. The descriptor tests still green and `dotnet build src/NovaSharp.sln -c Release -nologo | Select-String "CA1033"` produces no hits, so derived classes can call these helpers without reflection.
  - üîú Next CA focus: pivot to the remaining CA1305/CA1307 locale-sensitive formatting hits plus the CA1033/CA1508 items called out in DynValue/StringModule/OsTime and the descriptor helpers before flipping the descriptor CA130x backlog to errors.
  - üîÑ Continue triaging the remaining CA diagnostics (currently 4‚ÄØ044 warnings logged from `dotnet build src/NovaSharp.sln -c Release`), prioritising runtime/library hot paths before fanning out to debuggers, tooling, and tests; prefer local code fixes over suppressions.
  - üîÑ Once `dotnet build` is warning-free, flip `TreatWarningsAsErrors` on via `Directory.Build.props`, rerun the full test + coverage pipeline, and update `docs/Testing.md` with the new warning policy.
- **Runtime security modes**: Design configurable Lua sandbox profiles that disable or stub risky primitives (file IO, env vars, OS commands, reflection hooks) and provide host-controlled policies for multi-tenant deployments.
- **Resource/QoS sandboxing**: Add configurable ceilings for time, memory, recursion depth, table growth, and coroutine counts so runaway mods can‚Äôt stall the game loop; expose watchdog hooks for graceful termination.
- **Deterministic execution profile**: Define and test a ‚Äúdeterministic mode‚Äù (stable PRNG seeding, locale-neutral formatting, deterministic iteration where Lua allows) to support lockstep networking and replays.
- **Mod isolation lifecycle**: Provide per-mod state containers, controlled export/import mechanics, and load/reload/unload events to prevent mods from trampling each other or leaking state across sessions.
- **Packaging & deployment pipeline**: Document and automate mod packaging (versioning, signatures, compression) and produce redistributable runtime bundles/NuGet packages plus sample integration stubs.
- **Observability & diagnostics**: Build structured logging, per-mod profiling (time/allocations), execution tracing, and crash report surfacing so hosts can debug and monitor mods in production.
- **Host API surface review**: Specify a stable C#/Lua interop contract (events, async bridging, error propagation), include analyzers/templates, and generate docs to keep exposed APIs safe and versionable.
- **Lua version parity audit**: Extend spec harness/tests to cover supported Lua versions (5.1‚Äì5.4) including bit32/utf8/goto/coroutine differences, and document any intentional deviations for modders.
- **RNG parity & quality**: Match Lua 5.4‚Äôs PCG32 sequence for `math.random`/`math.randomseed`, and expose optional higher-quality PRNGs (xoroshiro/xoshiro) without breaking deterministic mods.
- **Math & locale neutrality**: Audit `math`/`string` formatting vs Lua spec (handling of NaN, infinity, modulo, locale) and enforce invariant culture so mod behavior is stable across hosts.
- **Integer & bitwise semantics**: Validate 64-bit integer operations, overflow, and bit shifts against Lua‚Äôs reference behavior; align or document any differences.
- **Coroutine & metamethod conformance**: Expand spec tests for nested yields, pcall/xpcall interactions, and metamethod trigger order to mirror the Lua VM.
- **Table iteration determinism**: Confirm insertion/iteration behavior matches Lua‚Äôs expectations, avoiding .NET dictionary ordering surprises for modded state.
- **GC behavior parity**: Document .NET GC differences vs Lua‚Äôs incremental collector and evaluate exposing Lua-style pause/step knobs so mods relying on GC tuning remain predictable.
- **Debug hook fidelity**: Ensure `debug.sethook`, stack traces, and traceback formatting match Lua‚Äôs behavior so profiling tools and mod debuggers work transparently.
- **Bytecode handling policy**: Decide whether NovaSharp loads Lua bytecode; if supported, implement version checks and sandbox hardening, otherwise document the text-only stance.
- **Module searchers & paths**: Align `require`/`package.searchpath` resolution (case sensitivity, separators, LUA_PATH inheritance) with stock Lua for cross-platform mod portability.
- **Numeric mode consistency**: Audit integer/float handling (wraparound, `%` on negatives, `math.tointeger`) to guarantee Lua 5.3+/5.4 semantics.
- **UTF-8 library coverage**: Verify `utf8` API parity (surrogate handling, error returns) with Lua‚Äôs reference implementation.
- **OS/IO abstraction parity**: Normalize newline, path separator, and timezone behaviors across platforms so mods behave consistently.
- **Threading model guidance**: Define main-thread-only rules, provide safe queues or schedulers if background jobs are needed, and guard against multi-thread misuse.
- **Hot-reload resilience**: Add lifecycle hooks and cleanup strategies so mod reload/unload frees resources (events, timers, coroutines) without leaking or crashing.
- **Error surfacing parity**: Match Lua‚Äôs error objects and stack level reporting, ensuring `pcall`/`xpcall` return contracts remain intact despite C# exceptions.
- **Floating-point determinism**: Evaluate CPU/runtime variability; consider fixed-point or deterministic options for lockstep networking scenarios.
- **Sandbox escape audit**: Catalogue interop/reflection entry points that could bypass security modes and add mitigations or documentation.
- **Mod SDK & docs**: Produce modder-facing SDK artifacts (API docs, templates, analyzers) and automation for keeping documentation in sync with runtime releases.
- **Frame-time budgeting**: Introduce per-frame execution budgets/watchdogs so Lua scripts can‚Äôt stall Unity‚Äôs main thread; expose host callbacks for enforcement.
- **Unity coroutine helpers**: Provide scheduling utilities that bridge Lua coroutines with Unity‚Äôs Update/Coroutine loops for smooth frame-by-frame execution.
- **Unity API exposure**: Define safe, tested wrappers for the subset of Unity APIs accessible to Lua (threading rules, async helpers) and document constraints.
- **Mod asset pipeline**: Design asset ingestion (addressables/bundles, size limits) so Lua mods can load textures/audio safely without violating sandbox rules.
- **Mod tooling & debugging**: Ship a debug console/REPL, stack inspectors, and editor integration to help modders diagnose runtime issues in Unity builds.
- **Mod onboarding templates**: Provide starter projects, NuGet/UPM packages, and sample mods illustrating secure patterns and recommended architecture.
- **Mod versioning & compatibility**: Define manifest metadata and compatibility checks so the host can warn about API/engine mismatches before loading mods.
- **Crash containment UX**: Wrap mod entry points with resilient error handling, surface friendly UI in-game, and allow restart/reload without killing the session.
- **Runtime analytics hooks**: Offer optional telemetry hooks (usage/perf metrics) that hosts can enable to monitor mod health in the field.

## Coverage Burn-down Checkpoint (Latest)
‚Ä¢ Progress
  - üîÑ (2025-11-23 09:40 UTC) Added Processor-focused NUnit coverage for `ClearBlockData` (symbol closures and invalid ranges), `FindSymbolByName`‚Äôs `_ENV` fallback, `InternalAdjustTuple` recursion/empty inputs, `ExecIterPrep` iterator/metamethod fallbacks, `ExecRet` multi-return guard, bitwise/table-constructor/index error paths, and the userdata/metamethod rejection cases. These tests light up the remaining `ProcessorScope`/`ProcessorUtilityFunctions` lines and hit the previously uncovered `ProcessorInstructionLoop.cs` branches (table iterator prep, RET guard, bitwise throws, table ctor validation, and the metamethod loops). Re-run `./scripts/coverage/coverage.ps1 -SkipBuild` to capture the Processor branch delta and confirm the ‚â•95‚ÄØ% gate passes.
  - üîÑ Mirrored the Lua `<close>` TAP checks locally by adding `TestMore/310-close-var.t` + the `TestMore310CloseVar` NUnit shim so return, goto/break, and nested-closure unwinds (¬ß3.3.8) now run inside `dotnet test`; coverage gaps now focus on coroutine/yield paths before upstream TAP fixtures can be fully re-enabled.
  - üîÑ Implemented `coroutine.close` per Lua ¬ß6.2, including nil/false ignores (¬ß3.3.8), coroutine-yield cleanup, and errored-coroutine tuples; `TestMore/310-close-var.t` now covers suspended cleanup and error tuples while the interpreter skips duplicate `__close` runs. Remaining action: re-enable the upstream TAP suite once Windows/macOS parity is verified.
  - üîÑ Extended the mirror with coroutine yield/error repros and nil/false handling per Lua ¬ß3.3.8, then taught `Processor.EnsureToBeClosedValue`/`CloseValue` to skip nil/`false` so interpreter semantics match the spec; reran `dotnet test ‚Ä¶ --filter TestMore310CloseVar` (Release + DOTNET_ROLL_FORWARD=Major) to capture the new assertions.
  - ‚úÖ Added Lua 5.4 string-library spec coverage with manual (¬ß6.4) citations (`string.byte` clamping, plain `string.find`, capture returns, `%q` formatting, zero-count `string.rep`), keeping interpreter semantics aligned with the canonical interpreter; Release `dotnet test` now passes 1‚ÄØ481 cases post-suite expansion.
  - ‚úÖ Strengthened `MethodMemberDescriptor` unit coverage (default access fallback, AOT downgrade path, byref/out tuple returns, pointer/generic guardrails, visibility forcing) to push the class toward the ‚â•95‚ÄØ% line target while preserving green Release runs.
  - ‚ö†Ô∏è `./scripts/coverage/coverage.ps1` previously aborted because analyzer warnings (e.g., CA1834, CA1305) were promoted to errors; with compiler warnings now gated, rerun coverage to verify the pipeline and capture the refreshed reports.
  - ‚úÖ Configured solution-wide `WarningsAsErrors` for compiler diagnostics (CS*) while cataloguing CA* analyzer findings; builds now fail on compiler warnings, and the CA backlog is tracked for future cleanup.
  - Captured refreshed Release baseline via `./scripts/coverage/coverage.ps1` (2025-11-12 18:55 UTC), recording NovaSharp.Interpreter at **86.1‚ÄØ% line / 82.3‚ÄØ% branch** coverage; regenerated HTML/Markdown reports and refreshed both `docs/coverage/latest` and `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ Added focused NUnit suites for `FieldMemberDescriptor`, `StandardEnumUserDataDescriptor`, `ExprListExpression`, `ScriptExecutionContext`, `FastStack<T>`, `StringConversions`, and `RefIdObject`, clearing the former red-list and lifting each class above 95‚ÄØ% line coverage (with `FastStack<T>` now at 100‚ÄØ% after exercising explicit-interface members).
  - ‚úÖ Synced this PLAN checkpoint with the latest coverage burn-down notes so contributors land on the 86‚ÄØ% baseline instead of the outdated 68‚ÄØ% snapshot.
  - ‚úÖ Landed `SourceRefTests` to cover FormatLocation, range heuristics, and snippet extraction alongside `ExitCommandTests` that exercise help text and exit signaling; CLI ExitCommand line coverage now 100‚ÄØ% and SourceRef climbs to 81‚ÄØ%.
  - ‚úÖ Added `LoadModuleTests` (require caching, load reader guards, safe environment paths), `SyntaxErrorExceptionTests`, `ParameterDescriptorTests`, `AutoDescribingUserDataDescriptorTests`, and expanded `EventMemberDescriptorTests` so LoadModule now sits at 71‚ÄØ% line coverage, parameter descriptors at 70.8‚ÄØ%, event descriptors at 53‚ÄØ%, and the Release suite reaches 1‚ÄØ081 tests with interpreter totals past 81‚ÄØ% line.
  - Restored stream-file userdata parity by fixing Lua-style close tuples (nil, message, -1) and normalising buffered seek behaviour; StreamFileUserDataBase NUnit regressions now pass.
  - ‚úÖ Rebuilt `read('*n')` numeric parsing to track logical stream positions, honour leading `+/-`, decimals, and exponents without corrupting buffered reads; `read` line/block/all mode combos now succeed and keep subsequent reads aligned.
  - ‚úÖ Hardened IO coverage with exponent/whitespace numeric reads, mixed newline handling, and EOF detection fixes that rely on a tracked logical position rather than StreamReader buffering.
  - ‚úÖ Exercised `dynamic.eval`/`dynamic.prepare` with happy paths, invalid userdata, and syntax errors; fixed `Script.CreateDynamicExpression` so syntax failures now surface as Lua errors instead of `ArgumentOutOfRangeException`.
  - ‚úÖ Added fast-path tests for `io.open`, `io.input`/`io.output`, and `io.tmpfile`, covering missing file tuples, invalid modes, default stream reassignment, and temporary file writes.
  - ‚úÖ Brought `pcall`/`xpcall` coverage up with CLR callbacks, handler decoration, and guardrail assertions; observed that CLR yields currently return success, which needs deeper spec validation.
  - Added pcall-guarded coverage for stream flush/seek/setvbuf failures (including `io.flush` default routing) and wrapped the underlying exceptions in `ScriptRuntimeException`, exercising the new fallbacks.
  - Added BinaryEncoding edge-path coverage: verified null/invalid source buffers, undersized destinations, and negative max-count guards to enforce extreme-path behaviour.
  - Removed legacy tree; modernization docs/PLAN cleaned up.
  - Tightened coverage tooling (`scripts/coverage/coverage.ps1` now quiet locally; opt-in via NOVASHARP_COVERAGE_SUMMARY).
  - Added coverage suites for DebugModule, OsSystemModule, and IO userdata; interpreter coverage ‚âà77%.
  - Updated DebugModule to exit on scripted return and added tests for the console loop.

‚Ä¢ Preferences / Constraints
  - Keep local CLI output concise; use env vars for full summaries.
  - Follow `PLAN.md` milestones; focus on coverage burn-down.
  - Respect existing Lua-facing behavior and build on NUnit + Script.DoString.
  - When adding Lua fixtures, include clearly named files for small-scope, mixed-mode, and complex scenarios so reviewers can target the right coverage level quickly.

‚Ä¢ Next Work Items
  2. Continue the compatibility profile rollout so every entry point (CLI commands, debugger attach paths, Unity helpers, manifest loaders) respects `LuaCompatibilityProfile`. Outstanding tasks: surface the active profile in CLI/REPL help, propagate profile hints through debugger attach logs, and update documentation/screenshots once the bitwise/floor-division flags from (1) land.
     - ‚úÖ (2025-11-22 23:30 UTC) Landed the first phase of the compatibility-mode API: `LuaCompatibilityProfile`/`LuaCompatibilityAttribute`, the new `script.CompatibilityProfile` surface, and `docs/compatibility/compatibility-profiles.md` now enumerate the feature flags per Lua version. Module registration consults these profiles so Lua 5.2 scripts keep `bit32` while newer versions (5.3+) drop it, and the Lua 5.4+ `warn` function only binds when the selected profile supports it. `dotnet test ‚Ä¶ --filter CompatibilityVersionTests` keeps the profile outputs + gating covered.
     - ‚úÖ (2025-11-22 23:30 UTC) Parser-side `<const>`/`<close>` gating now follows the active `LuaCompatibilityProfile`: `AssignmentStatement` rejects those attributes whenever a script targets Lua 5.2/5.3 and surfaces SyntaxErrorException messages that cite Lua 5.4 manual ¬ß¬ß3.3.7‚Äì3.3.8 plus guidance to set `Script.Options.CompatibilityVersion`. `AssignmentStatementTests.ConstAttributeRequiresLua54Compatibility`/`CloseAttributeRequiresLua54Compatibility` and the updated docs lock the milestone down.
     - ‚úÖ (2025-11-22 23:30 UTC) Promoted the manifest helper into `NovaSharp.Interpreter.Modding.ModManifestCompatibility`, added NUnit coverage (`ModManifestCompatibilityTests`), and updated Unity docs with a concrete snippet so hosts can call `TryApplyFromDirectory` before instantiating scripts. CLI entry points now delegate to the runtime helper (warnings + success logs intact), and the follow-on debugger/Unity bootstrap plumbing is covered by the subsequent bullets.
     - ‚úÖ (2025-11-20 23:18 UTC) Added `ModManifestCompatibility.CreateScriptFromDirectory`, new NUnit coverage, and a sample debugger mod (`Tutorials/Scripts/DebuggerMod`). Chapter 11 of the Tutorials now loads that mod via the helper, showing how debugger hosts automatically honor `mod.json`, and `docs/UnityIntegration.md` was updated to reference the new API so Unity bootstrap code can simply pass a base `ScriptOptions` (with `FileSystemScriptLoader`) and receive a manifest-aware `Script`.
     - ‚úÖ (2025-11-21 15:10 UTC) Remote debugger onboarding is now manifest-aware end-to-end: `Tutorials/Chapters/Chapter11.cs` calls `RemoteDebuggerService.AttachFromDirectory` so the service both instantiates and attaches scripts using the mod‚Äôs `mod.json`, the Unity integration guide gained a ‚ÄúRemote Debugger Quick Start‚Äù snippet that mirrors the helper usage, and `RemoteDebuggerServiceTests.AttachFromDirectoryAppliesManifestCompatibility` verifies that manifest-declared Lua profiles flip the `Script.CompatibilityVersion` and enable the debugger automatically. Release `dotnet test ‚Ä¶ --filter RemoteDebuggerServiceTests` covers the new path, closing the open ‚Äúmanifest plumbing‚Äù action item.
     - ‚úÖ (2025-11-22 18:44 UTC) Surfaced the active Lua compatibility profile throughout the CLI: `LuaCompatibilityProfileExtensions.GetFeatureSummary` prints the bitwise/`bit32`/`utf8`/`table.move`/`<const>`/`<close>`/`warn` flags, `!help` now renders `Active compatibility profile: ‚Ä¶` plus guidance on switching profiles via `Script.Options.CompatibilityVersion` or `mod.json`, and `!debug` emits a `[compatibility]` line before attaching the remote debugger so session logs capture the Lua baseline in play. Added `HelpCommandTests` + `DebugCommandTests.ExecuteLogsCompatibilityProfile` to lock in the behavior, updated `docs/compatibility/compatibility-profiles.md`, and validated with `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~HelpCommandTests|FullyQualifiedName~DebugCommandTests"`.
     - ‚úÖ (2025-11-22 19:25 UTC) Extended the compatibility surfacing to the debugger front-ends: `LuaCompatibilityProfileExtensions.GetFeatureSummary` lives in the runtime so every host can reuse it, `RemoteDebuggerService.AttachFromDirectory` now emits a summary through its `infoSink` (covered by `RemoteDebuggerServiceTests.AttachFromDirectoryAppliesManifestCompatibility`), and the VS Code debug adapter logs `[compatibility] Debugger session running under ‚Ä¶` during initialization. Documentation highlights the new touchpoints so mod hosts know where to look for the Lua profile hints.
     - ‚úÖ (2025-11-22 22:45 UTC) CLI startup now announces the active Lua profile before the REPL prompt, and running a script via command-line arguments logs `[compatibility] Running '<script>' with ‚Ä¶` so hosts can confirm which Lua baseline is applied even outside the REPL. Added `ProgramTests.BannerPrintsCompatibilitySummary`/`CheckArgsRunScriptLogsCompatibilitySummary` and exercised the flow via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ProgramTests`.
     - ‚úÖ (2025-11-22 23:05 UTC) The CLI `!run` command now prints the same `[compatibility] Running '<script>' with ‚Ä¶` banner regardless of whether a manifest is applied, and `docs/compatibility/compatibility-profiles.md` documents the new banner/command behavior alongside the existing `!help`/`!debug` surfacing. Added `RunCommandTests.ExecuteWithoutManifestLogsCompatibilitySummary` and expanded the manifest test to assert the new output; validated with `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter RunCommandTests`.
     - ‚úÖ (2025-11-20 16:18 UTC) Diagnostic decoration now appends the active Lua profile to every host-visible `InterpreterException.DecoratedMessage` so logs include `"chunk:1: boom [compatibility: Lua 5.2]"`, while script-facing messages remain unchanged. `CompatibilityDiagnosticsTests` cover both syntax and runtime errors, and `docs/compatibility/compatibility-profiles.md` marks the documentation/diagnostics milestone complete; debugger/Unity manifest plumbing now flows through the helper APIs.
  - ‚úÖ (2025-11-20 18:55 UTC) `SupportsUtf8Library` now gates the `utf8` module, `utf8.codepoint` uses the Lua default range (`j` defaults to `i`), and `Utf8ModuleTests` exercise charpattern exposure, len failure tuples, and boundary errors per Lua 5.4 manual ¬ß6.5. Updated `docs/compatibility/compatibility-profiles.md` to capture the standard-library shim milestone; `table.move`/`warn` support is handled by the follow-on bullet.
  - ‚úÖ (2025-11-20 19:40 UTC) `SupportsTableMove` strips `table.move` from the module namespace whenever the profile disables it (Lua 5.3 manual ¬ß6.6), and `SupportsWarnFunction` now removes the Lua 5.4+ `warn` helper when the flag is off (Lua 5.4 manual ¬ß6.1). `CompatibilityVersionTests.TableMoveOnlyAvailableInLua53Plus` / `WarnFunctionOnlyAvailableInLua54Plus` assert the gating, and `docs/compatibility/compatibility-profiles.md` records the completed standard-library shim milestone.
  - ‚úÖ (2025-11-20 20:20 UTC) Mod manifests gained the `luaCompatibility` field. `ModManifest.Parse/Load` deserialize the JSON, `ModManifest.ApplyCompatibility` configures `ScriptOptions.CompatibilityVersion`, and hosts receive warnings when a mod targets a newer Lua profile than the runtime baseline. Documentation now shows the JSON snippet and helper usage.
  - ‚úÖ (2025-11-20 22:05 UTC) The CLI now auto-detects `mod.json` beside command-line script arguments, applies `ModManifest.ApplyCompatibility` before instantiating the `Script`, and prints `[compatibility]` status/warning messages (invalid manifests fall back to defaults). `ProgramTests.CheckArgsRunScriptAppliesManifestCompatibility` proves Lua 5.3 manifests remove the Lua 5.4+ `warn` helper while capturing the console output; validated via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ProgramTests`.
  - ‚úÖ (2025-11-20 22:24 UTC) The CLI `!run` command now mirrors the manifest flow: it resolves the target path, clones the current script options, and when a `mod.json` is present it spins up a fresh compatibility-configured `Script` (gating `warn`, `table.move`, etc.) while preserving the legacy inline execution path for manifest-less scripts. `RunCommandTests.ExecuteWithManifestRunsScriptInCompatibilityInstance` verifies the new behavior alongside the existing loader/exception tests; exercised via `dotnet test ‚Ä¶ --filter "FullyQualifiedName~ProgramTests|FullyQualifiedName~RunCommandTests"`.
  - ‚úÖ (2025-11-20 23:45 UTC) `_NovaSharp.luacompat` now mirrors the active `LuaCompatibilityProfile.DisplayName`, giving mods and hosts a script-side probe for the current profile without reaching back into the hosting API. `CompatibilityVersionTests.NovaSharpMetadataReflectsActiveCompatibilityProfile` covers Lua 5.2/5.3/5.4/Latest, `Script.LuaVersion` now reports 5.4, and `docs/compatibility/compatibility-profiles.md` documents the new runtime metadata hook.
  - ‚úÖ (2025-11-21 21:10 UTC) `LuaCompatibilityProfile` now disables `SupportsBit32Library` for Lua 5.3+ so only Lua 5.2 compatibility scripts expose the `bit32` namespace. `CompatibilityVersionTests.Bit32LibraryOnlyAvailableInLua52`/`ForVersionReturnsSingletonsWithExpectedFeatureFlags` validate the new feature flags, and `docs/compatibility/compatibility-profiles.md` now records that the compatibility library is exclusive to Lua 5.2 (standard-library shims milestone marked complete). Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter CompatibilityVersionTests`.
    - ‚úÖ (2025-11-22 14:05 UTC) Scripts targeting Lua 5.3+ now emit a single host-visible `[compatibility] require('bit32')‚Ä¶` warning the first time they attempt to load the legacy module. `Bit32CompatibilityWarningTests` covers the diagnostic, tutorials already called out the Lua 5.2 requirement, and `docs/LuaCompatibility.md` now documents that `bit32` ships exclusively with Lua 5.2 compatibility profiles.
  - üîÑ (2025-11-22 01:04 UTC) Reran `./scripts/coverage/coverage.ps1` with `COVERAGE_GATING_MODE=enforce` to validate the new debugger/coroutine suites. The Release run executed **2‚ÄØ675** tests and reported NovaSharp.Interpreter at **96.56‚ÄØ% line / 94.02‚ÄØ% branch / 98.49‚ÄØ% method**, so the script failed the ‚â•95‚ÄØ% branch gate. Updated `docs/coverage/coverage-hotspots.md` with the new snapshot plus the remaining hotspots (Processor pause-during-refresh queue handling, Lua compatibility helpers, `Utf8Module`) and kept the 95‚ÄØ% branch target pinned to the top of the burn-down until the debugger/coroutine coverage lands.
  3. Audit naming consistency across the runtime (methods like `Emit_Op`, members such as `i_variable`, and other Hungarian-style locals), then propose a final alignment plan with tooling impacts documented.
     - ‚úÖ (2025-11-22 23:45 UTC) Captured the runtime naming audit in `docs/modernization/naming-alignment.md` and expanded it with a ‚ÄúLuaPort Naming Allowlist‚Äù table that documents every intentional snake_case file (KopiLua string library + LuaStateInterop shims) plus the IDE1006 suppression rationale. This closes the ‚Äúper-identifier suppression metadata‚Äù follow-up so future contributors know exactly where exceptions live and why. The same doc still outlines the phased plan (renames, LuaPort isolation, editorconfig gates).
     - ‚úÖ (2025-11-20 20:44 UTC) Renamed the `ErrorHandlingModule` helper methods to `PcallContinuation`/`PcallOnError`, updated all callback registrations, and added null-argument guards to clear the lingering CA1707/CA1062 warnings. The naming audit allowlist no longer needs special-casing for this file, and the follow-up work can focus on the Lua-port isolation + analyzer enforcement.
     - ‚úÖ (2025-11-22 23:45 UTC) Moved `KopiLuaStringLib` into the dedicated `src/runtime/NovaSharp.Interpreter/LuaPort` folder, added the IDE1006 suppression/header that now links back to the allowlist table, updated `StringModule` to reference the new namespace, and refreshed the naming-audit inputs. The remaining Lua-port helpers are covered by the documented allowlist, so this milestone is complete.
     - ‚úÖ (2025-11-22 23:45 UTC) Relocated the `LuaStateInterop` shims (CharPtr, LuaBase, LuaBaseCLib, LuaLBuffer, LuaState, Tools) into `LuaPort/LuaStateInterop`, updated every runtime/test import, and captured the suppression rationale in the allowlist section. Analyzer enforcement can now ignore the mirror namespace while remaining strict elsewhere.
     - ‚úÖ (2025-11-20 21:45 UTC) Enabled repo-wide naming enforcement: `.editorconfig` now declares `methods_must_be_pascal` (IDE1006=error, excluding `NovaSharp.Interpreter.LuaPort`) and `private_fields_must_be_camel` so new runtime/tooling code can‚Äôt introduce snake_case methods or Hungarian private fields. Re-ran the naming audit (`tools/NamingAudit/naming_audit.py`) to confirm no violations remain and dotnet build continues to pass with the stricter rules.
     - ‚úÖ (2025-11-20 21:50 UTC) Added a lint-step gate that runs `dotnet format src/NovaSharp.sln --verify-no-changes --severity error --no-restore` inside `.github/workflows/tests.yml`, so CI now fails automatically whenever `.editorconfig` naming/style violations slip in.
     - ‚úÖ (2025-11-22 18:55 UTC) Extended `tools/NamingAudit/naming_audit.py` with deterministic `--write-log`/`--verify-log` switches, refreshed the committed `naming_audit.log`, and wired the lint + dotnet-test workflows to call `python3 tools/NamingAudit/naming_audit.py --verify-log naming_audit.log` so the PLAN checkpoint always reflects the live analyzer output.
  4. Tackle remaining hotspots listed in docs/coverage/coverage-hotspots.md (e.g., HardwiredDescriptors.DefaultValue,
     ReflectionSpecialName, ErrorHandlingModule, Io/Json/Load modules).
     - üîÑ (2025-11-20 21:08 UTC) Added `ProcessorDebuggerTests.RefreshDebuggerHandlesEmptyWatchList` and `.RefreshActionProcessesNextQueuedDebuggerCommand` to exercise the debugger `Refresh` action branch and the empty-watch update path so `Execution.VM.Processor` keeps inching toward the ‚â•95‚ÄØ% branch target without relying on manual debugger runs.
     - ‚úÖ (2025-11-22 21:05 UTC) Centralized the `YieldSpecialTrap` guard inside `ProcessorInstructionLoop` so every opcode now shares a single branch for host yields instead of duplicating the `goto yield_to_calling_coroutine` check 28 times. This shrinks `Execution.VM.Processor`‚Äôs branch count and should push the class past the ‚â•95‚ÄØ% goal once coverage is rerun. Verified the refactor with `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~ProcessorDebuggerTests|FullyQualifiedName~Coroutine"` to cover both debugger and coroutine suites.
     - ‚úÖ (2025-11-21 16:29 UTC) Added `LuaIntegerHelperTests` to exercise every guardrail inside `LuaIntegerHelper` (non-finite/overflowing doubles, numeric-string parsing, negative and oversized shifts). Coverage now reports the helper at **100‚ÄØ% line / 100‚ÄØ% branch**, removing it from the interpreter red list and keeping shift semantics under regression tests.
  - ‚úÖ (2025-11-22 18:20 UTC) Added `BinaryMetamethodTests` exercising Lua ¬ß¬ß3.4.1/3.4.7 `__idiv` and `__bnot` metamethods plus `ProcessorDebuggerTests.PauseRequestDuringRefreshStillProcessesQueuedAction`, covering the Execution.VM.Processor branches that handle floor-division/bitwise metamethod fallbacks and pause requests that arrive during a debugger refresh. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~BinaryMetamethodTests|FullyQualifiedName~PauseRequestDuringRefreshStillProcessesQueuedAction"`.
  - üîÑ (2025-11-22 01:17 UTC) Added `ModuleArgumentValidationTests`, extended `CompatibilityVersionTests` (`GetFeatureSummary` formatting + reflection-backed `GetDisplayName` coverage for the Lua 5.5/Latest aliases), and expanded `Utf8ModuleTests` (defaulted `j`, empty-range return, malformed iterator diagnostics). Ran `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~ModuleArgumentValidationTests|FullyQualifiedName~CompatibilityVersionTests|FullyQualifiedName~Utf8ModuleTests"` followed by `dotnet test ‚Ä¶ --filter FullyQualifiedName~CompatibilityVersionTests` and refreshed coverage via `./scripts/coverage/coverage.ps1 -SkipBuild` (gate = `enforce`). Interpreter totals now sit at **96.63‚ÄØ% line / 94.16‚ÄØ% branch / 98.49‚ÄØ% method** across **2‚ÄØ689** tests; `ModuleArgumentValidation` and `LuaCompatibilityProfileExtensions` report **100‚ÄØ%** coverage, `LuaCompatibilityProfile` climbs to **98.8‚ÄØ% line / 92.8‚ÄØ% branch**, and `Utf8Module` improves to **87.2‚ÄØ% line / 71.8‚ÄØ% branch**. `docs/coverage/coverage-hotspots.md` captures the new snapshot, though the run still fails the ‚â•95‚ÄØ% branch gate.
  - üîÑ (2025-11-22 02:48 UTC) Added boundary/error-path coverage to `Utf8ModuleTests` (`Utf8CharRejectsOutOfRangeCodePoints`, `Utf8CodePointThrowsOnInvalidUtf8Sequences`, `Utf8OffsetReturnsNilWhenAdvancingPastEndOfString`, `Utf8OffsetReturnsNilWhenMovingBeforeStart`, `Utf8OffsetZeroReturnsNilWhenBoundaryIsOutsideString`) so the invalid-codepoint path, `codepoint` failure branch, and each of the nil-returning `utf8.offset` scenarios (forward exhaustion, backwards underflow, `n = 0` out-of-range boundary) run under NUnit. These tests cite Lua ¬ß6.5, target the remaining uncovered helper branches (`NormalizeBoundary`, `FindRuneStartContainingBoundary`, `MoveToPreviousRuneBoundary`, and the `TryDecodeScalarWithinRange` guard), and executed cleanly via `dotnet test ‚Ä¶ --filter Utf8ModuleTests`; rerun coverage to confirm the branch lift before closing the hotspot.
  - üîÑ (2025-11-22 20:08 UTC) Expanded `Utf8ModuleTests` again to hit the remaining helper branches: negative `i`/`j` normalization, surrogate rejection inside `utf8.len`/`utf8.char`, manual `utf8.codes` control values (`nil`, past-end, and mid-surrogate throws), and backward `utf8.offset` guards for dangling/standalone surrogates plus empty-string `n = 0`. `dotnet test ‚Ä¶ --filter Utf8ModuleTests` passes in Release, and `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ743 tests) now reports `Utf8Module` at **97.7‚ÄØ% line / 95.3‚ÄØ% branch / 100‚ÄØ% method** while NovaSharp.Interpreter overall sits at **96.40‚ÄØ% line / 93.59‚ÄØ% branch / 98.55‚ÄØ% method**. The module is off the red list; closing the ‚â•95‚ÄØ% branch gap now depends on the remaining debugger/diagnostics hotspots.
  - üîÑ (2025-11-22 21:10 UTC) Added `CompatibilityVersionTests.DisplayNameFallsBackToEnumNameForUnknownVersion` so `LuaCompatibilityProfile.GetDisplayName` exercises its fallback branch, pushing the profile to **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage. The follow-up `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ744 tests) records NovaSharp.Interpreter at **96.41‚ÄØ% line / 93.61‚ÄØ% branch / 98.55‚ÄØ% method**; compatibility helpers are now fully green, leaving the debugger/coroutine buckets as the remaining ‚â•95‚ÄØ% branch blocker.
  - üîÑ (2025-11-22 21:18 UTC) Extended `ProcessorTests` with happy-path coverage for `_ENV` writes (`SetGlobalSymbolStoresValueAndTreatsNullAsNil`, `AssignGenericSymbolUpdatesGlobalScope`), exercising the success branches in `ProcessorScope.SetGlobalSymbol`/`AssignGenericSymbol`. `dotnet test ‚Ä¶ --filter ProcessorTests` passes in Release, and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ746 tests) now reports NovaSharp.Interpreter at **96.46‚ÄØ% line / 93.66‚ÄØ% branch / 98.55‚ÄØ% method** with `Execution.VM.Processor` improving to **98.2‚ÄØ% line / 96.2‚ÄØ% branch / 100‚ÄØ% method**. Remaining coverage debt is concentrated in the debugger/coroutine guard rails called out in the hotspot log.
  - üîÑ (2025-11-22 21:27 UTC) Added guard-focused coverage to `CallbackFunctionTests` (constructor nulls, `Invoke` null inputs, and the `FromDelegate`/`FromMethodInfo` argument checks), driving `CallbackFunction` to **98.3‚ÄØ% line / 95.4‚ÄØ% branch / 100‚ÄØ% method**. The refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ753 tests) now records NovaSharp.Interpreter at **96.50‚ÄØ% line / 93.74‚ÄØ% branch / 98.55‚ÄØ% method**. Coverage red list remains concentrated in the debugger/coroutine guard rails, but callback interop helpers are now fully green.
  - üîÑ (2025-11-22 21:27 UTC) Added guard-focused coverage to `CallbackFunctionTests` (constructor nulls, `Invoke` null inputs, and the `FromDelegate`/`FromMethodInfo` argument checks), driving `CallbackFunction` to **98.3‚ÄØ% line / 95.4‚ÄØ% branch / 100‚ÄØ% method**. The refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ753 tests) now records NovaSharp.Interpreter at **96.50‚ÄØ% line / 93.74‚ÄØ% branch / 98.55‚ÄØ% method**. Coverage red list remains concentrated in the debugger/coroutine guard rails, but callback interop helpers are now fully green.
  5. Re-run ./scripts/coverage/coverage.ps1 after each batch and update PLAN/doc checkpoints accordingly; raise gate once suite sustain >90‚ÄØ%.
     - ‚úÖ (2025-11-21 16:39 UTC) Re-ran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ672 Release tests). The new snapshot records NovaSharp.Interpreter at **96.52‚ÄØ% line / 93.96‚ÄØ% branch / 98.49‚ÄØ% method**, NovaSharp.Cli at **83.14‚ÄØ% line**, NovaSharp.Hardwire at **57.76‚ÄØ% line**, NovaSharp.RemoteDebugger at **91.44‚ÄØ% line**, and NovaSharp.VsCodeDebugger at **2.1‚ÄØ% line**. `docs/coverage/coverage-hotspots.md` now cites the run and highlights the remaining branch gap (overall interpreter branch still <95‚ÄØ%, so CI stays in monitor mode until the debugger/coroutine tests land).
     - üîÑ Next step: add the debugger pause-during-refresh + forced coroutine resume tests and backfill coverage for `LuaCompatibilityProfile`/`LuaCompatibilityProfileExtensions`/`ModuleArgumentValidation`/`Utf8Module` so the next `./scripts/coverage/coverage.ps1` run (gate = `enforce`) clears the ‚â•95‚ÄØ% branch target instead of failing at 94‚ÄØ%.
     - üîÑ Pending follow-up: run `./scripts/coverage/coverage.ps1 -SkipBuild` again with the new ProcessorScope/ProcessorUtilityFunctions/ProcessorInstructionLoop tests (2025-11-23 additions) and refresh `docs/coverage/coverage-hotspots.md` once the Processor branch metric is captured; flip coverage gating back to enforce mode if the run clears ‚â•95‚ÄØ% branch.
  6. Unity integration milestone: package NovaSharp as a Unity module (UPM and embedded), add example scenes/mod templates, document IL2CPP/AOT caveats, and verify the mod workflow in CI.
  7. Performance & allocation milestone: stand up BenchmarkDotNet regression runs, track allocations via dotnet-trace/dotMemory, enforce a perf budget in CI, and prototype Span<T>/pooling on hot paths.
  8. Roslyn code generation milestone: design the source generator/analyzer surface for NovaSharp descriptors and mod code, build a prototype, and document usage patterns.
  9. Documentation & samples milestone: set up DocFX (or equivalent), publish compatibility matrices + tutorials, refresh Unity/modding guides, and wire doc generation into CI.
  10. Compatibility corpus milestone: expand CI to run Lua TAP suites, real-world script corpora, and community mod packs across Windows/macOS/Linux + Unity editor builds.
  11. Style/quality automation milestone: enable analyzers/stylecop/formatter rules (naming, spacing, `_camelCase`), enforce them in CI, and close out the remaining naming debt.
  12. Research high-performance string/I/O libraries compatible with Unity (e.g., CySharp.ZString) and scope integration options to reduce allocations in parser, IO, and interop paths; document findings and prototype hotspots.
  13. Investigate `pcall` behaviour when CLR callbacks yield: confirm Lua parity, add repro harness, and patch runtime if NovaSharp should surface an error instead of returning success.
  14. Review CA1711 guidance for `SymbolRefAttributes` (rename vs. suppression) once `<close>` work stabilises, capturing the outcome in PLAN + analyzer settings.

## Coverage Initiative (Target ‚â• 90%)
- **Milestone 0 ‚Äì Baseline Measurement (in-flight)**
Integrate Coverlet with `src/tests/NovaSharp.Interpreter.Tests`, emit LCOV + Cobertura outputs under `artifacts/coverage`, and publish HTML reports to `docs/coverage/latest`. Document the workflow in `docs/Testing.md` and ship a `scripts/coverage/coverage.ps1` helper for local execution. Acceptance: CI publishes raw + HTML artefacts, auto-generated Markdown summary, and a PR comment capturing the current baseline (67.8‚ÄØ% line / 69.7‚ÄØ% branch / 72.1‚ÄØ% method; interpreter 81.0‚ÄØ% line).
  - ‚úÖ `scripts/coverage/coverage.ps1` now drives `dotnet test` through `coverlet.console`, copies Markdown/JSON summaries beside the raw reports, and refreshes `docs/coverage/latest`.
  - ‚úÖ Tests workflow gained a dedicated `code-coverage` job that appends the Markdown summary to the run, updates a PR comment in place, and uploads both raw coverage data and a gzipped HTML dashboard.
  - üîÑ (2025-11-23 10:58 UTC) Reran `./scripts/coverage/coverage.ps1` to validate the latest optimization tweaks. The Release pass executed **2‚ÄØ765** tests with zero failures and refreshed `docs/coverage/latest` plus LCOV/OpenCover artefacts. Interpreter totals now sit at **96.24‚ÄØ% line / 93.14‚ÄØ% branch / 98.59‚ÄØ% method**; gating still blocks on the 95‚ÄØ% branch target, so debugger/coroutine edge paths remain the next focus area.
  - üîú Next: add debugger/coroutine guard-rail tests (refresh queue force-pause, multi-script attach/detach, coroutine resume/yield diagnostics) plus CLI integration coverage so the next `./scripts/coverage/coverage.ps1` run clears ‚â•95‚ÄØ% branch. Re-run the script with `COVERAGE_GATING_MODE=enforce` once those suites land and capture the deltas in `docs/coverage/coverage-hotspots.md`.
- **Milestone 1 ‚Äì Unit Depth Expansion (Weeks 1-3)**  
  Expand `src/tests/NovaSharp.Interpreter.Tests/Units` to cover parser error paths, metatable resolution, tail-call recursion limits, dynamic expression evaluation, and data-type marshaling edge cases (tables‚ÜîCLR types). Add regression tests for CLI utilities in `src/tooling` (command parsing, REPL, config). Target ‚â• 70% line coverage for `NovaSharp.Interpreter` namespace before integration scenarios.
  - ‚úÖ Added `ParserTests`, `MetatableTests`, `TailCallTests`, `DynamicExpressionTests`, and expanded `InteropTests` to lock in parser diagnostics, metatable `__index/__newindex` wiring, deep tail-call paths, dynamic expression environments, and CLR table marshaling.
  - ‚úÖ Shipped `ReplInterpreterTests` + `JsonModuleTests` to cover REPL prompts/dynamic evaluation and JSON encode/decode paths; interpreter namespace line coverage still 67.7‚ÄØ%, so JSON branch is unblocked but IO/OS modules remain uncovered.
  - ‚úÖ Added `IoModuleVirtualizationTests` to back the IO/OS pathways with an in-memory platform accessor and keep `os.remove`/`io.output` behaviour under regression; interpreter namespace line coverage still 67.7‚ÄØ%.
  - ‚úÖ Captured CLI command parsing transcripts with `ShellCommandManagerTests` and extended the virtualised IO suite to assert `os.tmpname`/`os.rename` plus stdout/stderr separation; interpreter namespace coverage gain pending analysis.
  - ‚úÖ Migrated the legacy NUnit suite off `Assert.That`/`Assert.AreEqual` APIs to NUnit¬†4 constraint syntax, removed the `EMBEDTEST` shim, sealed helper fixtures flagged by CA1852, and restored a green Release build on net8.0.
  - ‚úÖ Added CLI failure-path tests (`ShellCommandManagerTests`) covering null/empty commands and tightened regression coverage.
  - ‚úÖ Exercised `Program.CheckArgs` and `HardWireCommand` interactive flows with unit tests, enabling InternalsVisibleTo for NovaSharp.Cli so tests hit real code paths without reflection.
  - ‚úÖ Added `RunCommandTests`, `RegisterCommandTests`, and `CompileCommandTests` (including loader failure propagation) to cover CLI script execution wiring, syntax help, type registration output, binary dump generation, and error paths; Release suite (679 tests) stays green while CLI namespace coverage rises.
  - ‚úÖ Refactored `DebugCommand` behind injectable factory/launcher bridges and added `DebugCommandTests` to assert debugger attach + browser launch behaviour without spawning external processes; Release suite now passes 681 tests.
  - ‚úÖ Stubbed the Lua dump loader so `HardWireCommand` can be exercised deterministically; new tests cover C#/VB generation paths, visibility warnings, and ensure code artifacts are emitted (Release suite at 684 tests).
   - ‚úÖ Added `HelpCommandTests` to validate command listings, detailed help, and error paths, keeping CLI interactive surfaces covered (Release suite now 687 tests).
- ‚úÖ Quantified the latest coverage run: overall line coverage at **56.5‚ÄØ%** (‚Üë0.1), with `CommandManager` now 100‚ÄØ% covered. Remaining hotspots are `NovaSharp.Program` (0‚ÄØ%), `HardWireCommand` (4.5‚ÄØ%), and other CLI commands <60‚ÄØ%.
- ‚úÖ Replaced the placeholder `SerializationExtensionsTests` with comprehensive coverage for prime tables, nested tables, identifier validation, tuple flattening, and string escaping, correcting `SerializationExtensions` to emit Lua-compliant braces/newlines instead of the `${` scaffolding.
  - ‚úÖ Standardise test naming: migrated all NUnit test methods to PascalCase (no underscores), elevated the `.editorconfig` rule to `error`, refreshed `docs/Testing.md`, and re-ran the Release suite (671 tests passed).
  - ‚úÖ Closed remaining CLI gaps: added `ProgramTests.CheckArgsHardwireFlagGeneratesDescriptors` for the `-W` flow and `ScriptDefaultOptionsTests` to lock in default loader persistence; Release suite now passes 690 tests with NovaSharp.Cli coverage trending upward.
  - ‚úÖ Expanded interpreter dynamic-expression coverage with constant/equality/symbol-resolution scenarios (`DynamicExpressionTests`), lifting the Release suite to 693 tests and covering `CreateConstantDynamicExpression`, `DynamicExpression.FindSymbol`, and equality semantics.
  - ‚úÖ Exercised colon-operator configuration flags with new `ColonOperatorBehaviourTests`, validating `TreatAsDot`, `TreatAsColon`, and `TreatAsDotOnUserData` paths (Release suite now 696 tests).
  - ‚úÖ Added `SymbolRefTests` covering binary write/read + environment restoration for global/local/upvalue symbols; Release suite up to 699 tests with serialization helpers now guarded.
  - ‚úÖ Brought `ScriptExecutionContextTests` online to validate local symbol resolution, global env access, and metatable inspection, pushing the Release suite to 702 tests and exercising execution-context helpers.
  - ‚úÖ Extended execution-context coverage to tail-call helpers and message decoration via new tests, lifting the Release suite to 704 tests and guarding `GetMetamethodTailCall` plus `PerformMessageDecorationBeforeUnwind`.
  - ‚úÖ Added `ProcessorStackTraceTests` to validate coroutine stack traces and interpreter exception call stacks, bringing the Release suite to 706 tests and exercising `Coroutine.GetStackTrace` along with debugger call-stack capture.
  - ‚úÖ Exercised debugger refresh plumbing via `DebuggerRefreshTests`, capturing call stack, locals, watch expressions, value stack, and thread snapshots (Release suite now 707 tests).
  - ‚úÖ Hardened coroutine lifecycle coverage (`CoroutineLifecycleTests`) to ensure resume error paths, recycling flows, and auto-yield force suspends are guarded; Release suite now sits at 712 tests.
  - ‚úÖ Added unit coverage for `coroutine.running/status`, `coroutine.wrap`, and `coroutine.resume` behaviours plus forced-yield handling in `pcall`/`xpcall` (Release suite now 722 tests).
  - ‚úÖ Extended `CoroutineModuleTests` to cover nested tuple flattening, argument forwarding through `resume`/`wrap`, the `coroutine.create` guardrail, and direct `coroutine.yield` payloads; Release suite now passes 727 tests.
  - ‚úÖ Ported the outstanding coroutine TAP scenarios into managed coverage (`IsYieldableReturnsFalseOnMainCoroutine`, `IsYieldableReturnsTrueInsideCoroutine`, `WrapPropagatesErrorsToCaller`, `WrapPropagatesErrorsAfterYield`), wiring the runtime `coroutine.isyieldable` hook and ensuring wrap propagates exceptions; Release suite now passes 735 tests.
  - ‚úÖ Exercised CLR callback yieldability and `wrap` + `pcall` interop (`IsYieldableReturnsFalseInsideClrCallback`, `WrapWithPcallCapturesErrors`, `WrapWithPcallReturnsYieldedValues`) while fixing `coroutine.wrap` to retain its coroutine handle under protected calls; Release suite now passes 738 tests.
  - ‚úÖ Mirrored the nested coroutine TAP assertions (`IsYieldableInsidePcallWithinCoroutine`, `WrapWithPcallHandlesTailCalls`) so yieldability and tail-call continuations stay faithful when protected by `pcall`; Release suite now passes 740 tests.
  - ‚úÖ Closed the remaining TAP parity gaps (`IsYieldableInsideXpcallErrorHandlerWithinCoroutine`, `CoroutineStatusRemainsAccurateAfterNestedResumes`), confirming error-handler yieldability and status drift behaviour; Release suite now passes 742 tests.
  - ‚è≥ Next: Raise interpreter coverage gates above 70‚ÄØ% and wire CI enforcement now that the coroutine TAP matrix is mirrored in managed tests.
  - ‚úÖ Extended debugger + CLI coverage with `SourceRefTests` (FormatLocation, distance heuristics, snippet extraction) and `ExitCommandTests` (name/help/execution), boosting `SourceRef` to 81‚ÄØ% line coverage and `ExitCommand` to 100‚ÄØ% while the Release suite grows to 1095 tests.
  - ‚úÖ (2025-11-13) Patched CLI `Program` coverage regression by switching the decorated-error unit to `ScriptRuntimeException`, restoring Release builds after the missing `InterpreterException` symbol failure and keeping the decorated message branch measurable ahead of the next `./scripts/coverage/coverage.ps1` snapshot.
  - ‚úÖ (2025-11-13) Added `ScriptLoaderBaseTests` covering LUA_PATH overrides, ignore flags, string-path unpacking, and environment fallbacks so `ScriptLoaderBase` exits the red list once the next coverage refresh lands.
  - üîÑ (2025-11-13) Landed `CharPtrTests` to target pointer arithmetic, comparisons, and string projections; rerun coverage to confirm `LuaStateInterop.CharPtr` climbs out of the low-coverage bucket.
  - üîÑ (2025-11-13) Added `DescriptorHelpersTests` asserting visibility attributes, member access classification, identifier conversions, and naming utilities; patched `ToUpperUnderscore`/`NormalizeUppercaseRuns` (aligned with Wallstop Unity helpers) to stop inserting stray digit separators and preserve PascalCase initials ahead of the next coverage snapshot.
  - üîÑ (2025-11-13) Expanded `EventMemberDescriptorTests` with wide-arity coverage (1‚Äì16 parameters) so `EventMemberDescriptor.CreateDelegate` switch cases are exercised before the next burn-down review.
  - üîÑ (2025-11-13) Extended `LuaStateInteropToolsTests` to cover octal alternate padding, pointer formatting, `%n` substitution, and the positive space flag, lifting `LuaStateInterop.Tools` beyond the low-coverage threshold.
  - üîÑ (2025-11-13) Augmented `FastStackTests` with zero-count, overflow, slot-clearing, and full reset scenarios so `FastStack.RemoveLast`/`Clear` guard paths are now measured.
  - üîÑ (2025-11-13) Added `DotNetCorePlatformAccessorTests` covering file mode parsing, environment I/O, filesystem operations, and the NotSupported execute path to raise `DotNetCorePlatformAccessor` coverage.
  - üîÑ (2025-11-13) Broadened `JsonModuleTests` (invalid parse/serialize paths, `isnull`, `null`) to burn down the remaining gaps in `JsonModule`.
  - üîÑ (2025-11-13) Introduced `ClosureContextTests` validating symbol name copying and value storage so `ClosureContext` no longer drags down scope coverage.
  - üîÑ (2025-11-13) Added `TablePairTests` to cover constructor/`Nil` behavior and document the current value setter semantics for `TablePair`.
  - üîÑ (2025-11-13) Added `PropertyTableAssignerTests` (happy-path, subassigners, fuzzy matching, expected-missing) to drive `PropertyTableAssigner<T>` + core assigner coverage.
  - üîÑ (2025-11-13) Added `SliceTests` covering indexing, enumeration, conversions, and unsupported mutators to lift `Slice<T>` coverage.
  - üîÑ (2025-11-13) Added `InteropRegistrationPolicyTests` to assert policy factory behavior (default/automatic/explicit) and verify the obsolete marker on `Explicit`.
  - üîÑ (2025-11-13) Disabled nullable reference types solution-wide (`Directory.Build.props`) and elevated CS8632/CS8669 to errors in `.editorconfig` so nullable annotations cannot reappear.

  - ‚úÖ (2025-11-13) Closed the immediate `ScriptRuntimeException` factory gap by adding `ScriptRuntimeExceptionTests` (table index errors, `ConvertObjectFailed` overloads, coroutine guard rails, access-member helpers, `Rethrow` guard) under `src/tests/NovaSharp.Interpreter.Tests/Units`, exercising every static branch that previously sat redlined.
  - üîÅ After closing the exception gap, rerun `dotnet test` and `./scripts/coverage/coverage.ps1`, then log the refreshed interpreter metrics back into this PLAN and `docs/coverage/coverage-hotspots.md`. (2025-11-13) `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release` ‚úÖ; `./scripts/coverage/coverage.ps1` ‚úÖ (line: 74.9‚ÄØ% total / 87.1‚ÄØ% interpreter, branch: 75.5‚ÄØ% total / 82.8‚ÄØ% interpreter). Snapshot + notes pushed to `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 08:44 UTC) Added targeted `CoroutineTests` coverage for the `Coroutine` runtime helper (CLR callback resume paths, object-argument conversion overloads, explicit-context resume, and `Close` short-circuit). `Coroutine` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, `CoroutineModule` sits at **88‚ÄØ% line / 76‚ÄØ% branch**, and interpreter totals ticked up to **91.78‚ÄØ% line / 88.44‚ÄØ% branch / 93.85‚ÄØ% method** across **1‚ÄØ821** Release tests after rerunning `./scripts/coverage/coverage.ps1`.
  - ‚úÖ (2025-11-16 08:52 UTC) Expanded `CoroutineModuleTests` to cover the tuple-flattening branch in `coroutine.resume`, the `"running"`/`"normal"` split in `coroutine.status`, and the internal error guard for unexpected coroutine states via a processor-state reflection helper. `NovaSharp.Interpreter.CoreLib.CoroutineModule` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, and interpreter totals sit at **91.82‚ÄØ% line / 88.53‚ÄØ% branch / 93.85‚ÄØ% method** across **1‚ÄØ825** Release tests after rerunning `./scripts/coverage/coverage.ps1`; PLAN + `docs/coverage/coverage-hotspots.md` updated with the new snapshot.
  - ‚úÖ (2025-11-16 09:04 UTC) Hardened the coroutine close guardrails with new `CoroutineCloseTests` that assert the `coroutine.close` guard paths (main coroutine rejection, running-state rejection, unsafe/`Unknown` state guard, to-be-closed metamethod failures, and the dead-coroutine OK path). This lifts the previously uncovered branches in `Processor.Coroutines` (`ScriptRuntimeException.CannotCloseCoroutine` states + error tuple propagation) and nudges `NovaSharp.Interpreter.Execution.VM.Processor` to **87.0‚ÄØ% line / 85.7‚ÄØ% branch / 92.8‚ÄØ% method** coverage. Interpreter totals now sit at **91.97‚ÄØ% line / 88.65‚ÄØ% branch / 93.91‚ÄØ% method** across **1‚ÄØ830** Release tests (`./scripts/coverage/coverage.ps1` @ 09:04 UTC), with checkpoints mirrored in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 09:14 UTC) Extended `SyntaxErrorExceptionTests` to cover the token + SourceRef constructors, the premature-stream flag, and both branches of the nested rethrow option (verifying cloned exceptions preserve tokens and inner exceptions). `NovaSharp.Interpreter.Errors.SyntaxErrorException` now reports **89.2‚ÄØ% line / 100‚ÄØ% branch / 76.9‚ÄØ% method** coverage, keeping interpreter totals at **92.0‚ÄØ% line / 88.65‚ÄØ% branch / 94.05‚ÄØ% method** across **1‚ÄØ835** Release tests after rerunning `./scripts/coverage/coverage.ps1`; documentation synced via `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 09:36 UTC) Added `SymbolRefExpressionTests` to hit the remaining dynamic-expression guardrails (`...` inside dynamic expressions and the SymbolRef constructor shortcut). `SymbolRefExpression` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, interpreter totals hold at **92.0‚ÄØ% line / 88.68‚ÄØ% branch / 94.05‚ÄØ% method** across **1‚ÄØ837** Release tests, and the coverage snapshot/notes live in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 09:44 UTC) Expanded `HardwiredDescriptorTests` to cover the serialized `DynValueMemberDescriptor` constructor, the name-only base constructor, and the prime-table wiring path (plus a regression guard ensuring ownerless tables serialize cleanly). `DynValueMemberDescriptor` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, interpreter totals tick up to **92.19‚ÄØ% line / 88.75‚ÄØ% branch / 94.20‚ÄØ% method** across **1‚ÄØ840** Release tests after rerunning `./scripts/coverage/coverage.ps1`; documented under `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 09:54 UTC) Introduced `ValueTypeDefaultCtorMemberDescriptorTests` covering the constructor guard (rejecting reference types), Execute/GetValue output, SetValue access denial, wiring metadata, and the metadata-only properties (parameters, varargs, sort discriminant). `ValueTypeDefaultCtorMemberDescriptor` now reports **96.4‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, and interpreter totals rise to **92.23‚ÄØ% line / 88.75‚ÄØ% branch / 94.44‚ÄØ% method** across **1‚ÄØ841** Release tests following `./scripts/coverage/coverage.ps1` (09:54 UTC); notes mirrored in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 12:12 UTC) Added `ClrToScriptConversionsTests` (custom converters, closures/callbacks, delegate marshalling, enums, static `MethodInfo`, IList/IDictionary/Enumerable wrappers, and failure paths) to lock down the CLR‚ÜíDynValue pipeline even though Release optimizations still report **80.7‚ÄØ%** line coverage in `ClrToScriptConversions` (branch coverage now **84.2‚ÄØ%**). Interpreter totals hold at **92.23‚ÄØ% line / 88.75‚ÄØ% branch / 94.44‚ÄØ% method** across **1‚ÄØ841** Release tests after rerunning `./scripts/coverage/coverage.ps1 -SkipBuild`; coverage results + gating notes captured in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 12:48 UTC) Recovered the `FieldMemberDescriptor` burn-down by replacing the reflection-based `_optimizedGetter` probe with an internal accessor, then extending `FieldMemberDescriptorTests` to cover the AOT fallback (preoptimized ‚Üí reflection), reflection-backed instance reads, preoptimized instance getters, interface-driven optimizer execution, numeric double coercion, and mismatched-owner exceptions. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` pushes `FieldMemberDescriptor` to **90.0‚ÄØ% line / 94.7‚ÄØ% branch / 100‚ÄØ% method** and lifts interpreter totals to **92.45‚ÄØ% line / 88.96‚ÄØ% branch / 94.73‚ÄØ% method** across **1‚ÄØ872** Release tests; checkpoints logged here and in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 12:56 UTC) Hardened the Lua ¬ß6.6 ‚ÄúTable Manipulation‚Äù helpers by expanding `TableModuleTests` with coverage for default numeric sorting, invalid comparator types, comparator/metamethod error propagation, custom `__lt` metatables, comparators that always return `false`, mixed-type sort failures, `table.insert` positional validation (including `__len` metatable overrides), and `table.remove` arity guards. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` now reports `NovaSharp.Interpreter.CoreLib.TableModule` at **99.2‚ÄØ% line / 98.9‚ÄØ% branch / 100‚ÄØ% method** and bumps interpreter totals to **92.58‚ÄØ% line / 89.11‚ÄØ% branch / 94.73‚ÄØ% method** across **1‚ÄØ881** Release tests; PLAN + `docs/coverage/coverage-hotspots.md` capture the new checkpoint.
  - ‚úÖ (2025-11-16 13:03 UTC) Added `StandardIoFileUserDataBaseTests` covering the Lua ¬ß6.8 input/output helpers (standard input reads, refusal to close stdout/stderr handles, continued writes after the error tuple, and propagation of the canonical `"cannot close standard file"` message). Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` now reports `NovaSharp.Interpreter.CoreLib.IO.StandardIoFileUserDataBase` at **100‚ÄØ% line / 100‚ÄØ% method** and keeps interpreter totals at **92.58‚ÄØ% line / 89.11‚ÄØ% branch / 94.78‚ÄØ% method** across **1‚ÄØ883** Release tests; checkpoint logged here and in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 13:19 UTC) Expanded `StreamFileUserDataBaseTests` to exercise every remaining ¬ß6.8 ‚ÄúInput and Output Facilities‚Äù edge case: closed-handle guards, writer-only EOF checks, direct `Peek`, default vs invalid `file:seek`/`file:setvbuf` calls (including general-exception wrapping when the underlying stream/writer fails), and Lua-level `pcall` surfaces for `io.flush`. Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` lifts `NovaSharp.Interpreter.CoreLib.IO.StreamFileUserDataBase` to **95.2‚ÄØ% line / 90.6‚ÄØ% branch / 100‚ÄØ% method** (up from 84.1‚ÄØ% line) and holds interpreter totals at **92.69‚ÄØ% line / 89.15‚ÄØ% branch / 94.83‚ÄØ% method** across **1‚ÄØ890** Release tests; mirrored in `docs/coverage/coverage-hotspots.md`.
  - ‚úÖ (2025-11-16 12:22 UTC) Added `FrameworkCurrentTests` (reflection interface lookup, `GetTypeInfoFromType`, `IsDbNull`, and `StringContainsChar`) so the .NET Core compatibility shim reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage. Latest `./scripts/coverage/coverage.ps1` run keeps interpreter totals at **92.34‚ÄØ% line / 88.89‚ÄØ% branch / 94.54‚ÄØ% method** across **1‚ÄØ851** Release tests.
  - ‚úÖ (2025-11-16 12:27 UTC) Added `JsonNullTests` to cover the JSON null userdata helper (`IsNull`, `IsJsonNull`, `Create` metadata). `JsonNull` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, and interpreter totals remain **92.34‚ÄØ% line / 88.89‚ÄØ% branch / 94.54‚ÄØ% method** across **1‚ÄØ851** Release tests (`./scripts/coverage/coverage.ps1`).
  - ‚úÖ (2025-11-16 12:31 UTC) Added `RuntimeScopeBlockTests` and `AnonWrapperTests` to cover the execution scope metadata (`From/To/ToInclusive/ToBeClosed`, `ToString`) and the userdata helper used for anonymous wrappers. `RuntimeScopeBlock` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, `AnonWrapper<T>` sits at **100‚ÄØ% line / 100‚ÄØ% branch**, and interpreter totals remain **92.36‚ÄØ% line / 88.89‚ÄØ% branch / 94.68‚ÄØ% method** across **1‚ÄØ859** Release tests (`./scripts/coverage/coverage.ps1 -SkipBuild`).
  - ‚úÖ (2025-11-16 12:35 UTC) Added `SourceRefTests` (formatting, distance, inclusion, CLR markers, breakpoint metadata) and `EmbeddedResourcesScriptLoaderTests` (resource detection + load path, plus the .NET Core `NotSupportedException`). `EmbeddedResourcesScriptLoader` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage; `SourceRef` behaviour is locked down even though the Release build still reports **81‚ÄØ% line / 84‚ÄØ% branch** because the CLR bootstrapper loads `libfunc_require` before user scripts. Interpreter totals hold at **92.38‚ÄØ% line / 88.90‚ÄØ% branch / 94.68‚ÄØ% method** across **1‚ÄØ865** Release tests (`./scripts/coverage/coverage.ps1 -SkipBuild`).
    - üîÑ (2025-11-13) Added `CallbackFunctionTests` covering colon-operator behaviour, default access mode validation, delegate conversions, and signature heuristics; line coverage now **91.3‚ÄØ%** for `CallbackFunction`.
    - üîÑ (2025-11-13) Expanded `ClosureTests` (upvalue classification, delegate helpers, call overloads, metadata assertions) lifting `Closure` to **86.6‚ÄØ%** line / **83.3‚ÄØ%** method coverage; remaining gap stems from the non-executable zero-upvalue branch (Lua `_ENV` always captured).
    - üîÑ (2025-11-14) Added an explicit `ClosureTests.UpvaluesTypeIsNoneWhenNoUpvaluesAreCaptured` case by instantiating a zero-symbol closure through the internal constructor, confirming the `UpvaluesType.None` branch and keeping `Closure` ready for future analyzer tightening.
    - üîÑ (2025-11-13) Rounded out `ParameterDescriptorTests` with restriction-constructor, by-ref wiring, original-type fallbacks, and `ToString` coverage; `ParameterDescriptor` now reports **100‚ÄØ%** line coverage.
    - üîÑ (2025-11-13) Hardened `LoadModuleTests` (reader fragment concatenation, safe-environment failure, `loadfile` syntax errors, `dofile` success/error flows), boosting `LoadModule` to **91.3‚ÄØ%** line / **86.9‚ÄØ%** branch coverage.
    - üîÑ (2025-11-13) Expanded `IoModuleTests` (default stream setters, close/flush, iterator API, binary encoding guardrails, `tmpfile`, exception fallbacks), raising `IoModule` to **93.2‚ÄØ%** line / **88.0‚ÄØ%** branch coverage and clearing it from the red list.
    - üîÑ (2025-11-13) Added `StringModuleTests` and `StringRangeTests` exercising char/byte/unicode ranges, formatter helpers, metatable wiring, positive/negative index coercion, and the internal `AdjustIndex` path; reran `./scripts/coverage/coverage.ps1` (Release) capturing `StringModule` at **99.0‚ÄØ%** line / **100‚ÄØ%** branch and `StringRange` at **100‚ÄØ%** line with the interpreter suite now at **87.3‚ÄØ%** line / **83.1‚ÄØ%** branch (1‚ÄØ430 tests).
    - üîÑ (2025-11-14) Added `Units/CoroutineCloseTests` to exercise `Processor.Coroutines` close paths (never-started, suspended, post-error) and `Units/DebuggerResumeHelpersTests` to drive `Processor.Debugger` step-in/step-out flow with deterministic breakpoints. Targeted `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~CoroutineCloseTests"` and the matching `--filter "FullyQualifiedName~DebuggerResumeHelpersTests"` both pass in Release, confirming the scheduler + resume helpers are now covered.
    - üîÑ (2025-11-14) Expanded `BinaryOperatorExpressionTests` with precedence/associativity scenarios plus compile-time assertions (short-circuit jumps, inverted comparisons) so `BinaryOperatorExpression` covers the `Prioritize*` helpers and `ShouldInvertBoolean` paths; `dotnet test ... --filter "FullyQualifiedName~BinaryOperatorExpressionTests"` now exercises the additional evaluation + bytecode branches.
    - üîÑ (2025-11-14) Added `UnityAssetsScriptLoaderTests` covering path normalization, missing-script diagnostics, and loaded-script enumeration so the loader‚Äôs dictionary-driven paths stay under regression coverage without needing a Unity runtime.
    - üîÑ (2025-11-14) Extended `Units/TablePairTests` with equality/operator/hash-code assertions plus `Equals(object)` regressions (`dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~TablePairTests"`), ensuring `NovaSharp.Interpreter.DataTypes.TablePair` no longer skews the interpreter red list.
    - üîÑ (2025-11-14) Introduced `Units/UserDataTests` to lock down `UserData.Create` fallbacks, proxy registration guards, and the registry description/historical paths by wiring a stub `IWireableDescriptor`; `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~UserDataTests"` passes, and the latest `./scripts/coverage/coverage.ps1` run records `NovaSharp.Interpreter.DataTypes.UserData` at **86‚ÄØ%** line / **83.3‚ÄØ%** branch with the overall interpreter climbing to **88.4‚ÄØ%** line / **84.2‚ÄØ%** branch / **91.8‚ÄØ%** method (1‚ÄØ517 tests).
    - üîÑ (2025-11-14) Added `Units/DynValueTests` covering tuple flattening (`NewTuple`/`NewTupleNested`), scalar conversion, Lua truthiness, length semantics, assignment/read-only safeguards, and `CheckType` auto-conversion failure paths; `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~DynValueTests"` and the refreshed `./scripts/coverage/coverage.ps1` keep `NovaSharp.Interpreter.DataTypes.DynValue` moving upward (**77.8‚ÄØ%** line / **62.9‚ÄØ%** branch) with interpreter totals holding at **88.4‚ÄØ%** line / **84.2‚ÄØ%** branch / **91.8‚ÄØ%** method across **1‚ÄØ527** tests.
    - üîÑ (2025-11-14) Extended `Units/DynValueTests` again to hit conversion helpers (`CastToNumber`, `CastToString`), `CheckType` with `AllowNil`, `CheckUserDataType`, user-data print strings, read-only cloning, hash caching, tuple debug output, NaN detection, and private-resource retrieval; `dotnet test ... --filter "FullyQualifiedName~DynValueTests"` plus the latest coverage sweep now place `NovaSharp.Interpreter.DataTypes.DynValue` at **82.2‚ÄØ%** line / **67.4‚ÄØ%** branch, nudging interpreter totals to **88.6‚ÄØ%** line / **84.6‚ÄØ%** branch / **92.0‚ÄØ%** method with **1‚ÄØ578** Release tests.
    - üîÑ (2025-11-14) Introduced `Units/LuaTypeExtensionsTests` to pin `CanHaveTypeMetatables`, `ToLuaTypeString`/`ToErrorTypeString` mappings (including exception paths), and debugger string formatting; `dotnet test ... --filter "FullyQualifiedName~LuaTypeExtensionsTests"` plus the latest `./scripts/coverage/coverage.ps1` bumped `NovaSharp.Interpreter.DataTypes.LuaTypeExtensions` to **95.6‚ÄØ%** line / **96.4‚ÄØ%** branch and nudged interpreter totals to **88.4‚ÄØ%** line / **84.3‚ÄØ%** branch / **91.8‚ÄØ%** method with **1‚ÄØ544** tests executing in Release.
    - üîÑ (2025-11-14) Added `Units/ScriptPrivateResourceExtensionTests` to exercise every guardrail in `ScriptPrivateResourceExtension` (array overload, DynValue plumbing, cross-script ownership violations, shared-resource rejection) using real `Script` + `Table` instances; `dotnet test ... --filter "FullyQualifiedName~ScriptPrivateResourceExtensionTests"` and the latest `./scripts/coverage/coverage.ps1` raised `NovaSharp.Interpreter.DataTypes.ScriptPrivateResourceExtension` to **88.8‚ÄØ%** line / **91.6‚ÄØ%** branch and pushed the interpreter aggregate to **88.4‚ÄØ%** line / **84.4‚ÄØ%** branch / **91.8‚ÄØ%** method with **1‚ÄØ548** tests.
    - üîÑ (2025-11-14) Expanded `Units/TableTests` to cover length caching invalidation, `NextKey` iteration (nil skipping, string/integer transitions, `TablePair.Nil` vs `null`), forced `CollectDeadKeys`, append ownership enforcement, NaN/nil index guards, nested `Set`/`Get` resolution (`ResolveMultipleKeys` happy/error paths), raw getters, and remove fallbacks; `dotnet test ... --filter "FullyQualifiedName~TableTests"` plus the refreshed coverage run now report `NovaSharp.Interpreter.DataTypes.Table` holding at **82.4‚ÄØ%** line / **76.3‚ÄØ%** branch while overall interpreter metrics stay at **88.6‚ÄØ%** line / **84.6‚ÄØ%** branch / **91.9‚ÄØ%** method with **1‚ÄØ567** Release tests (coverage uplift now limited by existing Table hotspots).
    - üîÑ (2025-11-15) Extended `Units/DispatchingUserDataDescriptorTests` with descriptor-level coverage for `__tonumber`/`__tobool`, division-by-zero propagation, and meta-operator fallbacks, and followed up with additional unit coverage for the dictionary helpers (`MemberNames`/`MetaMemberNames`, `HasMember`, add/remove), the indexer execution path (both happy-path and non-callback exception), and extension-method refresh (`UserData.RegisterExtensionType` + Lua `hostAdd:DescribeExt()`). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~DispatchingUserDataDescriptorTests"` stays green, and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run still reports `NovaSharp.Interpreter.Interop.BasicDescriptors.DispatchingUserDataDescriptor` at **80.6‚ÄØ%** line / **73.8‚ÄØ%** branch because the remaining gaps live in the comparison helpers (`PerformComparison`/`MultiDispatch*`) and the `TryDispatchLength`/`TryDispatchToNumber` guards. Interpreter totals remain **89.4‚ÄØ%** line / **85.7‚ÄØ%** branch / **92.4‚ÄØ%** method across **1‚ÄØ643** Release tests (artefacts refreshed under `docs/coverage/latest` + hotspots).
    - üîÑ (2025-11-15) Hardened `Units/UserDataTests` around the remaining registry ‚Äúred‚Äù paths: new cases now confirm (a) `GetDescriptorForType` produces `CompositeUserDataDescriptor` when a derived type inherits a registered base while also implementing a registered interface, (b) the default registration policy rejects attempts to override an existing descriptor (via the explicit `Type` + descriptor overload), (c) both the `IProxyFactory` overload and its generic variant behave (null-guard + successful descriptor binding), (d) the generic `GetDescriptorForType<T>` helper returns the registered descriptor, and (e) `UserData.RegisterAssembly(includeExtensionTypes: true)` picks up `[NovaSharpUserData]` annotations discovered through `Assembly.GetCallingAssembly`. `dotnet test ... --filter "FullyQualifiedName~UserDataTests"` stays green and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run keeps `NovaSharp.Interpreter.DataTypes.UserData` at **86‚ÄØ%** line / **83.3‚ÄØ%** branch coverage while documenting the still-uncovered equality/metatable toggles and historical wiring paths.
    - üîÑ (2025-11-15 13:47 UTC) Finished the dispatcher/UserData push: new unit tests now cover the duplicate-member guardrails (`AddMemberTo` throws on non-overload duplicates, aggregates true overloads), the `SetIndex` setter/directed-fallback paths (including the ‚Äúno match‚Äù false return), `IOptimizableDescriptor.Optimize()` fan-out, helper-name wrappers (`Camelify`/`UpperFirstLetter`), comparison/length metamethod fallbacks when objects are non-comparable or null, and the default/meta-index branches (`__unknown`, `__lt`, `__len`). `UserDataTests` already handle the `Assembly.GetCallingAssembly` fallback plus default-policy nuances, so the remaining dispatcher hotspots were the iterator/comparison guards and the helper wrappers‚Äîthese tests now hit those lines. `dotnet test ... --filter "FullyQualifiedName~DispatchingUserDataDescriptorTests"` / `--filter "FullyQualifiedName~UserDataTests"` followed by `./scripts/coverage/coverage.ps1 -SkipBuild` (2025-11-15 13:47 UTC) report NovaSharp.Interpreter at **90.0‚ÄØ% line / 86.4‚ÄØ% branch / 93.1‚ÄØ% method**, `DispatchingUserDataDescriptor` at **94.2‚ÄØ% line / 93.3‚ÄØ% branch**, and `NovaSharp.Interpreter.DataTypes.UserData` still **100‚ÄØ%** covered.
    - üîÑ (2025-11-15 14:45 UTC) Stubbed a minimal `UnityEngine` assembly via `System.Reflection.Emit` inside `UnityAssetsScriptLoaderTests`, allowing the default constructor to exercise the reflection-based loader plus the exception guardrails (by toggling the stub to throw). New tests (`DefaultConstructorLoadsScriptsViaReflection`, `ReflectionConstructorHandlesFailuresGracefully`) verify asset-path normalization, dictionary snapshots, and the helpful missing-script error text while the harness‚Äô throw-path covers the catch/log wiring. `UnityAssetsScriptLoader` now reports **100‚ÄØ% line / 90‚ÄØ% branch coverage**, overall interpreter coverage bumps to **90.9‚ÄØ% line / 87.5‚ÄØ% branch / 93.3‚ÄØ% method**, and the Release suite climbs to **1‚ÄØ723** tests.
    - üîÑ (2025-11-15 14:58 UTC) Added `Units/RemoteDebuggerTests`, which start the real `DebugServer` over a free loopback port, drive its TCP command surface (`handshake`, `run`, `breakpoint`, `addwatch`, `error_rx`), and assert the resulting `DebuggerAction` queue, dynamic watch expressions, and regex-driven pause heuristics. The tests reuse a lightweight client to read the XML protocol and keep the sample scripts hermetic. Coverlet still reports **0‚ÄØ%** for `NovaSharp.RemoteDebugger` because the interpreter runner isn‚Äôt instrumenting that assembly; follow-up is captured on the coverage hotlist to either run the debugger tests from a dedicated harness or adjust the instrumentation filters so the hit data flows through. Interpreter totals remain **90.9‚ÄØ% line / 87.5‚ÄØ% branch / 93.3‚ÄØ% method** (1‚ÄØ723 tests) while the remote debugger functionality now has regression coverage.
    - üîÑ (2025-11-16 13:38 UTC) Extended `Units/RemoteDebuggerTests` to cover the remaining `DebugServer` helpers: new cases now verify `breakpoint` `clear`/toggle commands, queue refreshes while `_inGetActionLoop` is true (no duplicate ‚ÄúHost busy‚Äù spam), invalid watch expressions flowing through `CreateDynExpr` (error broadcast + constant fallback), the `ConnectedClients` counter, `GetDebuggerCaps`, and the path that discards stale `DebuggerAction`s once `Age > 100‚ÄØms`. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~RemoteDebuggerTests"` plus a fresh `./scripts/coverage/coverage.ps1 -SkipBuild` (1‚ÄØ890 tests) keep `NovaSharp.RemoteDebugger` at **79.1‚ÄØ% line / 62.6‚ÄØ% branch / 91.9‚ÄØ% method** with `DebugServer` sitting at **63.2‚ÄØ% line / 46‚ÄØ% branch**‚Äîthe critical queue/broadcast branches now execute under test even though the remaining VS-facing command handlers still dominate the uncovered set.
    - üîÑ (2025-11-16 14:03 UTC) Raised `NovaSharp.Interpreter.Debugging.SourceRef` coverage by exercising the `ToString()` path, the collapsed-line branches inside `GetLocationDistance`, the ‚Äúbetween lines‚Äù/before/after segments, and the single-line `IncludesLocation`/`FormatLocation` cases. The new NUnit coverage lives in `Units/SourceRefTests.cs` (`ToStringReflectsStepStopIndicator`, `GetLocationDistanceHandlesCollapsedAndBetweenSegments`, etc.) and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (1‚ÄØ910 tests) now records `SourceRef` at **96.0‚ÄØ% line / 86.0‚ÄØ% branch / 100‚ÄØ% method** with interpreter totals nudging to **92.79‚ÄØ% line / 89.27‚ÄØ% branch / 94.88‚ÄØ% method**.
    - üîÑ (2025-11-16 14:20 UTC) Added `Units/MemberDescriptorTests` to pin the `IMemberDescriptor` extension helpers (`HasAllFlags`, `CanRead/Write/Execute`, getter callback generation, access filtering, and the `CheckAccess` guardrails). `dotnet test ... --filter "FullyQualifiedName~MemberDescriptorTests"` plus the same coverage sweep (1‚ÄØ916 tests) keeps `NovaSharp.Interpreter.Interop.BasicDescriptors.MemberDescriptor` reported at **82.1‚ÄØ% line / 90.0‚ÄØ% branch / 100‚ÄØ% method**‚Äîline coverage remains constrained by inlined `return` sites, but the behavioural guardrails (instance-vs-static access, read/write/execute enforcement, getter callback wiring) are now exercised under NUnit so regressions surface immediately.
    - üîÑ (2025-11-16 14:13 UTC) Finished the NodeBase burn-down: new `NodeBaseTests` scenarios now exercise the three-token overload, the failure branches for both multi-token overloads, the `CheckTokenTypeNotNext` guard, and the `LoadingContext` property getter, pushing `NovaSharp.Interpreter.Tree.NodeBase` to **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**. The same `./scripts/coverage/coverage.ps1 -SkipBuild` run (1‚ÄØ916 tests) lifts interpreter coverage to **92.85‚ÄØ% line / 89.38‚ÄØ% branch / 94.97‚ÄØ% method**.
    - üîÑ (2025-11-15 16:05 UTC) Finished the cross-platform macro sweep for our helper scripts: `scripts/build/build.ps1`, `scripts/coverage/coverage.ps1`, `scripts/modernization/generate-moonsharp-audit.ps1`, and their bash counterparts (`scripts/build/build.sh`, `scripts/coverage/coverage.sh`, `scripts/ci/apply-formatters.sh`, `scripts/ci/check-csharpier.sh`, `scripts/ci/check-markdown.sh`) now derive the repo root via `$PSScriptRoot`/`git rev-parse` rather than hard-coded `../..`, keep POSIX separators in string literals, and continue to run from any working directory. `./scripts/coverage/coverage.ps1` (full build) still succeeds post-sweep, producing the latest Release artefacts with interpreter coverage steady at **90.9‚ÄØ% line / 87.4‚ÄØ% branch / 93.3‚ÄØ% method** across **1‚ÄØ727** tests.
    - üîÑ (2025-11-15 16:12 UTC) Verified that the existing `coverlet` include filter (`--include "[NovaSharp.*]*"`) already instruments `NovaSharp.RemoteDebugger` when `./scripts/coverage/coverage.ps1` runs: the latest pass (see `docs/coverage/latest/Summary.txt:250-261`) records **43.0‚ÄØ% line / 34.3‚ÄØ% branch / 45.9‚ÄØ% method** coverage with `DebugServer` at **58.2‚ÄØ%** and the TCP helpers (`Utf8TcpPeer`, `Utf8TcpServer`) above **70‚ÄØ%**. `Units/RemoteDebuggerTests` drive those hits by spinning up the real server and issuing `handshake`/`run`/`breakpoint`/`addwatch`/`error_rx` commands (see `src/tests/NovaSharp.Interpreter.Tests/Units/RemoteDebuggerTests.cs`). The remaining 0‚ÄØ% classes (`DebugWebHost`, `RemoteDebuggerService`, `RemoteDebuggerOptions`) simply lack tests, not instrumentation, so no tooling change is required.
    - üîÑ (2025-11-15 16:38 UTC) Added `Units/RemoteDebuggerServiceTests` to exercise the web host + CLI bridge: new cases (`SingleScriptModeServesIframeWithConfiguredRpcPort`, `JumpPageListsAttachedScripts`, `CliBridgeForwardsAttachAndHttpUrl`) spin up the real HTTP host on ephemeral ports, fetch the rendered HTML over raw TCP, and assert that the CLI bridge enables `Script.DebuggerEnabled`. The refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run (1‚ÄØ730 tests) now reports `NovaSharp.RemoteDebugger.RemoteDebuggerService` at **96.6‚ÄØ%** line coverage, `DebugWebHost` at **100‚ÄØ%**, and overall `NovaSharp.RemoteDebugger` at **68.1‚ÄØ% line / 48.3‚ÄØ% branch / 84.4‚ÄØ% method**; the CLI `RemoteDebuggerServiceBridge` climbed to **85.7‚ÄØ%** line coverage.
    - üîÑ (2025-11-15 16:50 UTC) Extended coverage with `Units/RemoteDebuggerServiceTests.DebuggerPageServesEmbeddedUi`, `Units/HttpServerTests`, and the new `Units/HttpResourceTests`. These cases hit the `Debugger?port=‚Ä¶` embedded UI, exercise Basic-auth accept/deny + callback argument plumbing, and assert every `HttpResourceType` content-type mapping (callback throws). The latest `./scripts/coverage/coverage.ps1 -SkipBuild` pass (1‚ÄØ745 tests) now reports `NovaSharp.RemoteDebugger` at **75.7‚ÄØ% line / 59.3‚ÄØ% branch / 87.1‚ÄØ% method**, with `DebugWebHost` **100‚ÄØ%**, `RemoteDebuggerService` **96.6‚ÄØ%**, `HttpServer` **91.1‚ÄØ%**, and `HttpResource` **94.7‚ÄØ%**.
     - ‚úÖ (2025-11-21 17:05 UTC) Remote debugger sweep completed: `RemoteDebuggerService` now allocates unique RPC ports per attached script (fixing jump-page multi-row support), `RemoteDebuggerServiceTests` gained multi-script + padded error-page coverage, and new `Utf8TcpServerTests`/`XmlWriterExtensionsTests` exercise the low-level XML/TCP helpers (`Comment(null)` and `CompleteMessage` edge paths). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~RemoteDebuggerServiceTests|FullyQualifiedName~XmlWriterExtensionsTests|FullyQualifiedName~Utf8TcpServerTests"` captures the refreshed coverage run, pushing the remote-debugger assembly past the 80‚ÄØ% line target.
     - ‚úÖ (2025-11-21 17:40 UTC) Captured the hard-dependency audit in `docs/modernization/hard-dependency-audit.md`: process launchers (`DebugCommand`, `Tutorials/Chapter11`, `StandardPlatformAccessor.ExecuteCommand`), manifest/file-system touch points (`ModManifestCompatibility`, `HardWireCommand`, tutorial mod locator), and the remaining `DateTime.UtcNow` usage in the portable `Stopwatch` shim are now catalogued with proposed abstractions (`IBrowserLauncher`, `ICommandRunner`, `IModFileSystem`, `ITimeProvider` injection). These entries seed the backlog so the next pass can wire DI hooks before enabling Unity/mobile hosts.
     - ‚úÖ (2025-11-21 19:05 UTC) Introduced the new `IModFileSystem` abstraction (with the default `PhysicalModFileSystem`) so `ModManifestCompatibility.TryApply*`/`CreateScriptFromDirectory` no longer hard-code `System.IO`. Hosts can now inject custom file-system providers (virtualized mods, Unity assets) and tests gained `TestModFileSystem` coverage via `ModManifestCompatibilityTests.CustomFileSystemCanProvideManifest`. This closes the first item from the hard-dependency audit by removing mandatory disk access from manifest processing.
     - ‚úÖ (2025-11-21 19:40 UTC) Replaced the hard-coded `Process.Start` browser launchers with the new `NovaSharp.RemoteDebugger.IBrowserLauncher` abstraction. `DebugCommand` now defaults to `ProcessBrowserLauncher` but tests inject a fake launcher, and the Chapter 11 tutorial calls the same abstraction so Unity hosts can suppress or customize browser launches. `DebugCommandTests.ExecuteStartsDebuggerAndOpensBrowserOnce/ExecuteSkipsBrowserLaunchWhenUrlIsEmpty` were updated accordingly.
    - üîÑ (2025-11-15 17:05 UTC) Introduced a cross-platform `ITimeProvider` (with `SystemTimeProvider` default) and rewired the diagnostics pipeline: `PerformanceStatistics` now captures the provider via `DefaultTimeProvider`, while `PerformanceStopwatch` and `GlobalPerformanceStopwatch` accumulate elapsed milliseconds through the provider instead of `System.Diagnostics.Stopwatch`. Tests gained a `FakeTimeProvider`, and `PerformanceStatisticsTests` were rewritten to use deterministic time advancement (no more `Thread.Sleep`). This sets the stage for swapping in Unity-friendly providers and unblocks future abstractions for other time-dependent services.
    - üîÑ (2025-11-15 17:16 UTC) Remote debugger HTTP/queue coverage pushed further: `RemoteDebuggerTests.AddWatchQueuesRefreshAndTransitionsHostState` now drives the host-busy/ready messages and `GetAction` hard-refresh path, while new `HttpServerTests` and `XmlWriterExtensionsTests` validate the callback argument plumbing plus the XML helper overloads (null handling + format strings). Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` shows `NovaSharp.RemoteDebugger` at **78.4‚ÄØ% line / 62.7‚ÄØ% branch / 91.7‚ÄØ% method** (DebugServer lines now exercised via the new test) and the overall suite at **1‚ÄØ748** tests.
    - üîÑ (2025-11-15 17:30 UTC) Landed the high-resolution clock pass: introduced `IHighResolutionClock` + `SystemHighResolutionClock`, rewired `PerformanceStopwatch`, `GlobalPerformanceStopwatch`, and `PerformanceStatistics` to accumulate elapsed time via injected clocks (scripts can now swap in test clocks through the internal setter). Added thread-safe guards around the global stopwatch cache and supplied `FakeHighResolutionClock`-based NUnit coverage so diagnostics no longer depend on `Thread.Sleep`. Remote debugger tests were expanded (`XmlWriterExtensionsTests`, host busy/ready coverage), and the latest coverage run (`./scripts/coverage/coverage.ps1 -SkipBuild`) shows `NovaSharp.RemoteDebugger` at **78.4‚ÄØ% line / 62.7‚ÄØ% branch / 91.7‚ÄØ% method** with the suite at **1‚ÄØ748** tests.
    - üîÑ (2025-11-15 17:39 UTC) Promoted the clock injection to first-class DI: `ScriptOptions` now exposes a public `HighResolutionClock` property, new `Script` constructors accept custom option snapshots, and the new `ScriptOptionsTests` prove that supplying a fake clock at construction time automatically flows into `PerformanceStatistics`. This unblocks embedders (and Unity) from swapping clocks per script without mutating global state.
    - üîÑ (2025-11-15 18:19 UTC) Completed the debugger time-provider sweep by making `DebuggerAction(ITimeProvider)` public and refactoring `DebugServer` action creation helpers to stamp every queued action with the owning script‚Äôs `TimeProvider`. Rebuilt the full solution (`dotnet build src/NovaSharp.sln -c Release`), reran the Release suite (`dotnet test ... --no-build`, **1‚ÄØ749** tests), and refreshed coverage via `./scripts/coverage/coverage.ps1 -SkipBuild`, which now reports `NovaSharp.RemoteDebugger` at **79.1‚ÄØ% line / 62.6‚ÄØ% branch / 91.9‚ÄØ% method** (overall interpreter totals **90.9‚ÄØ% line / 87.4‚ÄØ% branch / 93.4‚ÄØ% method**).
    - üîÑ (2025-11-15 18:27 UTC) Ported the remaining timestamp consumer on the Hardwire path to the shared `ITimeProvider`: `HardwireCodeGenerationContext`/`HardwireGenerator` now accept an injected provider (defaulting to `SystemTimeProvider`), the context header writes `Code generated on` using that provider, and a new `HardwireCodeGenerationContextTests.TimestampCommentComesFromProvidedTimeProvider` fixture locks the behaviour via `FakeTimeProvider`. `./scripts/coverage/coverage.ps1 -SkipBuild` stays green (interpreter **90.9‚ÄØ% line / 87.3‚ÄØ% branch / 93.4‚ÄØ% method**, NovaSharp.Hardwire **54.8‚ÄØ% line**).
    - üîú Finish hardening the abstractions by (a) plumbing the high-resolution clock through `ScriptOptions` so production callers can replace it without touching internals, (b) auditing the remaining shared state (DebuggerAction timestamps, `_globalStopwatches`, remote-debugger queues) for thread-safety in async/Lua interop scenarios, and (c) extending the time-provider migration to other wall-clock consumers (`DebuggerAction`, `OsTimeModule`, CLI timestamping). Document the threading/DI guidelines in PLAN once the audit completes.
    - üîÑ (2025-11-15 18:48 UTC) Verified IO pluggability by wrapping `Script.GlobalOptions.Platform` with a recording accessor in new `IoModuleTests`: the tests assert `io.open` routes through the accessor‚Äôs `OpenFile` hook (capturing payloads while still writing to disk) and that `io.write` traffic can be mirrored via a custom `StdOut` stream without breaking default behaviour. This documents the existing extensibility story (PlatformAccessor + script streams) and provides regression coverage for future backend/provider refactors.
    - üîÑ (2025-11-15 19:05 UTC) Hardened the shared stopwatch infrastructure: `PerformanceStatistics` now guards all `_globalStopwatches` mutations with `GlobalSyncRoot`, preventing races when one thread toggles `Enabled` while another calls `StartGlobalStopwatch`. Added `GlobalStopwatchRemainsStableWhenTogglingEnabledFromOtherThreads` to stress this path under parallel load so future changes can‚Äôt regress the thread-safety guarantees.
    - üîÑ (2025-11-15 19:20 UTC) Eliminated the remaining `DateTime.UtcNow` polling loops from the debugger HTTP/WS tests by introducing `TestWaitHelpers` (Stopwatch-based spin helpers). `HttpServerTests`, `RemoteDebuggerTests`, and `RemoteDebuggerServiceTests` now rely on deterministic wait utilities rather than ad-hoc deadlines, which keeps the test suite aligned with the no-direct-clock policy while simplifying future time-provider swaps.
    - üîú Verify that the IO module (and other side-effectful modules) expose pluggable backends/hooks so embedders can tap script IO into brokers, event streams, or custom telemetry while still honoring Lua semantics. Inventory current extension points, design a provider model if gaps remain, and add regression tests proving that swapping the backend does not break vanilla IO behaviour.
    - üîú Run a full production + test audit for concurrency safety: verify every mutable singleton/global cache, async interop path, and test fixture that flips shared state (platform accessors, debugger queues, global clocks) is raceless, properly synchronized, and uses `try/finally`/IDisposable scopes to restore prior state. Catalog any risky areas and capture remediation items in PLAN before moving forward.
    - üîú Add a safety lint: whenever tests or production code temporarily mutates shared state (global clocks, static caches, platform hooks), enforce `try/finally`, disposable scopes, or explicit setup/teardown fixtures so the previous state is restored even on failure. Capture the rule in PLAN + contributing docs and audit existing tests (e.g., the new clock injections) to follow the pattern.
    - üîÑ (2025-11-15 17:00 UTC) First dependency sweep results:
        - **Time**: `NovaSharp.Interpreter.Compatibility.Stopwatch`, `Debugging.DebuggerAction`, and `CoreLib.OsTimeModule` all call `DateTime.UtcNow/Now` directly; `HardwireCodeGenerationContext` timestamps code with `DateTime.Now`. Each should accept the planned `ITimeProvider` (or equivalent) so tests can inject deterministic clocks.
        - **Process launching**: `StandardPlatformAccessor.RunCommand`, `DebugCommand` (CLI), and tutorial samples invoke `Process.Start` directly; wrap behind an interface so tests can stub launches (vital for Unity/CI).
        - **Filesystem**: `StandardPlatformAccessor` performs `File.Exists/Delete/Move`, and `HardWireCommand`/`PerformanceReportWriter` manipulate files synchronously. Consider funneling these through a lightweight `IFileSystem` abstraction (or `IPlatformAccessor` extensions) for easier testing/mocking on Unity.
      These items feed the forthcoming abstraction backlog; next pass will prioritize the `ITimeProvider` refactor, then layer process/filesystem shims where tests currently depend on real IO.
    - üîú Introduce a `TimeProvider` abstraction usable on `netstandard2.1`/Unity (e.g., an `ITimeProvider` interface with production + `FakeTimeProvider` implementations) so clock-dependent code (`PerformanceStopwatch`, scheduler throttles, idle detection) and tests stop calling `DateTime.UtcNow/Now` directly. Update diagnostics/runtime components to accept the provider via DI/factories, and refactor existing tests to inject the fake provider instead of sleeping; document the pattern in PLAN once the first subsystem adopts it.
    - üîÑ (2025-11-15 14:26 UTC) Burned down the `LuaStateInterop.Tools` hotspot: added comprehensive NUnit coverage for unsigned/sign fallback paths (`IsPositive`, `ToUnsigned`, `ToInteger`, `UnboxToLong`), regex meta-char decoding (octal `\000`, control escapes, passthrough), and the previously untested `sprintf` combinations (space-plus/zero-plus flags, left alignment overriding zero padding, `%c` numeric/char inputs, `%s` right alignment, `%f/%e/%E/%g/%G`, `%i`, `%#o` with space padding, `%hd/%hu/%ld/%lu`). `dotnet test ... --filter "FullyQualifiedName~LuaStateInteropToolsTests"` and the refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run now show `NovaSharp.Interpreter.Interop.LuaStateInterop.Tools` at **98.2‚ÄØ% line / 90.4‚ÄØ% branch coverage**, pushing overall interpreter totals to **90.7‚ÄØ% line / 87.4‚ÄØ% branch / 93.1‚ÄØ% method** with **1‚ÄØ721** Release tests.
    - üîÑ (2025-11-14) Introduced `Units/CoroutineTests` covering `Coroutine.Resume` failure on dead instances, `AsTypedEnumerable` iteration, CLR callback path, and state progression (NotStarted ‚Üí Suspended ‚Üí Dead); `dotnet test ... --filter "FullyQualifiedName~CoroutineTests"` plus the refreshed coverage pass keeps `NovaSharp.Interpreter.DataTypes.Coroutine` steady at **87.8‚ÄØ%** line / **86.1‚ÄØ%** branch while interpreter totals remain **88.6‚ÄØ%** line / **84.6‚ÄØ%** branch / **91.9‚ÄØ%** method with **1‚ÄØ571** Release tests.
    - ‚úÖ (2025-11-14) Fixed `BinaryOperatorExpression.EvalArithmetic` to handle `Operator.Power`, aligning direct expression evaluation with Lua ¬ß3.4.1 and preventing `DynamicExpressionException` when tests/assertions use the AST evaluation path.
    - üîú Extend the sweep to remote-debugger automation (attach/resume/watch evaluation) before re-enabling the remaining TAP IO/OS suites.
  - ‚úÖ Restored CLI interpreter decorated-error coverage by swapping `ProgramTests.InterpreterLoopPrintsInterpreterExceptionDecoratedMessage` to throw `ScriptRuntimeException`, unblocking Release builds and keeping the `Program` decorated-message branch under test (coverage refresh pending next `./scripts/coverage/coverage.ps1` run).
  - ‚úÖ Added `LoadModuleTests`, `ParameterDescriptorTests`, `AutoDescribingUserDataDescriptorTests`, `StandardEnumUserDataDescriptorTests`, `UnityAssetsScriptLoaderTests`, `WatchItemTests`, `ValueTypeDefaultCtorMemberDescriptorTests`, and parser exception coverage (`SyntaxErrorExceptionTests`, dynamic expression constructors), pushing interop descriptors above 70‚ÄØ% coverage, closing debugger/watch gaps, and keeping interpreter totals on an upward trend.
- **Milestone 2 ‚Äì Integration & Debugger Coverage (Weeks 2-4)**  
  Build scripted VS Code + remote debugger sessions using `Microsoft.VisualStudio.Shared.VstestHost` (or equivalent) to validate attach/resume/breakpoint-insert/watch evaluation flows. Add Lua fixture-backed smoke tests for `NovaSharp.RemoteDebugger` and CLI shell transcripts; capture transcripts as golden files in `src/tests/TestRunners/TestData`. Ensure TAP IO/OS suites run in trusted CI lane or supply equivalent managed tests hitting filesystem/environment abstractions.
- **Milestone 3 ‚Äì Coverage Gates & Reporting (Week 4)**  
  Wire coverage upload to Codecov (or Azure DevOps equivalent), failing PRs under 85% line coverage and raising the gate to 90% once Milestones 1-2 land. Add a dashboard to `docs/Testing.md` summarizing module-by-module coverage and bake badge URLs into `README`. Ensure nightly CI refreshes artefacts and warns on ‚â•3% regressions via GitHub checks.
- **Milestone 4 ‚Äì Sustained Quality (Ongoing)**  
  Author contributor guidance (PR template checklist, test matrix updates) requiring new features to include both unit and integration coverage. Automate review lint that rejects files in `src/NovaSharp.Interpreter` without accompanying tests unless tagged `[NoCoverageJustification]` with an engineering sign-off. Track skip-list debt in an issue epic and burn it down as platform lanes stabilize.

## Project Structure & Code Style Alignment
- **Milestone A ‚Äì Solution & Directory Audit (High Priority)**  
  Inventory every `.sln`/`.csproj` in `src`, classify runtime vs tooling vs samples, and propose a consolidated folder hierarchy (runtime/interpreter, debuggers, tooling, samples, tests). Produce a migration blueprint documenting path moves, namespace impacts, and packaging implications. Acceptance: reviewed architecture doc + updated `docs/Modernization.md` appendix.
  - ‚úÖ `docs/ProjectStructureBlueprint.md` captures the current vs. proposed layout, legacy inventory, and phased migration plan.
- **Milestone B ‚Äì Refactor Execution (High Priority)**  
  Reshuffle projects/solutions per blueprint (rename folders, update `.sln`, `.csproj`, `Directory.Build.props`), add `Directory.Packages.props` if needed, and ensure build/test scripts, CI workflows, and documentation follow new layout. Include regression checklist covering NuGet outputs, debugger packaging, and tooling discovery.
  - ‚úÖ Rehomed runtime, debugger, tooling, samples, tests, docs, and legacy assets under the new directory taxonomy; updated `NovaSharp.sln`, helper scripts, and top-level docs to match.
  - ‚úÖ Collapsed the interpreter `_Projects` mirror into a multi-targeted `NovaSharp.Interpreter.csproj` (netstandard2.1 + net8.0), updating dependent projects, the solution, and automation scripts.
  - ‚úÖ Folded the VS¬†Code debugger `_Projects` mirror into the primary `NovaSharp.VsCodeDebugger.csproj` (netstandard2.1 + net8.0) and refreshed downstream project references.
  - ‚úÖ Renamed the CLI shell to `tooling/NovaSharp.Cli/NovaSharp.Cli.csproj` and adjusted tests/solution/docs to point at the new path.
  - ‚úÖ Audit packaging (NuGet metadata, release notes, scripts) for the CLI rename and update any hard-coded paths. `src/release_readme.txt` now documents the `cli/` drop (formerly `repl`) and `docs/ProjectStructureBlueprint.md` reflects the new naming.
  - ‚úÖ Replaced CLI `packages/*` binaries with NuGet-managed references; ensure remaining legacy tooling cleans up any straggler DLL drops.
- **Milestone C ‚Äì Script & Documentation Hub (High Priority)**  
  Establish a coherent `scripts/` hierarchy and reinforce Markdown documentation so contributors have a single source of truth.
  - Audit every helper script (PowerShell, Bash, Python) and relocate them into `scripts/<area>` folders (`scripts/build`, `scripts/coverage`, `scripts/dev`), adopting descriptive names (`scripts/coverage/coverage.ps1` + `coverage.sh`, branding guards, etc.) and consistent shebang/parameter docs.
    - üîÑ Seeded the hub by relocating the coverage helpers into `scripts/coverage/` (PowerShell + Bash) and adding folder-level READMEs; migrated the branding guard to `scripts/branding/ensure-novasharp-branding.sh` with its own README‚Äînext up is the remaining legacy build helpers.
    - üîÑ (2025-11-14) Staged `scripts/build/` with cross-platform wrappers (`build.ps1`/`build.sh` + README) that restore tools, run `dotnet build src/NovaSharp.sln -c <Configuration>`, and optionally execute the interpreter tests into `artifacts/test-results`; `docs/Testing.md` + `scripts/README.md` now reference the new helpers so contributors know the standard build pipeline location.
    - üîÑ (2025-11-14) Updated `.github/workflows/tests.yml` to call `scripts/build/build.sh --skip-tool-restore` for the Release build + interpreter test lane, keeping CI aligned with the documented helper and ensuring TRX artifacts still land in `artifacts/test-results`.
    - ‚úÖ (2025-11-14) Added `scripts/ci/ensure-readme-updates.sh` and wired it into the workflows so helper/script additions fail CI unless the docs index + subfolder READMEs are updated; both jobs now checkout with `fetch-depth: 0` for reliable diffs.
    - üîÑ (2025-11-14) Introduced `scripts/dev/` (pre-commit installer + staged-file formatter) alongside `scripts/ci/check-markdown.sh`, `check-csharpier.sh`, and `apply-formatters.sh`; documented the workflow in `docs/Contributing.md` so contributors run `python -m pip install -r requirements.tooling.txt`, enable the shared hook, and rely on automated Markdown formatting/link checks.
    - üîÑ (2025-11-14) Rebuilt the Markdown lint/link infrastructure on Python (`scripts/ci/format_markdown.py`, `scripts/ci/check_markdown_links.py`) and updated the `lint` GitHub Actions job to gate PRs on those checks + CSharpier. Failing in-repo PRs still get an auto-generated fix branch via the `lint-autofix` job (powered by `scripts/ci/apply-formatters.sh` and `peter-evans/create-pull-request`) without any Node dependencies.
  - Provide dual-platform shims where practical (PowerShell + Bash) and record fallback logic (e.g., macOS/Linux call `scripts/coverage/coverage.sh` when PowerShell is unavailable); update CI workflows and developer docs to reference the new paths.
    - ‚úÖ Both coverage scripts now auto-set `DOTNET_ROLL_FORWARD=Major` when unset, so hosts with only .NET 9 can run coverage without extra env setup; docs updated to mention the behaviour.
    - ‚úÖ (2025-11-14) Fixed `scripts/coverage/coverage.ps1` repo-root detection (it was stopping under `scripts/` and trying to build `scripts/src/NovaSharp.sln`), and double-checked the other helpers: `scripts/build/build.ps1` already walks two levels and the Bash coverage shim keeps `cd`-ing to `../..`.
  - Author `scripts/README.md` plus per-subfolder READMEs describing prerequisites, environment variables, and sample invocations; cross-link these from `README.md`, `docs/Testing.md`, and `docs/Modernization.md`.
    - üîÑ Added a top-level `scripts/README.md` and `scripts/coverage/README.md` so contributors can discover tooling (build, coverage, branding) without spelunking.
    - üîÑ Documented the modernization audit helper in `docs/Modernization.md` so contributors know how to regenerate the legacy rename report.
    - ‚úÖ Added `docs/Contributing.md` and linked it from the README to centralize build/test/coverage/namespace guidance for new contributors.
  - Curate a documentation index (`docs/README.md`) that maps every Markdown guide (testing, modernization, Lua compatibility, benchmarks, Unity integration, coverage dashboards) and ensure each section has a clear owner/status checklist.
    - ‚úÖ Created `docs/README.md` as a searchable index pointing to testing, coverage, modernization, Lua compatibility, performance, Unity, and scripts; linked it from the repo README.
  - Add a PR checklist/CI guard requiring new scripts to update the appropriate README entry and new docs to be linked from the index, keeping the ecosystem discoverable long-term.
    - üîÑ Introduced `.github/pull_request_template.md` with checklist items for docs index + script READMEs; monitor usage before adding CI enforcement.
- **Milestone D ‚Äì Namespace & Using Enforcement**  
  Introduce Roslyn analyzers or custom scripts to ensure namespaces mirror the physical path + project root (`NovaSharp.Interpreter.Debugging` style), and require `using` directives to live inside namespaces. Provide migration scripts to batch-update existing files, codify exceptions for generated/bundled code, and document rules in `docs/Contributing.md`.
  - ‚úÖ Added `tools/NamespaceAudit/namespace_audit.py` to surface directory/namespace mismatches (current hot spots: CLI/Hardwire/NovaSharp.Comparison).
  - üîÑ Enhanced the audit script with category/allowlist support, aligned NovaSharp.Cli + benchmark namespaces, and wired `python3 tools/NamespaceAudit/namespace_audit.py` into CI (tests/coverage jobs) so deviations fail the build immediately.
- **Milestone E ‚Äì EditorConfig Adoption + Lua Exceptions**  
  Import `.editorconfig` from `D:/Code/DxMessaging-Unity/Packages/com.wallstop-studios.unity-helpers`, strip BOM (`charset = utf-8`), and align with repo conventions (CRLF is acceptable). Add sub-directory `.editorconfig` under Lua fixture folders to keep Lua-specific indentation/whitespace expectations. Document formatting commands and exception rationale in `docs/Testing.md` + PR template.
- **Milestone F ‚Äì Solution Organization & Naming (Current Sprint)**  
  Harden the Visual Studio solution layout and align naming with PascalCase conventions for first-party assets. Scope includes renaming the solution artifact, ensuring nested folders mirror `runtime/tooling/tests/debuggers`, and cleaning up lingering `.netcore` suffixes in project surfaces.
  - ‚úÖ Renamed `src/NovaSharp.sln` to `src/NovaSharp.sln`, updated build/test docs, and nested Benchmarks under the Tooling solution folder to prevent empty roots.
  - ‚úÖ Rebranded the VS Code debugger project (`NovaSharp.VsCodeDebugger.csproj`) and refreshed dependent project references to respect PascalCase naming.
  - ‚úÖ Updated VS¬†Code debugger package metadata (dropped `.netcore` suffix) and documented the new single-source layout.
  - üîù Enforce a repository-wide naming conformance sweep: audit every class, method, property, project, file, and variable name against `.editorconfig` + the C# style guide, extend the tooling to validate private `_camelCase` fields/locals in addition to PascalCase members, treat mismatches as release blockers unless explicitly allowlisted for Lua interop, and document the full checklist (tools, validation steps, CI wiring) in this PLAN and `docs/Contributing.md` so contributors understand the canonical expectations before submitting patches.
  - üîÑ (2025-11-18 20:45 UTC) Seeded the sweep with `tools/NamingAudit/naming_audit.py` + README, which scans all `.cs` files for non-PascalCase file/type declarations and emits actionable reports (line numbers + file paths). The helper mirrors the existing `NamespaceAudit` pattern so we can iterate quickly, grow the allowlists, and wire it into CI once the outstanding violations are cleaned up.
  - üîÑ (2025-11-19 15:30 UTC) Expanded `tools/NamingAudit/naming_audit.py` to validate private `_camelCase` fields, add path-scoped allowlists for Lua-facing DTOs/interop shims, and recognise `pcall_*` continuations so Lua helpers keep their canonical spellings. Reran the audit (`python3 tools/NamingAudit/naming_audit.py > naming_audit.log`) which now reports **300** outstanding identifiers (down from 331) with the remaining hot spots concentrated in `DispatchingUserDataDescriptorTests`, platform auto-detection fixtures, and the remote-debugger suites. Burned down the highest-signal offenders by renaming the benchmark job configurations/scripts (`BenchmarkConfig`, `BenchmarkScripts`, `DefaultConfigFactory`, `LuaRuntimeSuites`, `LuaScriptCorpus`) and updating NUnit fixtures (`ProxyObjectsTests`, `RealWorldScriptTests`, `DynamicAndAdjustmentExpressionTests`, `EmbeddedResourcesScriptLoaderTests`, `FunctionCallExpressionTests`, `MetatableTests`, `MethodMemberDescriptorTests`, `HttpServerTests`) so they now comply with PascalCase/`_camelCase` expectations.
  - üîÑ (2025-11-19 16:40 UTC) Knocked the audit backlog down to **255** entries by cleaning up `DispatchingUserDataDescriptorTests` (private field renames + helper parameter cleanup), remote-debugger suites (`RemoteDebuggerTests`, `RemoteDebuggerServiceTests`), loader/unit fixtures (`ObjectCallbackMemberDescriptorTests`, `PlatformAutoDetectorTests`, `PlatformAccessorBaseTests`, `ProgramTests`, `ReplInterpreterScriptLoaderTests`, `TokenTests`, `PerformanceStatisticsTests`, `RefIdObjectTests`), and the Unity proxy samples. Regenerated `naming_audit.log` after the run and validated via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release` (2‚ÄØ263 tests, 35‚ÄØs) so the renamed identifiers remain green. Next pass will tackle the runtime/core-library entries surfaced near the top of the new log (`UnityAssetsScriptLoaderTests`, `Chapter6.cs`, `Framework.cs`, `BasicModule`, etc.).
  - üîÑ (2025-11-19 18:30 UTC) Promoted the new static-field convention: `.editorconfig` now enforces PascalCase for every static/static readonly field, `tools/NamingAudit/naming_audit.py` mirrors the rule (private statics now expect PascalCase), and the repo-wide pass renamed the previously `_`-prefixed statics (benchmarks, debugger harnesses, runtime registries, tutorial fixtures, diagnostics, and Unity reflection helpers). Fresh audit output sits at **238** issues (runtime-only hotspots like `SymbolRef`, `BinaryOperatorExpression`, and `ScriptToClrConversions` remain), and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release` passed to guard the broad rename.
  - üîÑ (2025-11-19 00:36 UTC) Normalized `BinaryOperatorExpression` internals: the parser/list nodes now expose `Expression/Operator/Previous/Next`, the chain state tracks `Head/Tail/OperatorMask`, and operator-precedence constants use descriptive PascalCase identifiers (`PowerOperator`, `ComparisonOperators`, etc.). Updated the helper pipelines (`PrioritizeLeft/RightAssociative`, chain reducers, emit/eval paths) to use the new names and reran the focused suite via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter \"FullyQualifiedName~BinaryOperatorExpressionTests\"` (42 tests) to confirm the AST reductions still behave. While plumbing the change, extended `tools/NamingAudit` so operator overloads no longer appear as false-positive ‚Äúfield‚Äù issues, dropping the outstanding naming hits to **176** (`naming_audit.log` refreshed for the next pass).
  - üîÑ (2025-11-19 00:49 UTC) Reconciled Lua API parity with the naming sweep: `tools/NamingAudit` now allowlists the KopiLua identifiers in `LuaStateInterop/CharPtr` and `LuaStateInterop/LuaBase` (including `LUA_QL`) so Lua-facing docs and tutorials stay accurate, while C#-only code was normalized (`ExtensionMethodsRegistry` internals now use PascalCase, `TypeDescriptorRegistry` exposes `RegisterProxyTypeImpl`/`RegisterTypeImpl`, `LoopTracker` provides a `Loops` stack, and the `OverloadedMethodMemberDescriptor` cache fields/constants were renamed). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build` remains green (2‚ÄØ263 tests), and the refreshed `naming_audit.log` reports **145** remaining violations concentrated in VM `ByteCode` internals and the debugger SDK surfaces.
  - üîÑ (2025-11-19 01:50 UTC) Reconciled Lua API parity with the naming sweep: `tools/NamingAudit` now allowlists the KopiLua identifiers in `LuaStateInterop/CharPtr` and `LuaStateInterop/LuaBase` (including `LUA_QL`) so Lua-facing docs and tutorials stay accurate, while C#-only code was normalized (`ExtensionMethodsRegistry` internals now use PascalCase, `TypeDescriptorRegistry` exposes `RegisterProxyTypeImpl`/`RegisterTypeImpl`, `LoopTracker` provides a `Loops` stack, ByteCode/Processor emitters are PascalCase, and the `OverloadedMethodMemberDescriptor` cache fields/constants were renamed alongside RemoteDebugger options). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build` remains green (2‚ÄØ263 tests), and the refreshed `naming_audit.log` reports **68** remaining violations concentrated in VM helper methods, the KopiLua string library, and debugger SDK DTOs.
  - ‚úÖ (2025-11-19 02:12 UTC) Finished the debugger-facing sweep: `NovaSharpDebugSession` scope constants, VS Code `Capabilities` properties, protocol fields, and the RemoteDebugger HTTP templates now follow PascalCase; the residual VM helpers were renamed (`YieldSpecialTrap`, `ProcessingLoop`, `InternalExecCall`, etc.). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build` and `python3 tools/NamingAudit/naming_audit.py > naming_audit.log` both run clean‚Äîthe audit now reports **zero** outstanding issues, unblocking CI enforcement.
  - ‚úÖ (2025-11-19 02:20 UTC) Wired the naming audit into CI: both the `lint` and `dotnet-tests` jobs now run `python3 tools/NamingAudit/naming_audit.py` (after the namespace check) so pull requests fail fast on naming regressions; contributors are expected to keep `python3 tools/NamingAudit/naming_audit.py` + `dotnet test ‚Ä¶ --no-build` green locally.
    - üîÑ (2025-11-20 04:07 UTC) Reran `python tools/NamingAudit/naming_audit.py` to police new regressions; the audit flagged the lingering `actions` queue in `ProcessorDebuggerTests` and the `_inner_writer` field in `StreamFileUserDataBaseTests`. Renamed them to `_actions`/`_innerWriter`, refreshed `naming_audit.log`, and confirmed the helper now reports zero issues so the CI gate stays green.
    - üîÑ (2025-11-22 10:55 UTC) Normalized the Lua-surface method names to PascalCase so host APIs match .NET conventions without changing the exposed Lua identifiers. `BasicModule` now exposes `CollectGarbage`, `ToString`, and `ToNumber`; IO/OS/UTF-8 modules picked up `TmpFile`, `GetEnv`, `SetLocale`, `TmpName`, `DiffTime`, `CodePoint`, `GMatch`, `GSub`, and `RandomSeed`; `bit32` helpers now surface as `ArithmeticShift`, `RightShift`, `LeftShift`, `BitTest`, `LeftRotate`, and `RightRotate`; and the JSON shim exposes `IsNull`. Updated the corresponding NUnit suites (`BasicModuleTests`, `IoModuleTests`, `OsSystemModuleTests`, `OsTimeModuleTests`, `Utf8ModuleTests`, `StringModuleTests`, `Bit32ModuleTests`, `JsonModuleTests`, `LuaUtf8MultiVersionSpecTests`, `LuaBasicMultiVersionSpecTests`) to keep coverage green after the rename sweep.
  - ‚úÖ (2025-11-22 23:05 UTC) Renamed the lingering dot-delimited partial files (`Program.TestHooks.cs`, `Processor.TestHooks.cs`) to PascalCase (`ProgramTestHooks.cs`, `ProcessorTestHooks.cs`) so the file-surface naming rule stays consistent everywhere. Reran `python tools/NamingAudit/naming_audit.py --write-log naming_audit.log` to refresh the report; it now records zero issues, keeping the CI gate green for the conformance sweep.
  - ‚úÖ (2025-11-22 23:35 UTC) Guarded the shared exception surface so CA1062/CA1308/CA1859 stop firing: every `InterpreterException` ctor now validates the incoming `Exception`, the `ScriptRuntimeException` constructors/helpers (`ScriptRuntimeException(Exception)`, copy ctor, `CompareInvalidType`, `AccessInstanceMemberOnStatics`) throw `ArgumentNullException` when invoked incorrectly, and coroutine state names are cached via `Dictionary<,>` + a `string.Create` pipeline instead of `ToLowerInvariant`. `dotnet build src/NovaSharp.sln -c Release` shows the targeted warnings gone, and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ScriptRuntimeExceptionTests` stays green.
  - ‚úÖ (2025-11-22 23:17 UTC) Added `InvariantString.ToLowerInvariantIfNeeded`/`ToUpperInvariantIfNeeded` so hot paths skip new string allocations when inputs are already correctly cased. `DataType.ToLuaDebuggerString`, the module alias builder, and the remote debugger command/watch plumbing now call the helper instead of blindly invoking `ToLowerInvariant`, shaving recurring allocations in REPL/remote sessions. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter RemoteDebuggerTests`.

## Near-Term Priorities (ordered)
1. **Warning hygiene drive**
    - üîÑ Continue triaging the remaining CA diagnostics (currently ~4‚ÄØ000 warnings from `dotnet build src/NovaSharp.sln -c Release`), prioritising runtime/library hot paths before fanning out to debuggers, tooling, and tests; prefer real fixes over suppressions so analyzer enforcement can land cleanly.
    - üîÑ Once the build is warning-free, flip `TreatWarningsAsErrors` on for CA analyzers in `Directory.Build.props`, rerun the full build/test/coverage pipeline, and update `docs/Testing.md` with the new warning policy so CI fails immediately on regressions.
    - üîÑ Bit32 module null-guard sweep: added `ArgumentNullException` checks to `Bit32Module.Bitwise` (CA1062) so externally visible helpers validate `CallbackArguments` and the accumulator delegate before use; reran `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter Bit32ModuleTests` to confirm the Lua `bit32` surface stays green while the warning count drops.
    - üîÑ Basic module guardrails: `BasicModule.Assert`/`Tostring`/`TostringContinuation` now validate their `ScriptExecutionContext`/`CallbackArguments` inputs before touching them, satisfying CA1062 without changing Lua semantics. Verified via `dotnet test ‚Ä¶ --filter BasicModuleTests` so the existing NUnit coverage observes the same runtime behaviour (apart from the new early ArgNull exceptions for invalid host calls).
    - üîÑ (2025-11-22 18:20 UTC) Knocked out a batch of CA1305/CA1310/CA1854 hits by standardising invariant formatting in `PerformanceResult.ToString`, all `InterpreterException` constructors/DecorateMessage paths, and the `os.date` formatter (`StrFTime`) while also switching the spec pattern map over to `TryGetValue`. `OsTimeModule` now formats every segment with `CultureInfo.InvariantCulture`, `InterpreterException.AppendCompatibilityContext` uses ordinal comparisons, and `PerformanceResult` no longer surfaces locale-sensitive strings or obsolete enum overloads. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "(FullyQualifiedName~OsTimeModuleTests|FullyQualifiedName~InterpreterExceptionTests)"` ‚úÖ (13 tests) to keep the Lua-facing behaviour green after the analyzer fixes.
    - üîÑ (2025-11-22 19:32 UTC) Cleared the benchmark visibility/factory warnings: `RuntimeScenario`, `ScriptComplexity`, `ScriptLoadingBenchmarks`, and `RuntimeBenchmarks` are now `internal`, `RuntimeBenchmarks` uses the generic `UserData.IsTypeRegistered<T>()`, and `BenchmarkHost.Accumulate` persists its result so CA1822 no longer fires. Latest Release build (`dotnet build src/NovaSharp.sln -c Release`) now reports only the CA1031/CA1859 items inside `PerformanceReportWriter`, keeping the warning hygiene focus firmly scoped to that helper.
    - üîÑ (2025-11-22 19:05 UTC) Continued the CA1305/CA1307 cleanup across the benchmark helpers: `LuaScriptCorpus` now emits every generated function via `FormattableString.Invariant` (and flips the tiny script literal to `const`), the console logger uses the char-based `StartsWith`/`Contains` overloads with explicit ordinal comparisons, and `PerformanceReportWriter` gained an `AppendLineInvariant` helper plus ordinal `Replace` calls so the Markdown blocks, timestamps, and normalization paths stay locale-neutral. Rebuilt the solution in Release (`dotnet build src/NovaSharp.sln -c Release`) to confirm the warning count dropped from 29 ‚ûú 12 with no regressions.
    - üîÑ (2025-11-22 20:07 UTC) Knocked out another chunk of analyzer debt: `PerformanceReportWriter` now catches only the specific registry/memory exceptions we actually expect (Security/UnauthorizedAccess/IOException/InvalidOperation/PlatformNotSupported) and its parsing helpers return concrete `Dictionary`/`List` instances so CA1031/CA1859 are satisfied. On the runtime side the entire `bit32` surface, `json.parse/serialize/isnull/null`, and the `debug.debug` REPL gained `ModuleArgumentValidation` guards + narrowed catch blocks, eliminating the CA1062 noise without altering Lua semantics. Verified via `dotnet test ‚Ä¶ --filter "FullyQualifiedName~Bit32ModuleTests|FullyQualifiedName~JsonModuleTests"` so the hot paths stay green.
    - ‚úÖ (2025-11-22 23:30 UTC) Guarded the Lua 5.4 `warn` helper and modernized `io.open`: `BasicModule.Warn` now feeds both `ScriptExecutionContext` and `CallbackArguments` through `ModuleArgumentValidation`, while `IoModule.Open` validates mode strings via a simple allowed-character scan (no more culture-sensitive `Replace` chains) and `IoExceptionToLuaMessage` throws when `ex` is null. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~BasicModuleTests|FullyQualifiedName~IoModuleTests"` stays green, and the CA1062/CA1307 warnings for those APIs drop accordingly.
    - ‚úÖ (2025-11-22 23:45 UTC) tightened the `ScriptExecutionContext` surface so host callbacks stop tripping CA1062: `GetMetatable`, `GetMetamethod`, `GetBinaryMetamethod`, `EmulateClassicCall`, `Call`, and `PerformMessageDecorationBeforeUnwind` now throw `ArgumentNullException` when invoked with null inputs, keeping the runtime contracts explicit. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ScriptExecutionContextTests` stays green, and the warning backlog for those helpers disappears.
  - ‚úÖ (2025-11-24 05:05 UTC) Guarded `ScriptLoaderBase.ResolveModuleName` (both overloads) plus `UnpackStringPaths`, rewired the NUnit suite to assert the new ArgumentNullException contracts (`dotnet test ‚Ä¶ --filter FullyQualifiedName~ScriptLoaderBaseTests`), tightened every `DispatchingUserDataDescriptor` index/set/meta entry point with explicit script/index/value checks (and added new coverage in `DispatchingUserDataDescriptorTests`), and modernized `DotNetCorePlatformAccessor.ParseFileAccess/ParseFileMode` to trim, lowercase, drop whitespace/binary markers, and throw on null inputs (verified via `dotnet test ‚Ä¶ --filter FullyQualifiedName~DispatchingUserDataDescriptorTests` and `‚Ä¶~DotNetCorePlatformAccessorTests`). These changes remove another batch of CA1062/CA1307 hits from the ‚Äúhosting surfaces‚Äù audit item.
  - ‚úÖ (2025-11-24 05:32 UTC) Followed up by switching the `ScriptLoaderBase` path substitution to `StringComparison.Ordinal` and simplifying the environment-path fallback (silencing CA1307/CA1508), refactoring `DispatchingUserDataDescriptor.AddMemberTo` around `TryGetValue`/`TryAdd` with invariant-culture diagnostics, and replacing the `ContainsKey` + indexer patterns in both `TypeDescriptorRegistry` and `BuildTimeScopeBlock` with single-pass `TryGetValue` logic. Re-ran the focused suites (`dotnet test ‚Ä¶ --filter FullyQualifiedName~ScriptLoaderBaseTests`, `‚Ä¶~DispatchingUserDataDescriptorTests`, `‚Ä¶~DotNetCorePlatformAccessorTests`) to confirm no regressions while the analyzer warnings drop.
  - üîú Next action: pivot to the CA13xx warnings now topping the analyzer feed (e.g., `DynValue.ToString`, `StringModule.Lower/Upper`, `OsTimeModule.Date`, and the remaining `InterpreterException` formatting paths) so we can eliminate the culture-sensitive conversions before the TreatWarningsAsErrors flip; keep prioritising runtime/library hot paths ahead of debugger/tooling/test-only code.
    - ‚úÖ (2025-11-24 05:55 UTC) Cleaned up the IO module + tests: `ContainsInvalidModeCharacters` now uses a span-based whitelist and treats null/empty inputs as invalid, `RecordingPlatformAccessor` relies on a cached mode scanner instead of `string.Contains`, and every test path escaping call funnels through a new `EscapePath` helper that uses `StringComparison.Ordinal`. Updated the NUnit corpus accordingly (e.g., `io.open` cases now call `EscapePath`) and reran `dotnet test ‚Ä¶ --filter FullyQualifiedName~IoModuleTests` to lock in the changes; CA1307 noise for the IO stack + harness is gone.
    - ‚úÖ (2025-11-24 06:10 UTC) Tightened the IO helpers again: swapped the span-based whitelist for an explicit `switch` so CA1307 can‚Äôt regress on platforms lacking the newer overloads, and exposed `RecordingPlatformAccessor.OpenCalls` as the concrete list backing it so CA1859 stops firing. Verified with `dotnet test ‚Ä¶ --filter FullyQualifiedName~IoModuleTests`; warning-hygiene focus can now shift to the remaining CA13xx hits in `DynValue`, `StringModule`, and `OsTimeModule`.
    - ‚úÖ (2025-11-23 02:45 UTC) Guarded the JSON serializer: `JsonTableConverter.TableToJson` now validates its inputs (`ArgumentNullException` when a null table sneaks through) and uses char-based `StringBuilder.Append` calls so CA1062/CA1834 stop firing in that file. The serialization stack‚Äôs invariant fixes still pass `dotnet build src/NovaSharp.sln -c Release /t:Rebuild`, keeping the warning burndown momentum going.
    - ‚úÖ (2025-11-23 02:55 UTC) Knocked down the debugger-side CA1307 warnings: VS Code‚Äôs `Utilities.MakeRelativePath` now uses ordinal `EndsWith`/`StartsWith`/`Replace`, and the remote-debugger HTTP server strips CR/LF and authorization headers via ordinal operations (plus `string.Contains(char, StringComparison.Ordinal)` for query detection). Latest `dotnet build src/NovaSharp.sln -c Release /t:Rebuild` confirms both debugger projects are CA1307-clean, letting us focus on the remaining test-only hotspots next.
    - ‚úÖ (2025-11-23 03:10 UTC) Updated the remote debugger tests to use explicit ordinal helpers (`ContainsOrdinal`) and threaded the char-based mode parsing in `IoModuleVirtualizationTests`, clearing the bulk of CA1307 warnings in the debugger unit suite. Follow-up work will tackle the remaining non-debugger test fixtures, but `dotnet build src/NovaSharp.sln -c Release /t:Rebuild` already reports the debugger tests clean.
    - ‚úÖ (2025-11-23 02:33 UTC) Hardened the KopiLua formatting shims: `LuaStateInterop.Tools` now parses formatter metadata with invariant `Convert` calls, ordinal span-based flag detection, and string formatting that always routes through `CultureInfo.InvariantCulture`, while `LuaBaseCLib` handles hex classification and casing via explicit ranges plus `ToLowerInvariant`/`ToUpperInvariant`. `dotnet build src/NovaSharp.sln -c Release /t:Rebuild` confirms the `sprintf`/`isxdigit` CA1304/CA1305/CA1307 warning bucket is clear without altering Lua-visible behaviour.
    - ‚úÖ (2025-11-23 03:20 UTC) Scrubbed the CA1307 warnings from the debugger + serialization test suites: remote debugger tests/services, `UserDataMethodsTests`, `ProcessorStackTraceTests`, `LuaStateInteropToolsTests`, and the virtualized IO platform now use explicit ordinal helpers (or span-based `IndexOf`) instead of implicit `Contains`, bringing the test projects to zero CA1307 hits. Rebuilt via `dotnet build src/NovaSharp.sln -c Release /t:Rebuild` to verify the clean slate before tackling the remaining analyzer buckets.
    - ‚úÖ (2025-11-23 02:13 UTC) Replaced culture-sensitive runtime checks with ordinal/invariant helpers across `PlatformAutoDetector`, `PlatformAccessorBase`, `StandardPlatformAccessor`, `ReflectionSpecialName`, `Script.LoadString`, and `LexerUtils`, eliminating the CA1304/CA1307/CA1310 warnings tied to platform detection and lexer parsing. `dotnet build src/NovaSharp.sln -c Release /t:Rebuild` now reports those CA13xx buckets cleared while keeping behaviour identical.
    - üîÑ (2025-11-23 00:42 UTC) Eliminated another CA13xx pocket: `string.lower`/`string.upper` now route through `CultureInfo.InvariantCulture`, `os.date` drops the culture-sensitive `StartsWith` in favour of a direct `'!'` check, and `DynValue.ToString`/`CastToString` emit invariant results (boolean literals, numeric formats, ordinal string hashing, CLR function label). `dotnet build src/NovaSharp.sln -c Release` reports **1‚ÄØ715** warnings (down from 1‚ÄØ726) and `dotnet test ‚Ä¶ --filter "FullyQualifiedName~StringModuleTests|FullyQualifiedName~OsTimeModuleTests|FullyQualifiedName~DynValueTests"` passes (99 Release tests), keeping the warning-drive momentum going.
    - üîÑ (2025-11-23 00:45 UTC) Converted the remaining opcode/trace formatting paths to invariant output so CA1305/CA1310 stop flagging them: `SymbolRef.ToString` now relies on `FormattableString.Invariant`, `Instruction.ToString` renders all numeric fields with `CultureInfo.InvariantCulture`, `ByteCode.Dump` avoids `AppendFormat`, and `debug.traceback` writes each stack line via explicit `StringBuilder` appends. `dotnet build src/NovaSharp.sln -c Release` drops to **1‚ÄØ707** warnings (‚àí8), and `dotnet test ‚Ä¶ --filter "FullyQualifiedName~SymbolRefTests|FullyQualifiedName~ByteCodeTests|FullyQualifiedName~DebugModuleTests"` (66 tests) keeps coverage green.
    - üîÑ (2025-11-23 00:55 UTC) Knocked out another CA13xx/CA1062 cluster: `string.lower`/`string.upper` now call `InvariantString.ToLowerInvariantIfNeeded`/`.ToUpperInvariantIfNeeded`, `StandardPlatformAccessor.ParseFileAccess/ParseFileMode` validate inputs and strip `b` flags via an ordinal helper (plus an informative `ArgumentException` in `GetStandardStream`), and the REPL compares prefixes using `StringComparison.Ordinal` while null-checking inputs. `dotnet build src/NovaSharp.sln -c Release` reports **1‚ÄØ701** warnings (‚àí6), and `dotnet test ‚Ä¶ --filter "FullyQualifiedName~ReplInterpreterTests|FullyQualifiedName~StandardPlatformAccessorTests|FullyQualifiedName~StringModuleTests"` (59 tests) stays green, keeping the warning drive focused on the remaining CA10xx/CA18xx hotspots.
    - üîÑ (2025-11-23 01:05 UTC) Trimmed the VM/debugger warning noise: `Instruction.PurifyFromNewLines`/`DumpValue` are now static helpers and `RefreshDebuggerThreads` formats coroutine IDs via `FormattableString.Invariant`, clearing the CA1822/CA1305 set. Fresh Release build drops to **1‚ÄØ695** warnings, and the targeted suites (`dotnet test ‚Ä¶ --filter "FullyQualifiedName~ByteCodeTests|FullyQualifiedName~ProcessorDebuggerTests"`) stay green while the VM bytecode + debugger threads go through the new invariant helpers.
    - üîÑ (2025-11-23 01:15 UTC) Followed up inside the platform layer/tests: `StandardPlatformAccessor.NormalizeMode` now uses ordinal char scans (satisfying CA1865 without regressing the earlier fixes), the accessor tests run as `internal sealed` and dispose their `StringWriter`, and the focused suite (`dotnet test ‚Ä¶ --filter FullyQualifiedName~StandardPlatformAccessorTests`) confirms the behavioral contract. Warning count holds at **1‚ÄØ695**, but the StandardPlatform slice is now CA1865/CA2000 clean.
    - üîÑ (2025-11-22 05:01 UTC) Hardened the runtime callback + snippet helpers: `CallbackFunction.Invoke`/`FromDelegate`/`FromMethodInfo`/`CheckCallbackSignature` and `CallbackArguments.AsStringUsingMeta` now throw `ArgumentNullException` for invalid host inputs, `CallbackArguments.GetArray` uses `Array.Empty`, and the while/repeat/scope block builders store the concrete `CompositeStatement` type so CA1062/CA1825/CA1859 drop from those files. `SourceCode.GetCodeSnippet` now validates refs, slices via `ReadOnlySpan<char>`, and exposes a static clamp helper which clears CA1062/CA1846/CA1822, while `Processor.EnterProcessor` uses `Environment.CurrentManagedThreadId` + invariant formatting, `UndisposableStream.Dispose` calls `base.Dispose`, and `ProcessorBinaryDump.Dump` throws a descriptive `ArgumentException`, removing the CA1840/CA1305/CA2215/CA2208 debt. `dotnet build src/NovaSharp.sln -c Release` now emits 1‚ÄØ911 warnings (down from 1‚ÄØ928 before this pass) and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter FullyQualifiedName~CallbackFunctionTests` stays green to cover the tightened guards.
    - üîÑ (2025-11-22 05:07 UTC) Scrubbed CA1062/CA1822 noise from `Table`: every externally visible overload (`Append`, `Set` string/int/DynValue/object/object[]`, `RawGet(DynValue)`, `Remove(DynValue)`, and `NextKey`) now validates its `DynValue` inputs up front, the params constructor enforces a non-null array, and helper methods that never touch instance state (`GetIntegralKey`, `GetNextOf`) were marked static. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter TableTests` (57 tests) and spot-checked `dotnet build src/NovaSharp.sln -c Release | Select-String \"Table.cs\"` to confirm the Table-specific CA1062/CA1822 diagnostics no longer appear; overall warning count drops by another 10 to keep the hygiene drive moving.
    - ‚úÖ (2025-11-24 01:20 UTC) Cleaned up CA1308/CA1305/CA1062/CA1002/CA2263 warnings across the shared runtime helpers: `DataType.ToLuaDebuggerString` now emits explicit Lua-style literals instead of lowercasing via `ToLowerInvariant`, the `DynValue.NewString/NewTuple` factories validate their inputs and rely on invariant formatting, `UserData` registration/accessors guard their parameters and expose extension metadata as `IReadOnlyList<IOverloadableMemberDescriptor>`, and the ScriptRuntimeException helpers reuse the Lua-type strings plus a coroutine-state formatter to stay locale-neutral. `dotnet build src/NovaSharp.sln -c Release` confirms those warnings are gone; next step is to bring the coroutine resume overloads and `ScriptRuntimeException.CompareInvalidType` in line with the same guard/invariant patterns.
    - ‚úÖ (2025-11-24 02:05 UTC) Hardened every params-based formatting helper (runtime exceptions/logging, hardwire context, VS Code/remote debugger shims, TAP harnesses, userdata fixtures, and UTF-8 transport) so they skip `string.Format` when the argument array is null or empty and simply return the original format string. This prevents accidental `FormatException` when literal braces appear in log/test strings without forcing contributors to double-escape them. `dotnet build src/NovaSharp.sln -c Release` stays green after the sweep.
    - ‚úÖ (2025-11-24 03:05 UTC) Replaced the ad-hoc coroutine-state casing with a cached lookup (known states + concurrent fallback) and did the same for remote debugger watch-type element names so repeated updates no longer allocate or lowercase in tight loops. Audited remaining `ToLowerInvariant` usages: runtime spots are limited to module registration/camelCase conversions that run once per descriptor, while the remote-debugger command dispatcher still normalizes incoming `cmd` attributes per message (low volume today, but flagged as a future micro-optimization if GC pressure shows up). `scripts/coverage/*.ps1` also lowercases CLI args‚Äîleft untouched because they are CLI-only and not perf sensitive.
      - üîú Follow-up: if GC traces ever show debugger command parsing on the hot path, replace the per-message `cmd.ToLowerInvariant()` with an ordinal-ignore-case dictionary or cached lookup similar to the watch-type helper so both command parsing and casing stay allocation-free.
    - ‚úÖ (2025-11-24 03:40 UTC) Guarded every public `Coroutine.Resume` overload with explicit null checks on `ScriptExecutionContext`/argument arrays, swapped the `new DynValue[0]` allocations with `Array.Empty<DynValue>()`, and reran `dotnet test ‚Ä¶ --filter "FullyQualifiedName~CoroutineCloseTests|FullyQualifiedName~CoroutineTests"` to keep the regression suite green. This clears the CA1062/CA1825 warnings called out in the hygiene tracker and prevents accidental `NullReferenceException` when hosts pass `null` params arrays.
    - üîÑ (2025-11-23 00:32 UTC) Guarded the shared LINQ/member-descriptor helpers to trim another pocket of CA1062/CA1860/CA1725 noise: `LinqHelpers.Convert/OfDataType/AsObjects*` now throw `ArgumentNullException` before enumerating null sequences, every `MemberDescriptor` extension validates its descriptor input before touching `MemberAccess`, and `ParameterDescriptor(ParameterInfo)`/`PrepareForWiring(Table t)` both assert non-null arguments while caching the `ParamArray` lookup instead of calling `.Any()`. `dotnet build src/NovaSharp.sln -c Release` now reports **1‚ÄØ726** warnings (down from 1‚ÄØ738 before this pass), keeping the hygiene drive moving toward the TreatWarningsAsErrors flip.
2. **Legacy ‚ûú NovaSharp finalization**
    - ‚úÖ Cleared the filesystem rename queue (`NovaSharp.Interpreter` attribute files, VS Code debugger scaffolding, `_Projects` mirror, JetBrains `.DotSettings`, legacy cache folders).
   - ‚úÖ Rebranded the comparison benchmark harness (`tooling/NovaSharp.Comparison`) with default BenchmarkDotNet config and VS run target output.
   - ‚úÖ Scrubbed `.csproj` entries referencing missing/irrelevant assets (icons, logs, keypairs) to keep IDE surfaces clean.
   - ‚úÖ Refreshed generated artefacts (coverage, benchmarks) under the NovaSharp name and cleaned stale legacy-brand results.
  - ‚úÖ Add guardrail automation (CI grep or analyzer) blocking regressions to the previous branding across code, docs, and assets. CI now runs `scripts/branding/ensure-novasharp-branding.sh`, which fails on new legacy-brand identifiers outside the curated allowlist (perf baseline + benchmark writer shim).
  - ‚úÖ (2025-11-22 05:14 UTC) Reworded the lingering `tools/NamingAudit/naming_audit.py` comment so it no longer references the legacy brand (‚Äúlegacy Lua-port surface‚Äù now), reran `scripts/branding/ensure-novasharp-branding.sh`, and confirmed the branding guard passes without touching the allowlist.
- ‚úÖ Completed an initial vestigial inventory (`docs/modernization/vestigial-inventory.md`) highlighting keep/remove candidates (e.g., legacy REPL history) and modernization notes for performance counters.
- ‚úÖ Audit outstanding legacy runtime issues that still apply to NovaSharp, classify real defects vs legacy gaps, and schedule fixes or deprecations accordingly. See `docs/modernization/moonsharp-issue-audit.md` for the owner/status matrix feeding the modernization tracker.
2. **Vestigial Runtime Review (Pre-Coverage)**
   - ‚úÖ Inventory instrumentation and ancillary runtime helpers (e.g., `PerformanceStopwatch`, `GlobalPerformanceStopwatch`, `DummyPerformanceStopwatch`) ‚Äî catalog captured in `docs/modernization/vestigial-inventory.md` (2025-11-10 snapshot).
   - ‚úÖ Replaced remaining reflection-based access with friend-assembly visibility: `InfrastructureTests` now sets `PerformanceResult` properties directly and instantiates `ExecutionState` without reflection (Release suite 990 tests, 2025-11-12).
   - ‚úÖ Produced keep/modernize/remove recommendations and blocked coverage expansion until the inventory landed; decisions tracked in `docs/modernization/vestigial-inventory.md`.
   - ‚úÖ Logged the diagnostics instrumentation review in `docs/modernization/vestigial-inventory.md`; current guidance is to keep the stopwatch counters and cover them with tests (completed).
3. **Coverage Push (>90%)**
   - ‚úÖ Completed Milestone 0 baseline capture by rerunning `./scripts/coverage/coverage.ps1` (2025-11-11), recording 67.8‚ÄØ% line / 69.7‚ÄØ% branch / 72.1‚ÄØ% method coverage (NovaSharp.Interpreter 81.0‚ÄØ% line), and updating `docs/Testing.md` + coverage exports to document the helper workflow.
  - ‚úÖ Begin Milestone 1 by targeting parser + metatable hot spots and porting CLI shell tests.
  - ‚úÖ Drafted GitHub workflow updates with conditional coverage gating: `code-coverage` job now runs an `Evaluate coverage threshold` step that parses `Summary.json`, warns when line coverage falls below 85‚ÄØ% in monitor mode, and supports flipping to `COVERAGE_GATING_MODE=enforce` once ‚â•85‚ÄØ% is sustained.
  - ‚úÖ Established an interpreter coverage lock at ‚â•95‚ÄØ% line / branch / method: both coverage helpers now fail when the interpreter dips under the 95‚ÄØ% thresholds, `.github/workflows/tests.yml` exports `COVERAGE_GATING_MODE=enforce`, and `docs/Testing.md` documents the enforcement toggle (with the latest baseline metrics).
    - üîÑ Both coverage helpers (`scripts/coverage/coverage.ps1` + `.sh`) now parse line/branch/method coverage for the interpreter and honour `COVERAGE_GATING_MODE` (`monitor` logs warnings at ‚â•95‚ÄØ% targets, `enforce` fails the run). Each script also exposes branch/method threshold overrides so local runs can relax or tighten the gate while CI remains locked to enforce mode.
    - üîÑ (2025-11-20 04:36 UTC) Wired CI to parse 95‚ÄØ% line/branch/method targets but left `COVERAGE_GATING_MODE=monitor` until interpreter coverage consistently clears the bar. The latest Release run (`scripts/coverage/coverage.ps1 -SkipBuild`, 2025-11-20 04:49‚ÄØUTC) reports `NovaSharp.Interpreter` at **96.66‚ÄØ% line / 94.51‚ÄØ% branch / 98.29‚ÄØ% method** across **2‚ÄØ486** tests thanks to the new suites covering literal expressions, internal-error formatting, composite userdata descriptors, table conversions, stream-file edge cases (hex floats, EOF modes, non-rewindable streams), Lua state tooling, Script-type metatable helpers, and Script runtime operations (DoStream, coroutine recycling). Next up: burn down the remaining branch gaps called out in `docs/coverage/coverage-hotspots.md` (Processor debugger fallbacks, `FileUserDataBase` `ReadNumber` branches, Lua state sprintf permutations, `KopiLuaStringLib` matcher cases) so branch coverage clears 95‚ÄØ% and we can flip CI back to `enforce`.
   - üîÑ (2025-11-19 21:29 UTC) Followed up with dedicated helper tests (reflection-backed) that hammer `FileUserDataBase`‚Äôs private hex literal validators (`IsValidHexPrefix`, `IsSignAllowed`, `IsStandaloneSignOrDot`, `TryParseHexFloatLiteral`) plus additional Lua-level scenarios (leading-sign rewind failures, malformed prefixes, positive exponent signs, no-digit edge cases). `NovaSharp.Interpreter.CoreLib.IO.FileUserDataBase` now reports **98.95‚ÄØ% line / 95.9‚ÄØ% branch / 100‚ÄØ% method** coverage, and the latest `scripts/coverage/coverage.ps1 -SkipBuild` run keeps interpreter totals at **96.78‚ÄØ% line / 94.83‚ÄØ% branch / 98.34‚ÄØ% method** across **2‚ÄØ511** Release tests. Remaining branch debt is limited to the defensive `TryParseHexFloatLiteral` guard clauses called out in `docs/coverage/coverage-hotspots.md`; the class no longer blocks the ‚â•95‚ÄØ% branch gate.
   - ‚úÖ (2025-11-22 03:05 UTC) Hardened `FileUserDataBase.Write`/`Close` to wrap every non-script exception (not just `IOException`/`UnauthorizedAccessException`) into the canonical `(nil, message, -1)` tuple so Lua-facing code always receives a proper error result. This fixes the regression observed in `StreamFileUserDataBaseTests.WritereturnsTupleWhenExceptionOccurs`, keeps Lua‚Äôs ¬ß6.8 contracts intact, and prevents host-only exceptions (e.g., `InvalidOperationException`) from bubbling past the runtime boundary. Verified via `dotnet test ‚Ä¶ --filter FullyQualifiedName~StreamFileUserDataBaseTests.WritereturnsTupleWhenExceptionOccurs`.
    - üîÑ (2025-11-19 22:49 UTC) Added `LabelStatementTests` to drive the private `BuildExitScopes` helper (null block short-circuit, reachable-label scope chain, unreachable cleanup) so the goto/label plumbing finally reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage. After rerunning `scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ514 tests), NovaSharp.Interpreter totals sit at **96.79‚ÄØ% line / 94.87‚ÄØ% branch / 98.34‚ÄØ% method**, shrinking the remaining branch gap to ‚âà0.13‚ÄØpp before we flip `COVERAGE_GATING_MODE` to enforce.
    - üîÑ (2025-11-19 23:13 UTC) Backfilled the lingering debugger/scope hotspots: `SourceRefTests` now cover the single-line offset calculations, mid-block inclusion, null-script guard, copy-ctor null path, and both `ToString` branches; `BuildTimeScopeFrameTests` exercise block underflow, unbalanced runtime-frame validation, and the local-renaming path so build-time scope frames report **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage. A fresh `scripts/coverage/coverage.ps1` run (2‚ÄØ523 Release tests) pegs NovaSharp.Interpreter at **96.85‚ÄØ% line / 95.0‚ÄØ% branch / 98.34‚ÄØ% method**, finally clearing the ‚â•95‚ÄØ% branch target and unblocking the switch to `COVERAGE_GATING_MODE=enforce` after we observe a few stable passes.
    - üîÑ (2025-11-20 10:08 UTC) Raised the IO stack: `IoModuleTests` now cover the `__index` shim (`io.stdin`/`stdout`/`stderr`), the public `SetDefaultFile` overloads (StdIn + StdOut), binary encoding paths, and the invalid encoding guard, lifting `NovaSharp.Interpreter.CoreLib.IoModule` to **98.7‚ÄØ% line / 94.4‚ÄØ% branch / 100‚ÄØ% method** coverage. Interpreter totals hold at **96.93‚ÄØ% line / 95.11‚ÄØ% branch / 98.38‚ÄØ% method** across **2‚ÄØ540** tests; remaining <95‚ÄØ% branch debt is now isolated to `IndexExpression` (in-flight), `EventMemberDescriptor`, `SerializationExtensions`, and the REPL helpers.
    - üîÑ (2025-11-20 10:16 UTC) Followed up with additional `ScriptRuntimeExceptionTests` exercising the arithmetic/concat factories, `BadArgumentUserData` allow-nil hints, the negative-number guard, and the loop-in-`__index`/`__call` diagnostics. `NovaSharp.Interpreter.Errors.ScriptRuntimeException` now reports **97.6‚ÄØ% line / 88.4‚ÄØ% branch / 95.0‚ÄØ% method** coverage; interpreter totals remain **96.93‚ÄØ% line / 95.11‚ÄØ% branch / 98.38‚ÄØ% method** while the remaining branch debt shrinks to the reflection descriptors, serialization helpers, and REPL/platform utilities.
    - üîÑ (2025-11-20 10:23 UTC) Locked the ‚â•95‚ÄØ% enforcement gate: reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ547 Release tests) to capture **96.98‚ÄØ% line / 95.13‚ÄØ% branch / 98.57‚ÄØ% method** for `NovaSharp.Interpreter` (overall repo line coverage **87.5‚ÄØ%**), flipped `.github/workflows/tests.yml` to export `COVERAGE_GATING_MODE=enforce`, and refreshed `docs/Testing.md` + `docs/coverage/coverage-hotspots.md` with the new baseline so CI now fails immediately on interpreter dips below the 95‚ÄØ% thresholds.
    - üîÑ (2025-11-16 19:17 UTC) Backfilled `JsonTableConverter` + `ObjectValueConverter` via new unit suites (edge-path JSON parsing, null/enum serialization, IEnumerable expansion, static-property reflection) and reran `./scripts/coverage/coverage.ps1 -SkipBuild`. Interpreter coverage now sits at **93.4‚ÄØ% line / 89.9‚ÄØ% branch / 95.9‚ÄØ% method** across **1‚ÄØ972** Release tests; `docs/coverage/latest` + `docs/coverage/coverage-hotspots.md` capture the snapshot and remaining delta to the 95‚ÄØ% gate.
    - üîÑ (2025-11-16 19:40 UTC) Extended coverage to the `Script` entry points via `ScriptLoadTests` (base64 dumps, `LoadStream` text vs dump paths, `Dump` argument guards, loader return-cases, metamethod + CLR/object `Call` overloads, coroutine recycling, `RunFile`/`RunString`). The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run lifts `NovaSharp.Interpreter.Script` to **93.1‚ÄØ% line / 82.7‚ÄØ% branch / 95.9‚ÄØ% method** and overall interpreter coverage to **93.5‚ÄØ% line / 90.0‚ÄØ% branch / 95.9‚ÄØ% method** across **1‚ÄØ989** Release tests, leaving ~1.5‚ÄØ% of line coverage before we flip the CI gate to enforce mode.
    - üîÑ (2025-11-16 19:54 UTC) Followed up with a DynValue sweep (`Units/DynValueTests`) covering clone/assign/read-only guards, coroutine wrapping, StringBuilder constructors, CLR-function `ToString`, `CheckType` auto conversions, and `CheckUserDataType` nil allowances. `NovaSharp.Interpreter.DataTypes.DynValue` now sits at **87.0‚ÄØ% line / 76.7‚ÄØ% branch / 97.1‚ÄØ% method**, nudging interpreter totals to **93.6‚ÄØ% line / 90.1‚ÄØ% branch / 95.9‚ÄØ% method** across **2‚ÄØ000** Release tests and shrinking the remaining gap to the ‚â•95‚ÄØ% enforcement threshold.
    - üîÑ (2025-11-18 09:28 UTC) Added targeted regression coverage for ScriptOptions, the REPL, ScriptPrivateResourceExtension, and StandardPlatformAccessor, fixing the discovered runtime gaps along the way. `ScriptOptionsTests.CopyConstructorClonesConfiguredValues` now forces the copy constructor to propagate `ColonOperatorClrCallbackBehaviour` (patched), `ReplInterpreterTests.DynamicExpressionReturnsComputedValueWhenCodeIsPresent` + `DynamicExpressionHandlesEmptyCodeAsVoid` exercise both `?expr` and blank `?` paths (the latter now clears `_currentCommand`), `ScriptPrivateResourceExtensionTests` cover null/non-resource DynValues and the `CheckScriptOwnership(Script)` overload, and `StandardPlatformAccessorTests` hit the fallback `ParseFileAccess` branch plus the invalid standard-stream guard. `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ212 tests) now reports NovaSharp.Interpreter at **95.3‚ÄØ% line / 92.2‚ÄØ% branch / 97.4‚ÄØ% method**, trimming the branch delta to ~2.8‚ÄØpp and clearing the REPL + ScriptOptions items off the red list; remaining branch debt sits in `AssignmentStatement`, `TablePair`, the descriptor helpers, and VM bytecode before we can flip the ‚â•95‚ÄØ% gate to enforce mode.
    - üîÑ (2025-11-18 10:13 UTC) Followed up with `Units/AssignmentStatementTests`, building manual `ScriptLoadingContext` instances so we can assert `<const>`/`<close>` combinations plus the duplicate/unknown attribute diagnostics without spinning up the Lua parser. The suite also keeps the ‚Äúnon-variable assignment‚Äù failure under test. `AssignmentStatement` now reports **92.7‚ÄØ% line / 95.4‚ÄØ% branch / 100‚ÄØ% method**, interpreter coverage sits at **95.35‚ÄØ% line / 92.24‚ÄØ% branch / 97.53‚ÄØ% method** across **2‚ÄØ216** Release tests, and the remaining <90‚ÄØ% debt is concentrated in `Errors.SyntaxErrorException`, `AutoDescribingUserDataDescriptor`, `DataTypes.TablePair`, and the VM bytecode helpers. Once those cross the 95‚ÄØ% line/branch threshold we can flip `COVERAGE_GATING_MODE` to `enforce`.
    - üîÑ (2025-11-18 10:34 UTC) Fixed the recursive `TablePair.Key/Value` setters (they now expose the readonly backing fields) and added `Units/TablePairTests` covering the Nil sentinel, constructor storage, and equality/hash semantics. TablePair now reports **93.3‚ÄØ% line / 50.0‚ÄØ% branch / 100‚ÄØ% method**, interpreter coverage holds at **95.37‚ÄØ% line / 92.22‚ÄØ% branch / 97.63‚ÄØ% method** across **2‚ÄØ216** tests, and the red list is trimmed down to the VM bytecode/descriptors called out above.
    - üîÑ (2025-11-18 11:06 UTC) Added the missing adapter-path coverage for `AutoDescribingUserDataDescriptor` (`IndexReturnsNullWhenObjIsNotUserDataType`, `MetaIndexReturnsNullWhenObjIsNotUserDataType`). The descriptor now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` pass (2‚ÄØ218 tests) keeps NovaSharp.Interpreter at **95.39‚ÄØ% line / 92.25‚ÄØ% branch / 97.63‚ÄØ% method** while narrowing the remaining red list to VM bytecode/helpers and the hardwired descriptor fallbacks.
    - üîÑ (2025-11-18 21:33 UTC) Closed the lingering `TablePair` branch gap by extending `Units/TablePairTests` with negative `Equals(object)` cases, key-miss short-circuit assertions, and default/null hash checks, then reran `./scripts/coverage/coverage.ps1 -SkipBuild`. `NovaSharp.Interpreter.DataTypes.TablePair` now reports **93.3‚ÄØ% line / 100‚ÄØ% branch / 90‚ÄØ% method**, interpreter totals sit at **95.5‚ÄØ% line / 92.5‚ÄØ% branch / 97.7‚ÄØ% method** across **2‚ÄØ265** Release tests, and `docs/coverage/coverage-hotspots.md` captures the refreshed snapshot while the ‚â•95‚ÄØ% branch drive continues toward `LoadModule`, the descriptor fallbacks, and VM helpers still under 90‚ÄØ%.
    - üîÑ (2025-11-18 21:40 UTC) Eliminated the `ByteCode` red-list entry by adding jump-point/`EmitInvalid`/`EmitClean` coverage inside `Units/ByteCodeTests`. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ268 tests) now reports `NovaSharp.Interpreter.Execution.VM.ByteCode` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** and lifts interpreter coverage to **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method**, freeing us to focus on `CoreLib.LoadModule`, `MethodMemberDescriptor`, and the remaining debugger/load-path helpers before toggling `COVERAGE_GATING_MODE` to `enforce`.
    - üîÑ (2025-11-18 21:53 UTC) Tightened `DebugService.ResetBreakpoints` by adding NUnit coverage for the `src == null` and `lines == null` guard branches; `DebugService` now sits at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage. `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ270 tests) keeps interpreter totals at **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method** while shrinking the low-branch backlog to the reflection descriptors, BinaryOperatorExpression, and Processor state guards ahead of the ‚â•95‚ÄØ% enforcement flip.
    - üîÑ (2025-11-18 22:06 UTC) Targeted `MethodMemberDescriptor` by extending the NUnit suite (HideMembers access-mode rejection, pointer/generic return constructors, pointer-parameter constructors, reflection-mode void invocation, and the by-ref optimization guard). `CheckMethodIsCompatible` now has explicit coverage for pointer/generic branches, but Coverlet still reports **91‚ÄØ% line / 86‚ÄØ% branch** because the exception-only sequence points (`throw new ArgumentException(...)`) remain uncounted despite the new tests. Interpreter totals stay at **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method** across **2‚ÄØ270** Release tests; continue focusing on `MethodMemberDescriptor`, `BinaryOperatorExpression`, and `Processor` branches until Coverlet reflects the exercised guardrails.
    - üîÑ (2025-11-18 22:18 UTC) Expanded `BinaryOperatorExpressionTests` with table-driven arithmetic and comparison coverage (Add/Sub/Mul/Div/Power, string `<`, `<=` mismatches, `==` nil/void equivalence, and the `>` inversion branch). These scenarios exercise the arithmetic/comparison fast paths even though Coverlet continues to flag the internal-error guard rails (`Expression reduction didn't work`, `OperatorToOpCode` default, and the comparison fallback) as uncovered, keeping `BinaryOperatorExpression` at **93.6‚ÄØ% line / 89.4‚ÄØ% branch**. Interpreter totals remain **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method**; next up is either massaging the guard logic (so Coverlet can observe the defensive throws) or layering additional tests that drive the remaining `BinaryOperatorExpression` branches without resorting to reflection hacks.
   - üîÑ (2025-11-19 19:08 UTC) Added `Units/Bit32ModuleTests` to hammer the `bit32` helpers: extract/replace guardrails (negative positions, zero-width slices, overflow past bit 31), default-width extraction, boolean reducers (`band`, `btest`, `bnot`, `bxor`), and every shift/rotate permutation (positive + negative offsets) now execute under NUnit. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ386 Release tests) lifts `NovaSharp.Interpreter` to **96.36‚ÄØ% line / 93.71‚ÄØ% branch / 98.24‚ÄØ% method**, bumps `NovaSharp.Interpreter.CoreLib.Bit32Module` to **98.5‚ÄØ% line / 92.8‚ÄØ% branch / 100‚ÄØ% method**, and trims the interpreter branch delta to ~1.3‚ÄØpp before flipping the ‚â•95‚ÄØ% gate to `enforce`.
   - üîÑ (2025-11-19 19:25 UTC) Extended `CompatibilityVersionTests` with direct `LuaCompatibilityProfile.ForVersion` coverage (Lua 5.2‚Äì5.5, `Latest`, and the unsupported-version exception). The refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` pass (2‚ÄØ388 Release tests) now reports `LuaCompatibilityProfile` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** and NovaSharp.Interpreter totals at **96.40‚ÄØ% line / 93.72‚ÄØ% branch / 98.24‚ÄØ% method** (branch delta trimmed to ~1.28‚ÄØpp before we can enable the ‚â•95‚ÄØ% gate).
   - üîÑ (2025-11-19 19:34 UTC) Added `Units/FrameworkCurrentTests` to cover the platform abstraction‚Äôs remaining hot paths (TypeInfo-based `GetInterface`, `GetTypeInfoFromType`, DB-null detection, and all `StringContainsChar` flows). `FrameworkCurrent` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** coverage, while the overall interpreter snapshot from `./scripts/coverage/coverage.ps1 -SkipBuild` holds at **96.40‚ÄØ% line / 93.73‚ÄØ% branch / 98.24‚ÄØ% method** (branch delta down to ~1.27‚ÄØpp before the ‚â•95‚ÄØ% enforcement flip).
   - üîÑ (2025-11-19 19:42 UTC) Rounded out `DynamicExpression` coverage with new NUnit tests for cross-script execution guards, null-context symbol lookups, constant-expression `FindSymbol`, explicit non-constant `Evaluate` calls, equality against non-dynamic instances, and the hash-code default path. `./scripts/coverage/coverage.ps1 -SkipBuild` now executes **2‚ÄØ394** Release tests, reports `NovaSharp.Interpreter.Execution.DynamicExpression` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, and pegs interpreter totals at **96.41‚ÄØ% line / 93.77‚ÄØ% branch / 98.24‚ÄØ% method** (branch delta shaved to ~1.23‚ÄØpp shy of the ‚â•95‚ÄØ% enforcement target).
   - üîÑ (2025-11-19 19:59 UTC) Burned down the `DebugModule` red list by backfilling the guard-rail scenarios: new tests cover `debug.getuservalue` on non-userdata/unset values, nil `debug.setmetatable`, zero/out-of-range upvalue indices, CLR `debug.upvalueid`, both `debug.upvaluejoin` error branches, and the remaining `debug.debug`/`debug.traceback` flows (void/null REPL results, named/anonymous stack frames). `NovaSharp.Interpreter.CoreLib.DebugModule` now reports **99.2‚ÄØ% line / 94.7‚ÄØ% branch / 100‚ÄØ% method**, the Release suite expands to **2‚ÄØ406** tests, and interpreter totals climb to **96.46‚ÄØ% line / 93.92‚ÄØ% branch / 98.24‚ÄØ% method** (branch delta ‚âà1.08‚ÄØpp before the ‚â•95‚ÄØ% gating flip).
   - üîÑ (2025-11-20 03:20 UTC) Hardened the processor guard rails: `ProcessorTests` now assert that `PushCallStackFrameForTests` rejects `null` frames and that `ClearCallStackForTests` drains a populated `_executionStack`, while `ProcessorDebuggerTests` drive the Set/Clear breakpoint fallbacks that snap to the nearest `SourceRef` when the requested location misses every span. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~ProcessorTests|FullyQualifiedName~ProcessorDebuggerTests"` ‚úÖ (36 tests, 0.28‚ÄØs). Next pass: rerun `./scripts/coverage/coverage.ps1 -SkipBuild` after we tackle the remaining `YieldSpecialTrap` paths so we can quantify the branch delta for `Execution.VM.Processor`.
    - üîÑ (2025-11-20 04:05 UTC) Added `ProcessorTests` coverage for the `YieldSpecialTrap` branches: new NUnit cases assert the happy-path coroutine yield (now validating the suspended state + yielded scalar), the main-chunk rejection (`Script.DoString("coroutine.yield()")` ‚ûú `attempt to yield from outside a coroutine`), and the synthetic CLR-boundary guard (forcing `_canYield = false` on a coroutine processor so `coroutine.yield` surfaces `attempt to yield across a CLR-call boundary`). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~ProcessorTests"` ‚úÖ (7 tests, 0.15‚ÄØs). `./scripts/coverage/coverage.ps1 -SkipBuild` ‚úÖ (2025-11-20 04:15 UTC) now reports `Execution.VM.Processor` at **92.8‚ÄØ% line / 91.7‚ÄØ% branch / 95.9‚ÄØ% method** and overall interpreter totals at **96.0‚ÄØ% line / 93.1‚ÄØ% branch / 97.9‚ÄØ% method**; the remaining Processor debt is confined to the debugger pause/range guards.
    - üîÑ (2025-11-20 02:26 UTC) Backfilled the remaining Processor helper guards: `ProcessorTests.ExecIncrClonesReadOnlyValueBeforeIncrement` forces the `_valueStack` clone path, paired `PopExecStackAndCheckVStackReturns/Throws` cover both guard outcomes, `_ENV` tests (`SetGlobalSymbolThrowsWhenEnvIsNotTable`, `AssignGenericSymbolRejectsDefaultEnvSymbol`) exercise the global/default-env validation branches, and the new `StackTopToArray*` cases hit both pop/non-pop modes so the stack-to-array helpers finally leave the red list. `dotnet test ‚Ä¶ --filter "FullyQualifiedName~ProcessorTests"` ‚úÖ (15 tests, 0.16‚ÄØs) and `./scripts/coverage/coverage.ps1 -SkipBuild` ‚úÖ (2025-11-20 02:26 UTC) hold NovaSharp.Interpreter at **96.2‚ÄØ% line / 93.4‚ÄØ% branch / 98.2‚ÄØ% method** with `Execution.VM.Processor` at **92.8‚ÄØ% line / 91.7‚ÄØ% branch / 95.9‚ÄØ% method**; debugger pause/range guards remain the final uncovered hot paths.
    - üîÑ (2025-11-20 02:26 UTC) Began lifting `CoreLib.BasicModule` coverage with dedicated NUnit tests (`BasicModuleTests`) covering the argument-null guards, tuple-aware `select('#', ‚Ä¶)` branch, the `tostring` continuation failure, and the `_WARN` execution paths (custom handler, DebugPrint sink, console fallback). `dotnet test ‚Ä¶ --filter "FullyQualifiedName~BasicModuleTests"` ‚úÖ (5 tests, 0.02‚ÄØs). After the refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run (2358 tests), BasicModule reports **96.3‚ÄØ% line / 91.8‚ÄØ% branch / 100‚ÄØ% method** ‚Äî the remaining branch debt is isolated to the Lua-facing tuple-count path (currently unreachable through `CallbackArguments`) and the plan calls for tackling it via integration-style Lua fixtures next.
    - üîÑ (2025-11-20 02:51 UTC) Closed the outstanding debugger pause/range guard by adding `ProcessorDebuggerTests.RuntimeExceptionRefreshesDebuggerWhenSignalRequestsPause`, which drives the `SignalRuntimeException`/`ListenDebugger` flow inside `ProcessingLoop`. `dotnet test ‚Ä¶ --filter "FullyQualifiedName~ProcessorDebuggerTests"` ‚úÖ (29 tests, 0.24‚ÄØs) and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ358 tests) now peg NovaSharp.Interpreter at **96.3‚ÄØ% line / 93.5‚ÄØ% branch / 98.2‚ÄØ% method**, with `Execution.VM.Processor` improved to **94.4‚ÄØ% line / 93.7‚ÄØ% branch / 100‚ÄØ% method**. Remaining Processor debt is limited to the defensive `yield_to_calling_coroutine` fallbacks duplicated across the opcode handlers (see hotspot log for follow-up options).
    - üîÑ (2025-11-19 16:05 UTC) Added `ProcessorDebuggerTests.DebuggerActionQueueSetsByteCodeStepInState` (covers the bytecode step-in action loop) and `ProcessorDebuggerTests.RefreshDebuggerThreadsUsesParentCoroutineStack` (exercises the parent-stack branch inside `RefreshDebuggerThreads`). `./scripts/coverage/coverage.ps1 -SkipBuild` now runs **2‚ÄØ328** Release tests and reports `Execution.VM.Processor` at **91.9‚ÄØ% line / 90.9‚ÄØ% branch / 95.9‚ÄØ% method**, with NovaSharp.Interpreter totals at **95.91‚ÄØ% line / 92.99‚ÄØ% branch / 97.86‚ÄØ% method**. Remaining Processor debt is confined to the debugger loop‚Äôs rarely requested actions plus the coroutine resume/pause guard rails documented in `docs/coverage/coverage-hotspots.md`.
    - üîÑ (2025-11-19 16:27 UTC) Extended the debugger matrix with `ProcessorDebuggerTests.StepOverContinuesWhenLocationChanges`, `StepOutAdvancesWhenStackDepthDrops`, and `StepInContinuesWhenLocationIsNew` so the non-returning `ListenDebugger` branches are now under test, and added `CoroutineLifecycleTests.ForceSuspendedCoroutineResumesWithContextWithoutArguments` to cover the `Resume(ScriptExecutionContext)` forced-yield path alongside the bytecode step-over queue case (`DebuggerActionQueueSetsByteCodeStepOverState`) and `ByteCodeStepOutAdvancesWhenStackDepthDrops`. `./scripts/coverage/coverage.ps1 -SkipBuild` (Release suite **2‚ÄØ334** tests) now reports `Execution.VM.Processor` at **92.1‚ÄØ% line / 91.1‚ÄØ% branch / 95.9‚ÄØ% method** while NovaSharp.Interpreter totals hold at **95.93‚ÄØ% line / 93.02‚ÄØ% branch / 97.86‚ÄØ% method**; the remaining Processor debt is isolated to the debugger loop‚Äôs rarely issued commands and the coroutine guard rails tracked in the hotspot log.
    - üîÑ (2025-11-19 16:48 UTC) Added `ProcessorDebuggerTests.RefreshDebuggerCapturesWatchEvaluationErrors` so `RefreshDebugger` exercises the `WatchItemFromExpression` catch block when dynamic expressions throw. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (Release suite **2‚ÄØ336** tests) now reports `Execution.VM.Processor` at **92.5‚ÄØ% line / 91.1‚ÄØ% branch / 95.9‚ÄØ% method** with NovaSharp.Interpreter totals at **96.0‚ÄØ% line / 93.04‚ÄØ% branch / 97.96‚ÄØ% method**; remaining debt is confined to the debugger loop‚Äôs rarely issued commands (pause during refresh, empty watchlists) plus the coroutine guard rails noted in `docs/coverage/coverage-hotspots.md`.
    - üîÑ (2025-11-19 16:55 UTC) Added `ProcessorDebuggerTests.SetBreakpointForcesStateWhenLocationMatches` and `ClearBreakpointForcesStateWhenLocationMatches` so `ToggleBreakPoint`‚Äôs `state != null` branch (Set/Clear actions) is now under test, alongside the watch-evaluation fallbacks above. `./scripts/coverage/coverage.ps1 -SkipBuild` (Release suite **2‚ÄØ338** tests) keeps `Execution.VM.Processor` at **92.5‚ÄØ% line / 91.1‚ÄØ% branch / 95.9‚ÄØ% method** while NovaSharp.Interpreter totals stay at **96.0‚ÄØ% line / 93.04‚ÄØ% branch / 97.96‚ÄØ% method**; the remaining debt is confined to the debugger loop‚Äôs rarely issued commands (pause during refresh, empty watchlists) plus the coroutine guard rails captured in the hotspot log.
    - üîÑ (2025-11-19 17:08 UTC) Added `ProcessorDebuggerTests.SetBreakpointReturnsFalseWhenSourceHasNoRefs`, covering the `nearest == null` fallback in `ToggleBreakPoint`. `./scripts/coverage/coverage.ps1 -SkipBuild` (Release suite **2‚ÄØ339** tests) keeps `Execution.VM.Processor` at **92.5‚ÄØ% line / 91.1‚ÄØ% branch / 95.9‚ÄØ% method** while NovaSharp.Interpreter totals remain **96.0‚ÄØ% line / 93.05‚ÄØ% branch / 97.96‚ÄØ% method**; remaining debt is limited to the debugger loop‚Äôs rarely issued commands (pause during refresh, empty watchlists) plus the coroutine guard rails cited above.
    - üîÑ (2025-11-19 16:41 UTC) Closed the remaining queue/refresh gaps by adding `ProcessorDebuggerTests.DebuggerActionQueueSetsByteCodeStepOverState`, `ProcessorDebuggerTests.ByteCodeStepOutAdvancesWhenStackDepthDrops`, and `ProcessorDebuggerTests.RefreshDebuggerEvaluatesWatchExpressions`, guaranteeing the watch update pipeline runs through the try/catch path. The refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run (Release suite **2‚ÄØ335** tests) keeps `Execution.VM.Processor` at **92.1‚ÄØ% line / 91.1‚ÄØ% branch / 95.9‚ÄØ% method** while NovaSharp.Interpreter totals hold at **95.94‚ÄØ% line / 93.04‚ÄØ% branch / 97.86‚ÄØ% method**; remaining debt is confined to the rarely issued debugger commands (pause during refresh, empty watchlists) plus the coroutine guard rails noted above.
    - üîÑ (2025-11-19 19:22 UTC) Refactored the LoadModule syntax-error tuple into `LoadModule.GetSyntaxErrorMessage`, added NUnit coverage for both decorated-reader and raw-loader flows plus helper-specific null guards, and reran `./scripts/coverage/coverage.ps1` (Release suite now **2‚ÄØ299** tests). `NovaSharp.Interpreter.CoreLib.LoadModule` sits at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** (26/26 branches) and interpreter totals hold at **95.78‚ÄØ% line / 92.87‚ÄØ% branch / 97.83‚ÄØ% method**, removing LoadModule from the red list while the remaining <95‚ÄØ% focus stays on `MethodMemberDescriptor`, `BinaryOperatorExpression`, `Processor`, and the hardwired descriptors.
    - üîÑ (2025-11-19 12:08 UTC) Added generator-faithful `HardwiredMethodMemberDescriptorTests` that feed `DefaultValue` placeholders through `CalcArgsCount`, proving the decrement path fires when optional arguments are omitted and remains steady when values are explicit. The refreshed `./scripts/coverage/coverage.ps1` run (Release suite **2‚ÄØ301** tests) reports `HardwiredMethodMemberDescriptor` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** and keeps interpreter totals at **95.79‚ÄØ% line / 92.89‚ÄØ% branch / 97.83‚ÄØ% method**, clearing another red-list entry so the focus can shift to `BinaryOperatorExpression`, `Processor`, and the remaining hardwire descriptors still under 95‚ÄØ%.
    - üîÑ (2025-11-19 12:34 UTC) Layered guard-focused coverage onto `BinaryOperatorExpression` by (a) committing malformed operator chains to trigger the ‚ÄúExpression reduction didn't work‚Äù safeguards, (b) forcing `_operator` into unsupported values before compilation, and (c) invoking comparison evaluation with mixed flags so the defensive `DynamicExpressionException` branch executes. The latest `./scripts/coverage/coverage.ps1` run (Release suite **2‚ÄØ305** tests) reports the expression at **98.0‚ÄØ% line / 96.8‚ÄØ% branch / 100‚ÄØ% method** and lifts interpreter totals to **95.81‚ÄØ% line / 93.01‚ÄØ% branch / 97.83‚ÄØ% method**, leaving `Processor` and the remaining hardwire descriptors as the last sub-95‚ÄØ% holdouts.
    - üîÑ (2025-11-19 13:24 UTC) Expanded `ProcessorDebuggerTests` to exercise the bytecode step-over target, step-in/out early-return guards, and the breakpoint toggle fallback, ensuring `ListenDebugger` now has coverage for the pause-request and action-queue branches. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` pass (Release suite **2‚ÄØ311** tests) keeps `Execution.VM.Processor` at **90.8‚ÄØ% line / 90.0‚ÄØ% branch / 95.5‚ÄØ% method** while lifting interpreter totals to **95.88‚ÄØ% line / 93.13‚ÄØ% branch / 97.84‚ÄØ% method**; remaining Processor debt is confined to the rarely-used debugger action paths and coroutine bookkeeping.
    - üîÑ (2025-11-19 09:24 UTC) Added `Units/ProcessorTests` to cover the cross-thread entry guard (forcing `InvalidOperationException` when `CheckThreadAccess` is enabled and a worker thread re-enters the main processor) and the parent coroutine stack bookkeeping (reflection-driven `EnterProcessor`/`LeaveProcessor` asserts `_coroutinesStack` pushes/pops). Behaviour is now locked down even though Coverlet still reports `Processor` at **90.5‚ÄØ% line / 89.6‚ÄØ% branch** because the recycled-constructor/delegation paths remain uninstrumented; interpreter totals hold at **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method** while we line up the next tranche of Processor-specific coverage.
    - üîÑ (2025-11-19 09:24 UTC) Added `Units/ProcessorTests` to cover the cross-thread entry guard (forcing `InvalidOperationException` when `CheckThreadAccess` is enabled and a worker thread re-enters the main processor) and the parent coroutine stack bookkeeping (reflection-driven `EnterProcessor`/`LeaveProcessor` asserts `_coroutinesStack` pushes/pops). Behaviour is now locked down even though Coverlet still reports `Processor` at **90.5‚ÄØ% line / 89.6‚ÄØ% branch** because the recycled-constructor/delegation paths remain uninstrumented; interpreter totals hold at **95.6‚ÄØ% line / 92.6‚ÄØ% branch / 97.8‚ÄØ% method** while we line up the next tranche of Processor-specific coverage.
  - üîÑ (2025-11-16 14:20 UTC) Temporarily defaulted `.github/workflows/tests.yml` back to `COVERAGE_GATING_MODE=monitor` so CI emits warnings while the remaining <95‚ÄØ% interpreter classes are covered; the workflow still honours `vars.COVERAGE_GATING_MODE` for branches that wish to opt into enforcement.
  - ‚úÖ Expanded Hardwire coverage scaffolding: interpreter test suite now references `NovaSharp.Hardwire`, exposes internals via `InternalsVisibleTo`, and adds `HardwireGeneratorRegistryTests`/`HardwireCodeGenerationContextTests` to lock in registry fallbacks, assembly discovery, logging, and visibility gating behaviours ahead of deeper generator coverage pushes.
   - ‚úÖ Added `HardwireParameterDescriptorTests` plus dispatch-focused `HardwireCodeGenerationContextTests` coverage, ensuring ref/out validation, default-parameter metadata, registry error paths, and initialization wiring are exercised so NovaSharp.Hardwire line coverage begins moving off the 22‚ÄØ% floor.
   - ‚úÖ Hardened `scripts/coverage/coverage.ps1` to surface failing builds: logs the full `dotnet build` output, explicitly builds the interpreter test project, and reports actionable messages (including log locations) when the runner DLL is missing or build steps fail.
  - ‚úÖ Backfilled NovaSharp.Hardwire generator coverage by introducing `HardwireGeneratorTests` which verify BuildCodeModel registrations and `AllowInternals` propagation, while adding deterministic registry stubs; interpreter suite now drives Hardwire line coverage to ~29‚ÄØ%.
  - ‚úÖ Extended `HardwireGeneratorTests` to cover ref/out default dispatch, property setter special-names, and static indexer warnings‚Äîverifying both generated source and emitted diagnostics so MethodMemberDescriptorGenerator edge paths stay under regression.
  - ‚úÖ Hardened `HardwireParameterDescriptorTests` to assert default-value placeholders emit `DefaultValue` instances, keeping `HardwiredDescriptors.DefaultValue` under coverage.
  - ‚úÖ (2025-11-22 15:40 UTC) Added `ArrayMemberDescriptorGeneratorTests` to exercise the CodeDOM output for array members (name/setter wiring and parameter descriptor arrays). The new tests inspect the generated nested type and constructor arguments, bumping `NovaSharp.Hardwire.Generators.ArrayMemberDescriptorGenerator` coverage off the 4‚ÄØ% floor and nudging overall Hardwire line coverage upward. Verified via `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ArrayMemberDescriptorGeneratorTests`.
  - üîú Next: mirror the Array-member coverage for `StandardUserDataDescriptorGenerator` and `MethodMemberDescriptorGenerator` by validating the generated CodeDOM emits the correct AddMember/AddMetaMember calls, default-argument scaffolding, and AllowInternals plumbing. Once these suites land, rerun `./scripts/coverage/coverage.ps1` to capture the Hardwire coverage delta and keep `docs/coverage/coverage-hotspots.md` aligned.
   - ‚úÖ Added `StandardUserDataDescriptorGeneratorTests` to verify member/meta-member wiring so `StandardUserDataDescriptorGenerator` emits `AddMember`/`AddMetaMember` calls with the expected descriptors.
   - ‚úÖ Added Lua `io.read("*n")` edge-case coverage (exponent-only tokens, hex literals, exponent overflow) with NUnit scenarios now skipped pending parity; documented the gap in `docs/LuaCompatibility.md` to highlight the remaining divergence from Lua 5.4.8 parsing rules.
   - Resolve uncovered behaviours by shipping production fixes when necessary; correctness improvements take priority over keeping the existing implementation untouched.
   - ‚úÖ Stand up a Red/Green tracking doc (`docs/coverage/coverage-hotspots.md`) that enumerates interpreter hotspots still below 90‚ÄØ% with provisional owners.
   - üîù Drive `NovaSharp.Interpreter` coverage to ‚â•95‚ÄØ% line / ‚â•95‚ÄØ% branch / ‚â•95‚ÄØ% method by iterating on the red-list in `docs/coverage/coverage-hotspots.md`; treat any class below that threshold as a release blocker.
    - üîÑ Added dedicated unit suites for `UnaryOperatorExpression` and `BinaryOperatorExpression`, pushing their coverage to **100‚ÄØ%** and **87‚ÄØ%** line respectively and clearing previously untested Eval branches.
    - üîÑ (2025-11-14) Added `OverloadedMethodMemberDescriptorTests` to stress cache reuse (userdata + primitive signatures), extension method snapshots (enabled vs. ignored), varargs scoring, callback/value accessors, wiring serialization, optimizer delegation, and failure paths; `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~OverloadedMethodMemberDescriptorTests"` keeps the new scenarios green, lifting the descriptor to **82.2‚ÄØ%** line / **92.2‚ÄØ%** branch / **78.2‚ÄØ%** method coverage with follow-up work remaining for cache overflow and additional scoring branches.
    - üîÑ (2025-11-14) Expanded those tests with reflection helpers so we now execute the cache-overflow guard, varargs exact-match scoring, empty-varargs weighting, enumerable constructor, extension-method refresh, non-wireable wiring output, and `IsStatic` property paths. Coverage still reports **82.2‚ÄØ%** line because the remaining uncovered statements are either trivially inlined (IEnumerable ctor, `get_IsStatic`) or defensive code that never triggers (`_cache.Length == 0`, by-design `PrepareForWiring` fallbacks). Logged the outstanding lines (94-97, 141, 270-277, 415-436, 529-533, 552, 585-586, 613-618) so the modernization effort can either delete them or mark them `Debug.Assert` when we refactor the descriptor.
    - üîÑ (2025-11-15) Reintroduced the richer `OverloadedMethodMemberDescriptorTests` with typed `GetInstanceMethod`/`GetStaticMethod` helpers and explicit callback delegates so IDE0008 analyzers stay quiet, refreshed expectations around `GetValue` (returns `DataType.ClrFunction`) and codified the current scoring behaviour in `ExecutePrefersExactMatchOverVarArgsWhenPenaltiesApply` (extra-arg malus still outweighs the varargs bonus‚Äîfollow-up noted to revisit the heuristic). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~OverloadedMethodMemberDescriptorTests"` is green again.
    - üîÑ (2025-11-15) Extended `LuaStateInteropToolsTests` (Lua 5.4 Manual ¬ß6.4 String Manipulation) with coverage for explicit parameter indexes, `'` thousands-grouping, `%h`/`%l` length modifiers, string precision truncation, `%c` string inputs, and the fallback path for unsupported specifiers so `LuaStateInterop.Tools` finally exercises the padding/flag combinations that were still red. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~LuaStateInteropToolsTests"` now covers the remaining branches before we tackle the CLI-facing Lua formatting helpers.
    - üîÑ (2025-11-15) Added regression tests for `%#08X`, `%#o` with zero, and `%+06d` to hit the right-align/alternate branches inside `FormatHex`, `FormatOct`, and `FormatNumber`. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~LuaStateInteropToolsTests"` stays green and `LuaStateInterop.Tools` line coverage now reports **77.6‚ÄØ%**.
    - üîÑ (2025-11-15 20:27 UTC) Added `Units/CustomConverterRegistryTests` to cover duplicate registration/replacement, removal, typed + obsolete CLR bridge overloads, and `Clear`, and tightened `CustomConverterRegistry` so DataTypes ‚â• `MAX_CONVERTIBLE_TYPES` short-circuit instead of indexing past the backing arrays. `ScriptToClrConversionsTests` now drive optional parameter defaults, numeric/string coercions, callback delegates, table conversions, userdata string fallbacks, and weighting logic so `ScriptToClrConversions` rises to **82.0‚ÄØ% line / 80.3‚ÄØ% branch / 100‚ÄØ% method** (was 72.8‚ÄØ%). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~CustomConverterRegistryTests"` / `--filter "FullyQualifiedName~ScriptToClrConversionsTests"` plus `./scripts/coverage/coverage.ps1` now report `CustomConverterRegistry` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, interpreter totals at **91.3‚ÄØ% line / 87.7‚ÄØ% branch / 93.5‚ÄØ% method**, and the Release suite at **1‚ÄØ776** tests.
    - üîÑ (2025-11-18 19:39 UTC) Expanded `LoadModuleTests` with coverage for the string-chunk path (`load('return value', 'chunk-string')`), type/reader validation (`load(true)`, non-string yields), syntax-error tuples, explicit `loadfile(..., env)` execution, and both branches of `LoadModule.NovaSharpInit`. Fixed the lingering inconsistent accessibility in `BinaryOperatorExpressionTests` so the Release suite builds again, then reran `./scripts/coverage/coverage.ps1 -SkipBuild` to capture the uplift (`NovaSharp.Interpreter` now reports **95.39‚ÄØ% line / 92.30‚ÄØ% branch / 97.63‚ÄØ% method** with **2‚ÄØ224** tests; `CoreLib.LoadModule` sits at **91.3‚ÄØ% line / 76.9‚ÄØ% branch / 100‚ÄØ% method** with all 10 methods executing). Remaining branch gaps are the loader fallback/error combinations called out in `docs/coverage/coverage-hotspots.md`.
    - üîÑ (2025-11-18 19:58 UTC) Reworked `LoadCompilesStringChunksAndUsesProvidedSourceName` to drive the `Script.LoadString` C# surface directly, asserting the injected environment result (`321`) and forcing a `ScriptRuntimeException` whose decorated message references the supplied chunk name. A fresh `./scripts/coverage/coverage.ps1 -SkipBuild` pass (2‚ÄØ240 tests) now reports `CoreLib.LoadModule` at **100‚ÄØ% line / 92.3‚ÄØ% branch / 100‚ÄØ% method** (24/26 branches) and `NovaSharp.Interpreter` totals at **95.47‚ÄØ% line / 92.48‚ÄØ% branch / 97.63‚ÄØ% method**. The only remaining LoadModule branch debt is the defensive loader fallback inside `__require_clr_impl` (module unresolved after custom resolvers) plus the Lua-side `package.loaded` defaulting to `true`.
    - üîÑ (2025-11-18 20:28 UTC) Landed the first dedicated `ByteCodeTests` suite (`src/tests/NovaSharp.Interpreter.Tests/Units/ByteCodeTests.cs`) to exercise SourceRef stacking, the `Dump` formatter, comparison/operator normalisation, name/list indexers, global/local/upvalue load/store paths, scope-frame serialisation, and table-initialiser last-position flags. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ261 tests) now shows `Execution.VM.ByteCode` at **95.5‚ÄØ% line / 77.7‚ÄØ% branch / 95.6‚ÄØ% method** (276/289 lines, 28/36 branches). Remaining branch debt is isolated to the intentionally defensive fallbacks (`Emit_Load`/`Emit_Store` with `SymbolRefType.DefaultEnv` and the error-only `Emit_Index*` branches), which stay on the hotspot list until we either remove the dead code or add synthetic symbol fixtures to assert the thrown exceptions.
    - üîÑ (2025-11-15 20:52 UTC) Added `Units/EnumerableWrapperTests` covering iterator tuples, `__call` progression, nil-skipping, enumerator reset guards, table-backed enumerables, and the exposed `Current`/`MoveNext`/`Reset` userdata members. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~EnumerableWrapperTests"` plus `./scripts/coverage/coverage.ps1` now report `EnumerableWrapper` at **95.2‚ÄØ% line / 88.4‚ÄØ% branch / 88.8‚ÄØ% method**, pushing interpreter totals to **91.35‚ÄØ% line / 87.84‚ÄØ% branch / 93.61‚ÄØ% method** across **1‚ÄØ780** Release tests and removing the wrapper from the priority red list.
    - üîÑ (2025-11-15 21:17 UTC) Added `Units/BreakStatementTests` exercising the parser/VM guard rails (`break` outside loops, `break` inside standalone functions, and `break` nested inside functions defined within loops) so the `LoopTracker` boundary logic now has direct regression coverage. `dotnet test ... --filter "FullyQualifiedName~BreakStatementTests"` plus `./scripts/coverage/coverage.ps1` report `BreakStatement` at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, with interpreter totals holding at **91.39‚ÄØ% line / 87.85‚ÄØ% branch / 93.61‚ÄØ% method** across **1‚ÄØ783** Release tests.
    - üîÑ (2025-11-15 21:26 UTC) Added `Units/ProxyUserDataDescriptorTests` to validate proxy creation for `Index`/`SetIndex`/`MetaIndex`/`AsString`, friendly-name plumbing, null-instance passthrough, and `IsTypeCompatible` behaviour. `dotnet test ... --filter "FullyQualifiedName~ProxyUserDataDescriptorTests"` plus the refreshed coverage run now report the descriptor at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** and interpreter totals at **91.42‚ÄØ% line / 87.87‚ÄØ% branch / 93.81‚ÄØ% method** across **1‚ÄØ791** Release tests.
    - üîÑ (2025-11-16 07:40 UTC) Extended `ScriptToClrConversionsTests` with table‚Üídictionary conversions (generic + object), tuple fall-through validation, empty-string char coercion failures, and table-to-dictionary weighting assertions. Coverage run `./scripts/coverage/coverage.ps1` now records `ScriptToClrConversions` at **82.0‚ÄØ% line / 80.3‚ÄØ% branch / 100‚ÄØ% method** (still below the 90‚ÄØ% gate but with the new edge cases locked in) and overall interpreter totals at **91.44‚ÄØ% line / 87.95‚ÄØ% branch / 93.81‚ÄØ% method** across **1‚ÄØ796** Release tests.
    - üîÑ (2025-11-16 07:56 UTC) Backfilled the remaining `ScriptToClrConversions` gaps by exercising `DynValueToObject` (custom converter wins, void/nil fallbacks, closure/table/tuple returns, descriptor-only userdata, callback propagation, unsupported throws), adding explicit script/CLR-function conversions (closure + delegate bridges, callback-function round-trips, optional-nil defaults), and covering the matching weight helpers. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~ScriptToClrConversionsTests"` plus `./scripts/coverage/coverage.ps1` now report `ScriptToClrConversions` at **99.4‚ÄØ% line / 98.8‚ÄØ% branch / 100‚ÄØ% method** and overall interpreter coverage at **91.67‚ÄØ% line / 88.37‚ÄØ% branch / 93.81‚ÄØ% method** with **1‚ÄØ821** Release tests (interpreter red list is currently empty).
    - üîÑ (2025-11-16 17:25 UTC) Unblocked `LuaBaseTests` discovery by adding the missing `NovaSharp.Interpreter.Errors` import, replacing the implicit tuple array with an explicit `(DynValue Value, int Expected)[]`, and fixing the coroutine factory literal so `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~LuaBaseTests"` now executes all six fixtures. Exercising the nil-padding scenario exposed a production bug (`LuaBase.LuaCall` never incremented `copied` while filling out the requested result slots), so the loop now advances after each `DynValue.Nil` push instead of allocating until OOM. `./scripts/coverage/coverage.ps1 -SkipBuild` reports NovaSharp.Interpreter at **93.15‚ÄØ% line / 89.73‚ÄØ% branch / 95.26‚ÄØ% method** across **1‚ÄØ958** Release tests, with `LuaStateInterop.LuaBase` up to **91.3‚ÄØ% line / 88.3‚ÄØ% branch / 81.1‚ÄØ% method** and both the MULTRET and nil-padding behaviours locked down.
    - üîÑ (2025-11-16 17:48 UTC) Expanded `LuaBaseTests` with paired suites so every synthetic scenario now has a native Lua twin. (a) loops in `LuaStringHelpersExposeRawStringValues`, `LuaIntegerChecksValidateNumbers`, `LuaArgCheckThrowsWhenConditionFails`, `LuaGetTableReturnsRawValuesAndThrowsOnNonTables`, and `LuaCallSupportsMultiReturnAndNilPadding` iterate across both handcrafted `DynValue` inputs and values returned from real Lua code (including coroutine threads); (b) `LuaTypeHandles‚Ä¶` + `LuaTypeClassifiesValuesProducedByLuaScripts` prove Lua-produced values match the synthetic expectations; and (c) the stack/buffer helper suite replays the same assertions for Lua-returned strings. `LuaTypeRejectsSyntheticTailCallYieldAndTupleRequests` still relies on `DynValue.NewTailCallReq/NewYieldReq` (Lua collapses those request nodes inside the VM before managed code can observe them), but now includes a Lua multi-return tuple to keep the guard documented. Interpreter coverage holds at **93.15‚ÄØ% line / 89.73‚ÄØ% branch / 95.26‚ÄØ% method**.
    - üîÑ (2025-11-16 15:12 UTC) Added `Units/InstructionFieldUsageExtensionsTests` to enumerate every opcode bucket inside `InstructionFieldUsageExtensions.GetFieldUsage` (default no-op, tuple/symbol combos, jump offsets, closure metadata, meta/name branches). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~InstructionFieldUsageExtensionsTests"` hits all 17 paths, and the refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run pushes `NovaSharp.Interpreter.Execution.InstructionFieldUsageExtensions` to **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**. Interpreter totals now sit at **92.93‚ÄØ% line / 89.44‚ÄØ% branch / 94.97‚ÄØ% method** across **1‚ÄØ940** Release tests, with artefacts updated under `docs/coverage/latest`.
    - üîÑ (2025-11-16 15:28 UTC) Backfilled `FunctionCallExpression` by introducing `Units/FunctionCallExpressionTests` (paren vs. string vs. table arguments, colon/`this` calls, and premature-stream errors). `dotnet test ... --filter "FullyQualifiedName~FunctionCallExpressionTests"` plus the latest `./scripts/coverage/coverage.ps1 -SkipBuild` pass now report `NovaSharp.Interpreter.Tree.Expressions.FunctionCallExpression` at **98.2‚ÄØ% line / 95.4‚ÄØ% branch / 75‚ÄØ% method** (call/constructor paths fully exercised), nudging interpreter totals to **93.0‚ÄØ% line / 89.47‚ÄØ% branch / 94.97‚ÄØ% method** across **1‚ÄØ945** Release tests and updating `docs/coverage/latest`.
    - üîÑ (2025-11-16 15:38 UTC) Added `Units/PlatformAutoDetectorTests` covering Unity flag detection via a dynamically emitted `UnityEngine.*` type, explicit Unity overrides, and the cached `IsRunningOnAot` probe path (including the cached/catch branch trigger through a forced reflection override). Coverage run `./scripts/coverage/coverage.ps1 -SkipBuild` now reports `NovaSharp.Interpreter.Platforms.PlatformAutoDetector` at **91.1‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method** (catch path remains unreachable without an actual AOT runtime), with interpreter totals steady at **93.02‚ÄØ% line / 89.51‚ÄØ% branch / 95.02‚ÄØ% method** across **1‚ÄØ948** Release tests; hotspots doc updated accordingly.
    - üîÑ (2025-11-16 16:07 UTC) Extended `PlatformAccessorBaseTests` with Unity DLL-mono/unknown suffix scenarios, a dotnet fallback guard, and a dedicated `BaseDefaultInputAccessor` to exercise the base `DefaultInput` implementation. `dotnet test ... --filter "FullyQualifiedName~PlatformAccessorBaseTests"` plus the refreshed `./scripts/coverage/coverage.ps1 -SkipBuild` run keeps `NovaSharp.Interpreter.Platforms.PlatformAccessorBase` at **84‚ÄØ% line / 78.5‚ÄØ% branch** (Release inlines the `return null` fast path, so those sequence points remain dark), but every suffix/input branch now has explicit regression coverage documented under `docs/coverage/latest`.
    - üîÑ (2025-11-15) Hardened `UnityAssetsScriptLoaderTests` (no Unity stubs required) to validate path normalization (forward + backslashes), dictionary snapshotting, and the helpful missing-resource exception guidance so Unity consumers have regression coverage without tripping the default platform detector. Still need to follow up with true reflection tests in a Unity host once we stand up platform-specific harnesses. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~UnityAssetsScriptLoaderTests"` stays green.
    - üîÑ (2025-11-15) Added `UserDataTests` to exercise the custom descriptor registration paths, registered-type history, proxy registration, extension-method registry change version, base-type/interface fallback logic in `TypeDescriptorRegistry`, equality semantics (matching descriptors, static userdata, null/instance mixes), and `Create(Type)` static handling, so `NovaSharp.Interpreter.DataTypes.UserData` now covers the descriptor cache/hardwire toggles called out in `docs/coverage/coverage-hotspots.md`. Verified with `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~UserDataTests"`.
    - üîÑ (2025-11-15) `UserDataTests` now also registers an `IUserDataType` implementation to verify the auto-describing descriptor path (generation via `IGeneratorUserDataDescriptor`), covering the polymorphic branch in `TypeDescriptorRegistry`. `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --no-build --filter "FullyQualifiedName~UserDataTests"` + `--filter "FullyQualifiedName~AutoDescribingUserDataDescriptorTests"` remain green.
    - üîÑ (2025-11-14) Extended `BinaryOperatorExpressionTests` with string comparison/equality edge cases, a `CreatePowerExpression` regression, and compile-time opcode mapping (arithmetic, concatenation, comparison, `~=`, inversion guards). `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter "FullyQualifiedName~BinaryOperatorExpressionTests"` passes, exercising `OperatorToOpCode`, `ShouldInvertBoolean`, and the remaining Eval branches so the class can climb past the 90‚ÄØ% line gate next coverage sweep.
   - Expand NUnit suites (parser, metatables, IO/OS TAP replacements) until nightly coverage reports consistently exceed 90‚ÄØ% line/branch for `NovaSharp.Interpreter`, `NovaSharp.Cli`, and `NovaSharp.Hardwire`.
   - ‚úÖ Added `ParserTests` coverage for hex float literals, Unicode escape decoding, and decimal-escape guardrails so `LexerUtils` error surfaces stay exercised and decorated messages reference the offending token.
   - ‚úÖ Expanded `MetatableTests` to cover callable tables, custom `__pairs` iterators, and protected metatable failures under `CoreModules.PresetComplete`, ensuring metamethod regressions are caught without relying on TAP fixtures.
   - ‚úÖ Raised the coverage gate to 90‚ÄØ% and flipped `.github/workflows/tests.yml` to enforce failures when Summary.json reports line coverage below the threshold (still overridable via `COVERAGE_GATING_MODE` repo vars).
   - ‚úÖ Ported CLI shell REPL loop tests (command dispatch, evaluation output, interpreter/general exception handling) so interactive pathways run under NUnit with redirected console input.
  - ‚úÖ Hardened CLI coverage across `Program`, `CommandManager`, `Run`, `Register`, `Compile`, `Debug`, `Help`, and `HardWire` commands; Release suite at 687 tests after deterministic hardwire + help harnesses.
  - ‚úÖ Added Lua-level regression tests for `os.time`, `os.difftime`, and `os.date` (string + table forms), covering missing-field errors and placeholder week specifiers; Release suite climbs to 701 tests.
  - ‚úÖ Added math module regression tests hitting logarithms (default/custom base), power, modf, min/max aggregators, ldexp, deterministic random sequences, and NaN/overflow behaviors.
  - ‚úÖ Replaced `LinqHelpers` LINQ usage with allocation-free iterators and backed the helpers with unit tests to unblock future analyzer enforcement around `System.Linq` usage in hot paths.
  - ‚úÖ Added `UnityAssetsScriptLoader` unit tests using an in-memory resource map, covering path trimming, not-found errors, existence checks, and loaded-script enumeration without relying on Unity runtime types.
  - ‚úÖ Implemented root-scope `<close>` handling by seeding to-be-closed tracking in `Processor.ExecBeginFn` and rerunning the Release interpreter suite (1336 pass / 2 skip) to validate the change.
  - ‚úÖ Mirrored Lua TAP `io.read` number cases by extending `FileUserDataBase.ReadNumber` (hex floats, huge exponents) and activating NUnit coverage in `IoModuleTests`.
  - ‚úÖ Introduced `LuaCompatibilityVersion` plumbing (global + per-script options) so callers can pin interpreter behaviour to Lua 5.5/5.4/5.3/5.2 or stay on the rolling `Latest` target.
  - ‚úÖ Captured a naming audit (`docs/style/naming-audit.md`) covering `Emit_*` helpers and `i_` prefixed members to guide the upcoming renaming pass.
  - ‚úÖ Normalized enum declarations: every enum now starts with an obsolete `None`/`Unknown` at value 0, all subsequent values are explicit (flags use `1 << n`), and call sites favor defaults over obsolete sentinels to avoid new warnings.
  - ‚úÖ **Harvest real-world Lua suites.**
    - Added `json.lua` (rxi, v0.1.2) and `inspect.lua` (kikito, v3.1.0) under `src/tests/NovaSharp.Interpreter.Tests/Fixtures/RealWorld`, preserving upstream MIT licenses.
    - Introduced `RealWorldScriptTests` to load the fixtures via `Script.DoString`, exercising JSON encode/decode and table inspection scenarios to guard against regressions.
    - Refreshed `docs/testing/real-world-scripts.md` and `docs/ThirdPartyLicenses.md` with provenance metadata, paths, and maintenance guidance for future corpus growth.
  - ‚úÖ **Feature coverage checklist.**
    - Added a sectioned Lua 5.4 parity matrix to `docs/LuaCompatibility.md`, covering syntax, standard libraries, metatables/GC, and coroutine semantics with status, coverage links, and owners.
    - Highlighted gaps for `<close>` variables, weak/ephemeron tables, string pack/unpack, IO hex parsing, and GC modes so they flow into runtime modernization follow-ups.
    - Documented observability actions (enabling disabled TAP suites, filing issues for ‚ùå entries) to keep parity efforts actionable.
    - **Golden rule:** when a regression test fails, assume the production implementation is wrong until proven otherwise. Review the official Lua 5.4 reference manual (`https://www.lua.org/manual/5.4/`) to confirm expected behavior, and prioritize fixes that bring NovaSharp back to Lua 5.4 compliance rather than weakening or deleting tests.
  - ‚úÖ Verified `NovaSharpHideMemberAttribute` hides methods/properties (including inherited members) by registering sample userdata and asserting scripts only see the intended surface.
  - ‚úÖ Added coverage for `FastStackDynamic<T>` operations, REPL module path resolution (environment + `LUA_PATH` overrides), `CoreLib.IO.BinaryEncoding` round-trips, and hardwired descriptor metadata checks to prep Roslyn parity.
  - ‚úÖ Added guardrail tests around `InvalidScriptLoader` failure paths to keep runtime diagnostics stable when custom loaders plug in.
   - ‚úÖ Exercised hardwired member/method descriptors via targeted hardwired userdata tests (read/write gating, optional-argument marshalling, static access guards), removing the zero-coverage gap from the excluded auto-generated harness.
   - ‚úÖ Expanded `ReflectionSpecialName` unit coverage to map every operator/event/indexer branch (true/false, unary/binary symbols, namespaced members), ensuring the helper enum conversion stays under regression.
   - üîÑ New: bake "extreme path" coverage into every milestone‚Äîadd tests for undersized buffers, null inputs, unexpected/malformed data, multiple/simultaneous control-flow exits (`break`, `goto`, nested functions), and other non-happy paths (e.g., BinaryEncoding invalid arrays). Track gaps per hotspot and refuse closure until happy + edge paths are both covered. BreakStatement now has dedicated coverage for loop boundaries, nested functions, and multiple `break` points to model the expected depth for other interpreter operations.
     - ‚úÖ Extended `BinaryEncodingTests` with offset/zero-count/destination-null cases so every guard path in `ValidateDestination`/`ValidateBufferRange` now executes under NUnit.
   - ‚úÖ Expanded `DebugModule` coverage to include CLR function upvalue handling, invalid `upvaluejoin` indices, non-string traceback messages, and coroutine/thread traces; edge-path assertions now guard previously untested branches.
   - ‚úÖ Covered `pcall`/`xpcall` CLR edge paths (tail-call continuations, yield requests, handler-before-unwind decoration) so `ErrorHandlingModule` red-list gaps now assert both happy and unhappy flows.
   - ‚úÖ Exercised `pcall`/`xpcall` tail-call forwarding, argument propagation, and CLR handler success paths; rerun `scripts/coverage/coverage.ps1` to capture the >90‚ÄØ% lift for `ErrorHandlingModule`.
   - ‚úÖ Exercised `HardwiredMemberDescriptor` default getter/setter implementations so the base-path exceptions are now under coverage; only the by-ref conversion scenarios remain red-listed.
   - ‚úÖ Added parameterised coverage for `ReflectionSpecialName` arithmetic/relational operator mappings; refreshed coverage now reports 95.8‚ÄØ% line / 100‚ÄØ% branch so the class exits the red list.
   - ‚úÖ Covered `DynValueMemberDescriptor` getters, CLR function execution flags, setter guard, and wiring fallbacks (primitive/table/userdata/unsupported) to lift the descriptor from 17‚ÄØ% to double-digit green coverage.
   - ‚úÖ Stream file coverage now includes signed exponent parsing, standalone-sign rewinds, numeric byte-count EOF, and invalid option guards; `StreamFileUserDataBase` sits at 83‚ÄØ% line / 82‚ÄØ% branch after the latest `StreamFileUserDataBaseTests`.
   - ‚úÖ `Slice<T>` gained focused coverage (enumeration, reversed views, copy semantics, read-only guards) pulling it out of the low-coverage bucket while validating exception surfaces.
    - ‚úÖ Exercised `debug.debug` interactive edge paths (return values, CLR exception surfaces, whitespace/no-op input, null provider) to chip away at the remaining `DebugModule` debt; rerun `scripts/coverage/coverage.ps1` to capture the new lines and confirm the 91‚ÄØ% / 78‚ÄØ% snapshot.
    - ‚úÖ Hardened `OsTimeModule` against edge inputs (missing month/year fields, pre-epoch timestamps, invalid specifiers, escape sequences) and verified `os.clock` monotonic behaviour; Release suite holds at 990 tests (2025-11-12).
    - ‚úÖ Covered `DebuggerAction` constructor/timestamp, aging behaviour, defensive line storage, and breakpoint formatting so debugger actions exit the red list; interpreter Release suite at 1001 tests (2025-11-12).
    - ‚úÖ Composite user-data aggregation now covered end-to-end (index, set, meta, metadata) via `CompositeUserDataDescriptorTests`, lifting coverage above 92‚ÄØ% and pushing the Release suite to 1008 tests (2025-11-12).
    - ‚úÖ Added `UndisposableStreamTests` to assert dispose/close suppression, synchronous/asynchronous forwarding, timeout propagation, and metadata passthrough; interpreter suite now totals 1019 tests with `UndisposableStream` at 94‚ÄØ% line coverage (2025-11-12).
    - ‚úÖ `LuaStateInteropToolsTests` cover numeric detection, rounding, meta-character decoding, and representative `sprintf` flag combinations, pushing `LuaStateInterop.Tools` beyond 90‚ÄØ% line coverage (2025-11-12).
    - ‚úÖ `PlatformAccessorBaseTests` toggle detector flags to verify mono/unity suffixes, portable/AOT annotations, and default input bridging; Release suite now reports 1023 tests (2025-11-12).
    - ‚úÖ Unary operator suite now exercises runtime error paths (unexpected operator evaluation) in addition to happy-path negation/length/logical cases; bytecode guardrails remain green with compile-time invalid operator assertions.
    - ‚úÖ Event facade + descriptor coverage now exercises static events, duplicate-removal guardrails, and unknown-handler removals; `TestHelpers.CreateExecutionContext` now calls `Script.CreateDynamicExecutionContext()` so the unit suite avoids reflection. Interpreter suite climbs to 1‚ÄØ038 tests after the new cases (2025-11-13).
    - ‚úÖ Scheduled the repo-wide reflection/`nameof` audit: captured current usages in `docs/modernization/reflection-audit.md` and linked the policy in `AGENTS.md` so future changes document additions before implementation.
   - ‚úÖ Plan the test-suite reorg: drafted `docs/testing/test-suite-reorg-proposal.md` outlining the target folder hierarchy, namespace conventions, migration steps, and open questions for maintainer review.
   - ‚úÖ Added `HardwiredDescriptorTests` covering member read/write conversions and method argument marshalling/defaults, pairing with existing `PermanentRegistrationPolicy` tests to clear the interop red-list backlog; rerun `scripts/coverage/coverage.ps1` to confirm instrumentation reflects the new lines.
   - ‚úÖ Extended `OsSystemModule` edge-path coverage (non-zero exits, missing files, move/delete failures, locale placeholder) capturing 98‚ÄØ% line coverage; runtime red list now narrowed to `DebugModule` interactive paths.
   - ‚úÖ Added injectable console hooks + regression tests for `debug.debug`, enabling automated coverage of command execution, error reporting, and queued returns.
 - ‚úÖ Drove `FileUserDataBase`/`StreamFileUserDataBase` coverage by stubbing stream failures (seek/flush/setvbuf) and verifying IO module fallbacks.
 - üîù **Raise NovaSharp.Interpreter coverage to ‚â•95‚ÄØ% line / branch / method.**  
   - üîÑ (2025-11-23 10:20 UTC) Expanded `ModManifestTests` with stream-null guards, whitespace/unsupported `luaCompatibility` inputs (including the digit-free branch), `TryParse` success/failure cases, and host-default warning scenarios so every branch in `ModManifest.Parse/Load/TryParse/ApplyCompatibility` now executes under NUnit. Ran `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter ModManifestTests` (16 tests) followed by `./scripts/coverage/coverage.ps1 -SkipBuild` (**2‚ÄØ765** Release tests) to refresh artefacts: `NovaSharp.Interpreter.Modding.ModManifest` now reports **100‚ÄØ% line / 97.0‚ÄØ% branch / 100‚ÄØ% method** coverage (up from **76.4‚ÄØ% / 67.6‚ÄØ% / 88.8‚ÄØ%**), and interpreter totals hold at **96.26‚ÄØ% line / 93.17‚ÄØ% branch / 98.64‚ÄØ% method**.
   - Identify remaining gap areas (e.g., coroutine corner cases, Lua 5.4 features, IO/OS modules) via the latest `scripts/coverage/coverage.ps1` HTML dashboards.
    - Prioritize unit/integration tests that close the gaps without brittle assertions; update TAP fixtures where feasible.
    - Treat this as blocking before moving on to broader allocation/interop work; track progress weekly in `docs/coverage/coverage-hotspots.md`.
    - üîÑ (2025-11-16 20:14 UTC) Landed `Units/PropertyMemberDescriptorTests` (attribute-driven visibility overrides, lazy/static optimization, metadata wiring) and new `ReflectionSpecialNamesTests` equality/hash coverage, then patched `PropertyTableAssigner.SetSubassignerForType` so removing a subassigner falls back to CLR conversions instead of dereferencing `null`. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run executes **2‚ÄØ019** Release tests, reports `ReflectionSpecialName` at **100‚ÄØ% line / 99.2‚ÄØ% branch / 100‚ÄØ% method**, `PropertyMemberDescriptor` up to **87.1‚ÄØ% line / 91.1‚ÄØ% branch / 94.1‚ÄØ% method** (still on the red list but no longer untested), `PropertyTableAssigner` at **96.9‚ÄØ% line / 98.0‚ÄØ% branch**, and overall interpreter coverage at **93.7‚ÄØ% line / 90.3‚ÄØ% branch / 96.2‚ÄØ% method**.
    - üîÑ (2025-11-16 21:20 UTC) Broadened `Units/StandardEnumUserDataDescriptorTests` with signed/unsigned XOR + NOT permutations, `hasAll`/`hasAny` boolean assertions, argument-count failures, and cross-descriptor mismatch guards, then rebuilt in Release so coverlet sees the new fixtures. `StandardEnumUserDataDescriptor` now reports **95.0‚ÄØ% line / 96.6‚ÄØ% branch / 100‚ÄØ% method**, retiring it from the red list and nudging interpreter totals to **93.8‚ÄØ% line / 90.4‚ÄØ% branch / 96.2‚ÄØ% method** across **2‚ÄØ029** Release tests.
    - üîÑ (2025-11-16 21:41 UTC) Added `Units/DebugServiceTests` to capture `SourceCode` notifications and call `DebugService.ResetBreakPoints` directly, proving it delegates to the `Processor` and surfaces `OwnerScript`. `DebugService` now reports **100‚ÄØ% line / 100‚ÄØ% method** (up from **83‚ÄØ% / 66‚ÄØ%**), leaving the red list and nudging interpreter totals to **93.9‚ÄØ% line / 90.4‚ÄØ% branch / 96.3‚ÄØ% method** across **2‚ÄØ030** Release tests.
   - üîÑ (2025-11-17 10:01 UTC) Expanded `Units/TableTests` to cover constructor array initialization, `Table.Clear`, the object/object[] setters, nested removal, raw-get overloads, additional `Remove` paths, and the `Keys` iterator. Behaviour is now exercised end-to-end even though instrumentation still reports **85.8‚ÄØ% line / 81.9‚ÄØ% branch** for `Table`, so the class remains on the red list while we target `PerformTableSet` and length-cache invalidation. Interpreter totals now sit at **94.1‚ÄØ% line / 90.6‚ÄØ% branch / 96.6‚ÄØ% method** across **2‚ÄØ039** Release tests.
   - üîÑ (2025-11-17 10:40 UTC) Landed a second tranche of coverage for `Table` (boxed string/int/`DynValue` removals, fractional-number keys, `Set(object[])` null/empty guards, and raw-get fallbacks) plus `ReplInterpreterScriptLoader` (`NovaSharp_PATH` whitespace ignore + explicit `LUA_PATH` miss). The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (still warning about `NovaSharp.Cli.dll` being ‚Äúin use‚Äù before retrying) records overall **84.9‚ÄØ% line / 84.7‚ÄØ% branch / 87.5‚ÄØ% method** coverage with `NovaSharp.Interpreter` holding at **94.0‚ÄØ% line / 90.6‚ÄØ% branch / 96.6‚ÄØ% method** across **2‚ÄØ039** Release tests. `Table` line coverage is now >=95‚ÄØ%, but branch coverage remains **86.8‚ÄØ%** because `ResolveMultipleKeys` and iterator continuations still have untouched combinations. `ReplInterpreterScriptLoader` tests now assert the whitespace/env precedence and null-return semantics, yet OpenCover continues to flag lines 39/48/77 as unvisited, so we may need to refactor the constructor into helper methods to expose those branches explicitly.
   - üîÑ (2025-11-17 11:05 UTC) Locked down the flakey REPL loader fixture by marking it `[NonParallelizable]`, added `RuntimeScopeFrameTests` to cover the debug-symbol bookkeeping, and reran `./scripts/coverage/coverage.ps1 -SkipBuild`. The latest run (2‚ÄØ058 tests) lands at **85.0‚ÄØ% line / 84.9‚ÄØ% branch / 87.5‚ÄØ% method** overall with `NovaSharp.Interpreter` at **94.1‚ÄØ% line / 90.8‚ÄØ% branch / 96.7‚ÄØ% method**. `RuntimeScopeFrame` now reports **100‚ÄØ% line/method** and `Table` is fully green (**98.5‚ÄØ% line / 95.8‚ÄØ% branch**), shifting the red list to the remaining reflection/member descriptors plus the parser/lexer helpers (`ObjectCallbackMemberDescriptor`, `PropertyMemberDescriptor`, `DynamicExprExpression`, `LexerUtils`, etc.).
   - üîÑ (2025-11-17 11:30 UTC) Added constructor/AOT/optimization regressions to `PropertyMemberDescriptorTests` (dual-null accessor guard, AOT forcing `InteropAccessMode.Reflection`, explicit `IOptimizableDescriptor.Optimize` path) and reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ061 tests). Overall coverage ticks up to **85.1‚ÄØ% line / 84.9‚ÄØ% branch / 87.6‚ÄØ% method**, with `NovaSharp.Interpreter` steady at **94.1‚ÄØ% line / 90.9‚ÄØ% branch / 96.8‚ÄØ% method**. `PropertyMemberDescriptor` now reports **89.6‚ÄØ% line / 94.1‚ÄØ% branch**; the remaining uncovered statements are the redundant `_getter/_setter` guards and the argument-mismatch catch blocks that `MemberDescriptor.CheckAccess`/`ScriptToClrConversions` already short-circuit.
  - üîÑ (2025-11-17 12:16 UTC) Introduced `Units/ObjectCallbackMemberDescriptorTests` to prove delegate execution (host/context/args propagation) and the null-callback fallback, then reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ063 tests). Interpreter coverage holds at **94.2‚ÄØ% line / 90.8‚ÄØ% branch / 96.7‚ÄØ% method**, while `ObjectCallbackMemberDescriptor` climbs to **92.8‚ÄØ% line / 100‚ÄØ% branch**, narrowing the red list to `PropertyMemberDescriptor`, the parser helpers (`DynamicExprExpression`, `AdjustmentExpression`), and the lexer/numeric conversion utilities.
  - üîÑ (2025-11-17 22:25 UTC) Repaired the reflective shim inside `Units/DynamicAndAdjustmentExpressionTests` so Eval/Compile overrides can be exercised under C#‚ÄØ9, fixed the `TableTests` fractional-key/object-array removal cases to avoid cross-script ownership violations and null dereferences, tightened the whitespace `NovaSharp_PATH` scenario in `ReplInterpreterScriptLoaderTests`, and reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ067 tests). `NovaSharp.Interpreter` coverage stays at **94.2‚ÄØ% line / 90.9‚ÄØ% branch / 96.8‚ÄØ% method**, but both `DynamicExprExpression` and `AdjustmentExpression` are now >95‚ÄØ% line coverage and the red list has shrunk to the platform/lexer/runtime helpers called out in `docs/coverage/coverage-hotspots.md` (`PropertyMemberDescriptor`, `ReplHistoryInterpreter`, `LimitedPlatformAccessor`, `LexerUtils`, `NumericConversions`, `MultiDictionary<T>`, `DynValue`, etc.).
  - üîÑ (2025-11-17 15:06 UTC) Hardened the Limited Platform accessor suite by calling every unsupported override (`FileExists`, `DefaultPrint`) directly, rebuilding in Release, and rerunning `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ072 tests). `NovaSharp.Interpreter` now reports **94.3‚ÄØ% line / 90.9‚ÄØ% branch / 96.9‚ÄØ% method**, `LimitedPlatformAccessor` is fully covered (**100‚ÄØ% line/method**), and the red list is down to the parser/lexer helpers plus the numeric conversion utilities noted in `docs/coverage/coverage-hotspots.md`.
  - üîÑ (2025-11-17 15:33 UTC) Landed `Units/LexerUtilsTests` to exercise the parser helpers (decimal/hex parsing, Unicode/z-mode escapes, unfinished strings). `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ091 tests) lifts `LexerUtils` to **96.2‚ÄØ% line / 98.1‚ÄØ% branch / 100‚ÄØ% method** and keeps interpreter totals at **94.4‚ÄØ% line / 91.1‚ÄØ% branch / 96.9‚ÄØ% method**.
  - üîÑ (2025-11-17 15:47 UTC) Added `Units/NumericConversionsTests` covering the double-to-type success/overflow paths plus numeric/non-numeric `TypeToDouble`. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ095 tests) raises `NumericConversions` to **91.3‚ÄØ% line / 89.1‚ÄØ% branch / 100‚ÄØ% method** and nudges interpreter coverage to **94.4‚ÄØ% line / 91.2‚ÄØ% branch / 96.9‚ÄØ% method**, leaving `MultiDictionary<T>`, `DynValue`, and the diagnostics helpers as the remaining <90‚ÄØ% debt.
  - üîÑ (2025-11-17 16:03 UTC) Introduced `Units/MultiDictionaryTests` (equality comparer constructor, `ContainsKey`, `Keys`, `Clear`, remove-value success/failure). `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ101 tests) now reports `MultiDictionary<T>` at **100‚ÄØ% line / branch / method** while NovaSharp.Interpreter holds at **94.4‚ÄØ% line / 91.2‚ÄØ% branch / 97.1‚ÄØ% method**, focusing the remaining debt on `DynValue` and diagnostics helpers.
  - üîÑ (2025-11-17 16:34 UTC) Bulked up `Units/DynValueTests` (array-based table construction, single-value tuple folding, `ToPrintString` / `ToDebugPrintString` fallbacks, equality/read-only assignment guards, and `CheckUserDataType` nil handling) and reran `./scripts/coverage/coverage.ps1 -SkipBuild`. The run (2‚ÄØ123 tests) puts `NovaSharp.Interpreter.DataTypes.DynValue` at **95.2‚ÄØ% line / 92.2‚ÄØ% branch / 100‚ÄØ% method** and lifts interpreter totals to **94.7‚ÄØ% line / 91.6‚ÄØ% branch / 97.2‚ÄØ% method**, narrowing the <90‚ÄØ% backlog to the diagnostics helpers plus the platform/accessor items listed above.
  - üîÑ (2025-11-17 17:21 UTC) Extended `Units/PropertyMemberDescriptorTests` with `SetValueConvertsDoubleToPropertyType`, `SetValueWrapsArgumentExceptionFromOptimizedSetter`, and `SetValueWrapsInvalidCastExceptionFromOptimizedSetter`. The new cases force the numeric downcast path and inject custom `_optimizedSetter` delegates (via reflection) that throw `ArgumentException`/`InvalidCastException`, exercising both catch blocks in the descriptor. After `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ126 tests) `PropertyMemberDescriptor` now reports **94.5‚ÄØ% line / 94.1‚ÄØ% branch / 100‚ÄØ% method**, keeping interpreter coverage at **94.7‚ÄØ% line / 91.6‚ÄØ% branch / 97.2‚ÄØ% method**.
  - üîÑ (2025-11-18 05:25 UTC) Expanded `Units/TokenTests` to cover the padded `ToString` output, every reserved keyword, numeric/hex/hex-float parsing, unary/binary/operator helpers, end-of-block classification, and the `GetSourceRef*` overloads. `Tree.Lexer.Token` now reports **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run lands at **95.2‚ÄØ% line / 92.1‚ÄØ% branch / 97.4‚ÄØ% method** across **2‚ÄØ196** Release tests (overall repo **85.9‚ÄØ% line**).
  - üîÑ (2025-11-18 05:25 UTC) Added deterministic stopwatch coverage: `PerformanceStatisticsTests` now verifies redundant enable/disable calls, proves `StartGlobalStopwatch` accumulates over multiple scopes, and asserts `GetPerformanceLog` output, while `GlobalPerformanceStopwatch.GetResult()` marks results as global. `PerformanceStatistics` jumps to **98.2‚ÄØ% line / 96.1‚ÄØ% branch / 90‚ÄØ% method**, removing it from the red list and keeping the shared diagnostics infrastructure spec-compliant.
  - üîÑ (2025-11-18 05:25 UTC) Introduced new debugger/binary-dump coverage: `Units/DebuggerBreakpointTests` exercises breakpoint toggle/set/clear/reset flows through a stub debugger, `Units/ProcessorBinaryDumpTests` covers invalid header/version/base-address guards, `ScriptLoadTests.LoadStreamHandlesShortTextStreams` forces the short-stream path in `Processor.IsDumpStream`, and `ScriptOptionsTests.CallRecordsExecutionCounterWhenEnabled` proves the per-call stopwatch disposal path. `Execution.VM.Processor` now reports **90.7‚ÄØ% line / 88.0‚ÄØ% branch / 94.0‚ÄØ% method**, keeping interpreter totals at **95.2‚ÄØ% line / 92.1‚ÄØ% branch / 97.4‚ÄØ% method** across **2‚ÄØ196** Release tests.
  - üîÑ (2025-11-17 19:24 UTC) Introduced `Units/SystemHighResolutionClockTests` to verify stopwatch frequency wiring, monotonic timestamps, explicit elapsed calculations, and the null-`endTimestamp` path. `SystemHighResolutionClock` now sits at **100‚ÄØ% line / 100‚ÄØ% branch / 100‚ÄØ% method**, and the latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ142 tests) bumps interpreter aggregates to **94.8‚ÄØ% line / 91.6‚ÄØ% branch / 97.3‚ÄØ% method**.
  - üîÑ (2025-11-17 22:41 UTC) Added new `ReplHistoryInterpreterTests` covering empty-history access, the `HistoryNext` early-return branch, and navigation reset/overwrite behaviour once the circular buffer wraps. The latest `./scripts/coverage/coverage.ps1 -SkipBuild` run (2‚ÄØ070 tests) keeps interpreter totals at **94.2‚ÄØ% line / 90.9‚ÄØ% branch / 96.8‚ÄØ% method**, and `ReplHistoryInterpreter` now reports **95.2‚ÄØ% line / 87.5‚ÄØ% branch / 100‚ÄØ% method**, removing it from the <90‚ÄØ% list so focus can shift to the platform accessors, lexer helpers, and numeric conversions.
  - üîÑ (2025-11-17 15:33 UTC) Added `Units/LexerUtilsTests` to hammer the prefix/escape guardrails (missing `0x`, malformed exponents, Unicode `\u{}` shape, `\z` trimming, unfinished escapes) and reran `./scripts/coverage/coverage.ps1 -SkipBuild` (2‚ÄØ091 tests). `NovaSharp.Interpreter` now reports **94.4‚ÄØ% line / 91.1‚ÄØ% branch / 96.9‚ÄØ% method**, `LexerUtils` sits at **96.2‚ÄØ% line / 98.1‚ÄØ% branch / 100‚ÄØ% method**, and the remaining <90‚ÄØ% debt is concentrated in `NumericConversions`, `MultiDictionary<T>`, `DynValue`, and the diagnostics helpers tracked in `docs/coverage/coverage-hotspots.md`.
  - ‚öñÔ∏è Guardrail: treat any failing test as a spec investigation. Cross-check behaviour against the official Lua manuals for every supported version (baseline: 5.4.8), capture the cited section/link in the diff, and only adjust production/tests once the canonical interpreter behaviour is understood.
    - ‚úÖ Policy update (2025-11-14): when a test surfaces a regression, fix the production implementation (or legacy-era behaviour) instead of weakening the test; NovaSharp must converge on Lua 5.4 semantics, so ‚Äúmaking tests pass‚Äù is never an acceptable substitute for addressing the runtime gap.
  - ‚è≥ Establish a multi-version Lua spec harness: enumerate the manuals/sections for each supported version, expand spec suites (string/math/table/core/error paths) with exhaustive edge/error cases that cite the manual, and sync findings into `docs/LuaCompatibility.md`.
    - üîÑ (2025-11-21 17:05 UTC) Brought up the first compatibility-spanning harness: `LuaTableMoveMultiVersionSpecTests` now runs the Lua¬†5.3 manual ¬ß6.6 `table.move` scenarios across Lua¬†5.2‚ÄìLatest, asserting the function stays hidden in Lua¬†5.2, copies overlapping ranges correctly, returns the destination table, and defaults the destination argument to the source. Documented the progress in `docs/testing/spec-coverage.md` and ran `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release --filter FullyQualifiedName~LuaTableMoveMultiVersionSpecTests` to keep the Release suite green.
    - üîÑ (2025-11-21 17:32 UTC) Extended the harness to the Lua 5.3 manual ¬ß6.5 utf8 library: `LuaUtf8MultiVersionSpecTests` now verifies that Lua¬†5.2 profiles hide `utf8`, while Lua¬†5.3‚ÄìLatest retain spec-faithful behaviour for `utf8.len`, `utf8.codepoint`, `utf8.offset`, `utf8.codes`, and `utf8.charpattern`. Updated `docs/testing/spec-coverage.md` with the new coverage notes and exercised the suite via `dotnet test ‚Ä¶ --filter FullyQualifiedName~LuaUtf8MultiVersionSpecTests`.
    - üîÑ (2025-11-21 18:05 UTC) Filled out the Lua 5.3 manual ¬ß6.7 coverage: `MathModule` now exposes `math.type`, `math.tointeger`, and `math.ult` behind compatibility gating (Lua¬†5.3+ only), mirrors Lua‚Äôs integer conversion rules, and enforces unsigned comparisons. `LuaMathMultiVersionSpecTests` validates gating, integer/float detection, numeric & string conversions, and the expected error tuples; docs (`docs/testing/spec-coverage.md`, `docs/LuaCompatibility.md`) now cite the new harness, and `dotnet test ‚Ä¶ --filter FullyQualifiedName~LuaMathMultiVersionSpecTests` keeps the Release suite green.
    - üîÑ (2025-11-21 18:32 UTC) Aligned `tonumber` with Lua ¬ß6.1 by supporting bases 2‚Äì36 (letters + optional sign), returning `nil` for invalid numerals, and surfacing base-validation errors; updated the TAP fixture (`TestMore/301-basic.t`) and added `LuaBasicMultiVersionSpecTests` so the spec harness now covers the canonical success/failure cases. Docs (`docs/testing/spec-coverage.md`, `docs/LuaCompatibility.md`) and the Release suite (`dotnet test ‚Ä¶ --filter FullyQualifiedName~LuaBasicMultiVersionSpecTests`) reflect the new baseline.
    - üîÑ (2025-11-21 18:32 UTC) Upgraded the core `tonumber` implementation to mirror Lua ¬ß6.1 (bases 2‚Äì36, optional sign, invalid-digit nils, strict integer base validation) and added `LuaBasicMultiVersionSpecTests` so the spec harness now covers base conversion success paths, invalid numerals, and out-of-range/fractional base diagnostics. Documented the progress in `docs/testing/spec-coverage.md` and kept the suite green via `dotnet test ‚Ä¶ --filter FullyQualifiedName~LuaBasicMultiVersionSpecTests`.
  3. Keep expanding the spec audit + analyzer burndown: for every area we touch, cite the Lua manual section in `docs/testing/spec-audit.md`, and continue reducing the CA warning count (especially CA1062/CA1305 hotspots surfaced in the latest `dotnet test` runs) so we can flip CA analyzers to TreatWarningsAsErrors after the compatibility work settles.
     - üîÑ Bootstrapped the audit log at `docs/testing/spec-audit.md`, citing Lua ¬ß3.4.1 for the fixed power-operator gap, documenting `math.modf` (¬ß6.7) now truncates toward zero, and confirming the `nil == void` guard remains an internal sentinel. Next pass: expand the table across other interpreter hotspots and file issues for every ‚ÄúNeeds investigation‚Äù entry.
     - üîÑ Expanded the audit table with the new multi-version spec harnesses (`LuaTableMove`, `LuaUtf8`, `LuaMath`, `LuaBasic`) so each cites the relevant Lua ¬ß6.x entries, and added a `Needs investigation` row callout for the still-missing Lua¬†5.3+ operators (`&`, `|`, `~`, `<<`, `>>`, `//`) referenced in ¬ß¬ß3.4.1/3.4.7. `docs/testing/spec-audit.md` now tracks both the verified coverage and the outstanding bitwise/floor-division gap so we can decide whether to implement or document the deviation.
  - ‚úÖ Expanded EventMemberDescriptor, CharPtr, StringConversions, DescriptorHelpers, RefIdObject, ExprListExpression, FieldMemberDescriptor, StandardEnumUserDataDescriptor, ScriptExecutionContext, and `FastStack<T>` unit suites (null-pointer guards, tuple compilation, SafeGetTypes failure path, string conversion errors, ref-id formatting, field read/write guardrails, enum conversion/validation, call/AdditionalData edge paths, explicit-interface stack members) and reran `./scripts/coverage/coverage.ps1` (2025-11-12 18:55 UTC); NovaSharp.Interpreter now reports **86.1‚ÄØ% line / 82.3‚ÄØ% branch** coverage with the former red-listed classes clearing 95‚ÄØ%+ (`FastStack<T>` now 100‚ÄØ%).
4. **Project Structure Refactor (High Priority)**
   - ‚úÖ Solution + debugger project rename landed (PascalCase `NovaSharp.sln`, `NovaSharp.VsCodeDebugger.csproj`).
   - ‚úÖ VS¬†Code debugger `_Projects` mirror removed; project now multi-targets `netstandard2.1;net8.0`.
   - ‚úÖ CLI rename complete (`tooling/NovaSharp.Cli`).
   - ‚úÖ Audit packaging/scripts for the new CLI name (NuGet spec, release docs, tooling installers). Packaging notes now consistently reference `cli`/`NovaSharp.Cli` for the REPL bundle and no longer mention the removed `repl` layout.
   - ‚úÖ CLI now restores solely via NuGet (no checked-in packages).
   - ‚úÖ Audited legacy assets: `src/legacy/Tools/lua52.dll` quarantined with README; exclude from modern builds unless a native packaging strategy is required.
   - ‚úÖ Update automation/scripts (branding + build workflows) to reflect the new directory paths; legacy `rsync_projects.sh` has been removed and the shared guard/coverage workflows already reference the current tooling layout.
  - ‚úÖ Retired the entire `src/legacy` tree (Flash client, NovaSharpPreGen console, Lua52 binaries, empty `novasharp_netcore`) after confirming no build/test dependencies; modernization docs now capture the removal for historical context.
  - üîÑ Plan the namespace/package rebrand: migrate code to `WallstopStudios.*` namespaces and align package IDs to `com.wallstop-studios.*` while keeping the NovaSharp product name. Produce a staged rollout plan (analyzers, namespace audit, package metadata) before executing.
    - üîÑ (2025-11-23 05:36 UTC) Captured the staged rollout blueprint in `docs/modernization/namespace-rebrand-plan.md`, including the project inventory, namespace/package mapping tables, analyzer/CI guard-rail updates, compatibility wrapper strategy, and the five concrete rollout stages (tooling prep ‚Üí runtime rename ‚Üí tooling/debugger rename ‚Üí packaging ‚Üí comms). Linked the new plan from `docs/Modernization.md`; next up is teaching `tools/NamingAudit` to track `WallstopStudios.NovaSharp` adoption.
    - üîÑ (2025-11-23 15:59 UTC) Extended `tools/NamingAudit/naming_audit.py` with namespace-prefix tracking (`--namespace-prefix <value>` summaries plus optional `--enforce-namespace-prefix`) and documented the workflow in `tools/NamingAudit/README.md`. The audit now reports how many declarations still use `NovaSharp.*` vs. the new `WallstopStudios.NovaSharp.*` prefix, so we can monitor progress ahead of flipping enforcement.
    - üîÑ (2025-11-23 16:08 UTC) Added `LegacyNamespacePrefix`/`TargetNamespacePrefix` properties to `Directory.Build.props` and taught `tools/NamingAudit` to read them automatically when no `--namespace-prefix` flags are passed. CI/log generation now pick up the canonical namespace targets without duplicating values, keeping Stage‚ÄØ1 guard-rails centralized in MSBuild. Next step: wire the `.editorconfig` namespace rule + analyzer toggle that consumes the same properties.
    - üîÑ (2025-11-23 16:20 UTC) Updated `.github/workflows/tests.yml` so every lint/test job runs `naming_audit.py` with both `--namespace-prefix WallstopStudios.NovaSharp` and `--namespace-prefix NovaSharp`. This keeps the CI gate aligned with the new prefixes and bakes the summary into every run while we stage the analyzer flip.
    - üîÑ (2025-11-23 16:43 UTC) Added `Directory.Build.targets` to auto-generate a namespace-prefix `.editorconfig` from the MSBuild properties (`EnforcedNamespacePrefix`, `NamespacePrefixDiagnosticSeverity`, `EnableNamespacePrefixRule`, `NamespacePrefixExcludedNamespaces`). The generated file is injected via `EditorConfigFiles`, respects the LuaPort allowlist, and currently raises suggestion-level diagnostics for non-`NovaSharp` namespaces; flipping the prefix/severity now requires editing a single property.
5. **Namespace & Formatting Enforcement**
   - ‚úÖ Drafted analyzer configuration: root `Directory.Build.props` enables analyzers during build; `.editorconfig` keeps IDE0130 at warning until the ~700 existing namespace mismatches are triaged under the follow-on suppression/cleanup tasks.
   - ‚úÖ Normalized `Execution/Scopes` namespaces and updated consumers so `ClosureContext`, `RuntimeScope*`, and loop helpers live under `NovaSharp.Interpreter.Execution.Scopes` without breaking the build.
   - ‚úÖ Migrated `DataTypes/*` to `NovaSharp.Interpreter.DataTypes` and added a scoped global using so dependent code compiles while we continue tightening folder-aligned namespaces.
   - ‚úÖ Shifted `DataStructs/*` to `NovaSharp.Interpreter.DataStructs` and introduced shared global using coverage for their extensions.
   - ‚úÖ Moved core execution helpers (`ScriptExecutionContext`, `DynamicExpression`) under `NovaSharp.Interpreter.Execution` and rehomed interop attributes + runtime errors beneath folder-aligned namespaces.
   - üîÑ Work-in-progress: reapply namespace/import fixes with Unity-compatible constructs (no global usings), updating runtime/interop consumers one file at a time to keep source drops usable inside Unity.
     - ‚úÖ Closed the remaining `DataStructs` loopholes by moving `Extension_Methods` under `NovaSharp.Interpreter.DataStructs` and swapping every consumer over to explicit `NovaSharp.Interpreter.DataStructs` imports; `NovaSharp.Interpreter` builds clean aside from pre-existing IDE0130 warnings.
     - ‚úÖ Completed the `DataTypes/*` namespace migration with explicit `NovaSharp.Interpreter.DataTypes` imports woven through runtime/interop call sites; build now succeeds (warnings only) without relying on global-usings.
     - ‚úÖ Realigned `Errors/*` to `NovaSharp.Interpreter.Errors` and propagated the new namespace through compiler/runtime call sites, eliminating the remaining IDE0130 warnings for that folder without introducing globals.
     - ‚úÖ Rehomed `Execution/*.cs` (`DynamicExpression`, `ScriptExecutionContext`, `InstructionFieldUsage`) under `NovaSharp.Interpreter.Execution` and updated all consumers plus performance wrappers, keeping the build warning-free outside of the remaining legacy namespace backlog.
     - ‚úÖ Lifted all interop attribute types into `NovaSharp.Interpreter.Interop.Attributes` and retargeted every consumer (`CoreLib`, `Interop`, `DataTypes/UserData`) to the new namespace, clearing the attribute naming inconsistencies without relying on global usings.
     - ‚úÖ Converted the remaining runtime underscore artifacts to PascalCase (`Tree/FastInterface`, `ExtensionMethods`, `KopiLuaStringLib`, processor partials, `LuaBaseCLib`, `NamespaceDoc` split) and adjusted imports; the Options and Lexer namespaces now match their folders while consumers import `NovaSharp.Interpreter.Options` / `NovaSharp.Interpreter.Tree.Lexer`.
     - ‚úÖ Swapped the CoreLib module surfaces back to instantiable classes (with targeted CA1052 suppressions) so generic registration accepts them, and renamed the platform accessor API (`OpenFile`, `GetStandardStream`, `GetTempFileName`, `ExitFast`, etc.) to PascalCase; updated runtime/tests to honor the new signatures while preserving Lua behaviour.
     - ‚úÖ Rewired hardwire generators, benchmarks, and debugger shims to the new descriptor namespaces and `DynamicExpression.ExpressionCode` member, and updated CLI/test infrastructure to the PascalCase API surface so `dotnet build -c Release` returns cleanly (tests now consume shared NovaSharp usings via the project-level settings).
     - ‚úÖ Confirmed `dotnet build src/NovaSharp.sln -c Release` and `dotnet test src/tests/NovaSharp.Interpreter.Tests/NovaSharp.Interpreter.Tests.csproj -c Release` succeed; remaining analyzer warnings are pre-existing CA/IDE suggestions and tracked separately.
     - ‚úÖ Brought `Execution/Scopes` files in line with their folder namespace and threaded `Execution.Scopes` imports through the compiler/bytecode pipeline (chunk/loop statements, loader, debug module, VM call stack) so IDE0130 no longer fires for that area; scoped `ClosureContext` consumers now reference the new namespace without relying on globals.
     - ‚úÖ Propagated the PascalCase namespace updates into debugger, CLI, tests, and hardwire tooling; replaced legacy `Interpreter` imports with explicit `NovaSharp.Interpreter.*`/`NovaSharp.Interpreter.DataTypes` references and retargeted hardwire descriptors to `StandardDescriptors.*`, restoring a clean Release build across the solution.
     - ‚úÖ Reworked VS‚ÄØCode protocol DTOs to expose read-only lists and init-only capability flags, eliminating the CA1819/CA1051 warnings triggered by public arrays and fields in `DebugSession`.
     - ‚úÖ Renamed interop constants and Unity loader defaults to PascalCase and updated loader/member surfaces to return `IReadOnlyList<T>`/`Array.Empty<T>()`, clearing the residual CA1707/CA1805/CA1819 diagnostics in those areas.
     - ‚úÖ Staged the `.editorconfig` import with Lua fixture overrides by adding `src/tests/NovaSharp.Interpreter.Tests/TestMore/.editorconfig` so TAP suites retain two-space indentation.
     - Catalogue remaining underscore-based files, folders, and identifiers and convert them to PascalCase wherever Lua compatibility does not mandate the legacy casing; document any unavoidable Lua-bound exceptions and the alternative mechanisms evaluated.
       - ‚úÖ Renamed `XmlWriter_Extensions.cs` ‚Üí `XmlWriterExtensions.cs` and `release_readme.txt` ‚Üí `ReleaseReadme.txt`, leaving `_Hardwired.cs` and Lua assets as intentional holdouts.
     - Identify legacy/generated files needing suppression tags or sub-config.
6. **Unity/Packaging Alignment**
   - ‚úÖ Updated `docs/UnityIntegration.md` with a netstandard2.1-focused quick-start walkthrough (publish ‚Üí copy ‚Üí wire in Unity) plus sample bootstrap code.
   - ‚úÖ Audited tooling TFMs: runtime/debugger libraries stay on `netstandard2.1` while the CLI now targets `net8.0` so it can run as a dotnet tool/hosted executable.
   - ‚úÖ Completed doc audit; active guides now reference `netstandard2.1`/`net8.0` (see `docs/Modernization.md`), with the archived Sandcastle project noted as historical .NET Framework content.
   - üîú Automate Unity packaging via CI/CD: build `.unitypackage`/UPM tarballs containing all NovaSharp binaries (and dependencies) and publish artifacts on every tagged release.
   - üîú Ship full Unity integration scripts: provide tooling that copies DLLs into `Plugins` (hash-aware), configures import settings, and enables analyzers‚Äîuse Wallstop Studios‚Äô DxMessaging pipeline as inspiration.
   - üîú Produce comprehensive Unity samples under `Samples~` demonstrating interpreter bootstrapping, modding hooks, CLI usage, and recommended project structure.
7. **Debugger Smoke Tests**
   - Author lightweight harnesses to drive VS¬†Code and remote debuggers (attach, breakpoint, variable inspection).
   - Gate behind opt-in flag while stabilising.
8. **Cross-Platform CI**
   - ‚úÖ Added `dotnet-tests-windows` lane in `tests.yml` to mirror the Linux run and upload TRX artifacts; macOS lane still pending once Unity docs ship.
   - Consider nightly runs enabling IO/OS TAP suites on trusted hardware.
9. **Benchmark Governance**
  - ‚úÖ Documented the local execution workflow, thresholds, and reporting cadence in `docs/Performance.md#Benchmark Governance`, and seeded the archival process with `docs/performance-history/README.md`.
  - ‚úÖ Captured the November 10 benchmark sweep (runtime, script loading, NLua comparison), archived it at `docs/performance-history/2025-11-10.md`, and refreshed `docs/Performance.md` with the latest deltas and environment metadata.
  - ‚úÖ (2025-11-23 10:30 UTC) Added `scripts/benchmarks/run-benchmarks.ps1`, which restores local dotnet tools, builds `src/NovaSharp.sln`, runs the runtime + comparison BenchmarkDotNet suites (`--no-build` to avoid file-lock churn), and prints artefact paths so docs/Performance.md can be regenerated in one hop. The script fails fast when builds/tests break and accepts `-SkipComparison` for perf-only triage.
  - ‚úÖ (2025-11-23 11:30 UTC) Reworked the reporting layout/code so each OS section now renders the NovaSharp vs MoonSharp comparison table first, followed by the NovaSharp benchmark summaries and finally the MoonSharp baseline snapshot. `PerformanceReportWriter` writes the new ordering automatically, the governance doc calls the required order out explicitly, and `docs/Performance.md` is updated to match the new structure.
  - üîú Stabilize the PowerShell runner: fix the lingering `NovaSharp.Interpreter.dll` file-locks that surface when `dotnet build` runs twice during BenchmarkDotNet sessions (likely leftover child processes). Options: add a pre-run `dotnet clean`, move the solution build ahead of BenchmarkDotNet with `/p:UseSharedCompilation=false`, or ensure the benchmark host disposes lingering AppDomains before the comparison suite starts. Document the fix in `scripts/benchmarks/README.md` once the workflow runs end-to-end without manual cleanup.
10. **Roslyn Hardwire Replacement**
   - Design and implement a Roslyn source generator/analyzer that emits the hardwired userdata descriptors at compile time (NetStandard-compatible).
   - Integrate generator into the interpreter build and Unity pipeline; ensure output matches or exceeds existing hardwire coverage via new unit tests.
   - After generator parity is verified, delete the legacy `NovaSharp.Hardwire` tooling project and remove `_Hardwired.cs` artefacts.
   - üîÑ Drafted `docs/proposals/roslyn-hardwire-generator.md` outlining generator goals, architecture, diagnostics, integration phases, and risks to guide implementation.
   - ‚úÖ Augmented the proposal with a reflection-free interop scaffolding study: `docs/proposals/roslyn-hardwire-generator.md` now outlines hotspots and a phased plan for generator-emitted delegates that replace the existing reflection helpers.
11. **Performance Optimization Campaign**
  - Instrument allocation and timing baselines for runtime, CLI, and debugger pipelines using BenchmarkDotNet + EventCounters; publish the before/after data alongside coverage dashboards.
  - Replace high-traffic LINQ/query expressions in production code with allocation-free loops once equivalent tests guard behaviour (focus areas: `Execution`, `DataTypes`, `Interop`).
    - ‚úÖ Replaced `Table.Pairs/Keys/Values` LINQ projections with custom iterators to eliminate per-enumeration allocations in hot table traversal paths; `TableTests` remain green.
    - ‚úÖ Dropped LINQ usage from `StandardUserDataDescriptor` member discovery by replacing `OfType/Select/Any` with manual loops to reduce reflection-time allocations for userdata registration.
  - Profile per-request allocations in critical interpreters (metatables, dynamic expressions, coroutine resumption) and eliminate hot allocations via pooling or struct spans while keeping APIs intact.
  - üîù Align NovaSharp‚Äôs custom data structures with familiar .NET collection semantics: inventory helpers such as `LinkedListIndex`, `FastStack`, `MultiDictionary`, and benchmark hosts to ensure method names/behaviour match BCL expectations, replace double-lookup anti-patterns (`ContainsKey` + indexer, `Contains` + `Find`) with single-pass `TryGet` flows, and document the preferred usage patterns so cache misses stay minimal without sacrificing the recent simplicity improvements.
  - ‚úÖ Add allocation guardrails: schedule an investigation into object pooling / buffering strategies inspired by UnityHelpers‚Äô `Buffers` (and similar libraries) to ensure new allocations only occur when absolutely necessary. Scope includes:
     - Evaluate struct-based API variants (e.g., `TryGetX(out ValueListBuilder<T> builder)` or list-populating overloads) alongside existing `IEnumerable` returns so callers can reuse buffers.
     - Prototype value-based `IDisposable` helpers that avoid boxing while remaining assignment-compatible (`IDisposable result = ...`).
     - Catalogue candidate hotspots (table enumeration, descriptor generation, coroutine stacks) and capture findings/tests before rollout.
     - ‚úÖ Captured the initial study in `docs/performance/object-pooling-study.md`, listing hotspots, proposed buffer-based APIs, and next steps for instrumentation.
- Investigate introducing generic variants for heavily-used helpers to eliminate boxing of interfaces/value types (e.g., `IEnumerator`, `IUserDataType` call-sites); capture candidates, prototype generic alternatives, and benchmark/alloc-diff results before rollout.
- Evaluate class-to-struct conversions for immutable and interop-heavy types (e.g., Lua interop handles, metadata tuples) so we can remove object header overhead when semantics allow. Produce a shortlist of candidates, run microbenchmarks to confirm net wins, and document any GC/stack tradeoffs before shipping.
- Author a dedicated struct feasibility study for Lua interop + immutable records: document how candidate classes (`DynValue` metadata, `ExtensionMemberDescriptor`, debugger DTOs, etc.) behave today, spell out the copy/aliasing risks, outline the benchmark/heap instrumentation plan, and flag any runtime APIs/tests we must extend before attempting class‚Üístruct conversions.
- Add regression tests/benchmarks that fail when allocations or median timings exceed established thresholds so the gains remain enforced in CI.
- Evaluate value-type substitutions: audit frequently allocated helper classes/struct-like containers and prototype replacing them with `struct` equivalents (when safe) to reduce GC pressure; include benchmarks + safety tests (copy semantics, mutation) before adoption.
12. **Debugger Orchestration Library (Low Priority)**
   - Evaluate extracting common remote-debugger session management into a shared `NovaSharp.Debugger.Core` library consumed by CLI, VS¬†Code, Cursor, Visual Studio (2022/2026), and Rider front ends.
   - Inventory protocol overlaps (transport, attach semantics, UI-hooks) across existing adapters and spike shared abstractions for launch, attach, and breakpoint workflows.
   - Track incremental adoption roadmap in docs, ensuring each host keeps the current UX while reusing the shared core.
13. **Shared Core Modules Feasibility (Low Priority)**
    - Explore factoring shared runtime tooling (benchmark writers, CLI helpers, debugger utilities) into reusable libraries instead of relying on `InternalsVisibleTo`.
    - Audit existing cross-project dependencies to identify candidates for a `NovaSharp.Core.Tooling` / `NovaSharp.Core.Debug` module boundary.
    - Prototype a small migration (e.g., benchmark utilities) to validate packaging, versioning, and breaking-change surface.

14. **Lua 5.4 Compatibility Expansion**
15. **Lua Spec Conformance Harness**
    - ‚úÖ Inventory the upstream Lua 5.4 features we still miss (e.g., `goto` semantics, new library APIs, weak tables, to-be-closed variables) and track them in a parity matrix (`docs/LuaCompatibility.md`).
    - Investigate implementing weak tables/ephemeron behaviour in `Table` + GC to match Lua 5.4; validate via new regression suites and memory stress tests.
    - Evaluate the impact of Lua 5.4 VM/runtime changes (metamethod tweaks, math library updates, `debug` additions) and scope incremental delivery plans with benchmarks to ensure no regressions.
    - Catalog the Lua versions we plan to support (5.2‚Äì5.5 plus ‚ÄúLatest‚Äù) and map every manual section (core language, standard libraries, appendix) to spec test coverage targets tracked alongside the parity matrix.
    - ‚úÖ Captured an initial coverage ledger in `docs/testing/spec-coverage.md`, outlining version targets, manual sections, and current status indicators.
    - üîÑ Added the first Lua 5.4 spec harness suite (`Lua54StringSpecTests`) covering canonical string library examples (byte/char ranges, pattern-free helpers); expand to additional libraries next.
    - Stand up a conformance harness that executes official manual examples, edge cases, and error scenarios, storing fixtures beside the NUnit TAP corpus for reuse across interpreter builds.
    - For each module (`StringModule`, `MathModule`, coroutine APIs, etc.), enumerate edge/error behaviours from the spec and add exhaustive NUnit coverage so we rely on canonical Lua semantics rather than legacy-era behaviour.
    - Integrate the harness into CI, fail builds on spec regressions, and capture progress/remaining work in `docs/testing/spec-coverage.md` with links back to manual sections.

## Long-Horizon Ideas
- Property/fuzz testing for lexer/parser and VM instruction boundaries.
- Golden-file assertions for debugger protocol payloads and CLI output.
- Native AOT / trimming validation once runtime stack is fully nullable-clean.
- Automated regression harness for memory allocations using BenchmarkDotNet diagnosers.

Keep this plan in sync with `docs/Testing.md` and `docs/Modernization.md`. Update after each milestone so contributors know what's complete, in-flight, and still open.





